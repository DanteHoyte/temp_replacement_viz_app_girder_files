{"version":3,"sources":["../../src/init.js","templates.js","../../src/girder-version.js","../../src/view.js","../../src/app.js","../../src/router.js","../../src/utilities/DialogHelper.js","../../src/utilities/EventStream.js","../../src/utilities/JQuery.js","../../src/utilities/MiscFunctions.js","../../src/utilities/S3UploadHandler.js","../../src/plugin_utils.js","../../src/collection.js","../../src/model.js","../../src/models/ApiKeyModel.js","../../src/models/AssetstoreModel.js","../../src/models/CollectionModel.js","../../src/models/FileModel.js","../../src/models/FolderModel.js","../../src/models/GroupModel.js","../../src/models/ItemModel.js","../../src/models/UserModel.js","../../src/collections/ApiKeyCollection.js","../../src/collections/AssetstoreCollection.js","../../src/collections/CollectionCollection.js","../../src/collections/FileCollection.js","../../src/collections/FolderCollection.js","../../src/collections/GroupCollection.js","../../src/collections/ItemCollection.js","../../src/collections/UserCollection.js","../../src/views/body/AdminView.js","../../src/views/body/AssetstoresView.js","../../src/views/body/CollectionView.js","../../src/views/body/CollectionsView.js","../../src/views/body/FilesystemImportView.js","../../src/views/body/FolderView.js","../../src/views/body/FrontPageView.js","../../src/views/body/GroupView.js","../../src/views/body/GroupsView.js","../../src/views/body/ItemView.js","../../src/views/body/PluginsView.js","../../src/views/body/S3ImportView.js","../../src/views/body/SystemConfigurationView.js","../../src/views/body/UserSettingsView.js","../../src/views/body/UserView.js","../../src/views/body/UsersView.js","../../src/views/layout/FooterView.js","../../src/views/layout/GlobalNavView.js","../../src/views/layout/HeaderUserView.js","../../src/views/layout/HeaderView.js","../../src/views/layout/LoginView.js","../../src/views/layout/ProgressListView.js","../../src/views/layout/RegisterView.js","../../src/views/layout/ResetPasswordView.js","../../src/views/widgets/AccessWidget.js","../../src/views/widgets/ApiKeyListWidget.js","../../src/views/widgets/BrowserWidget.js","../../src/views/widgets/CheckedMenuWidget.js","../../src/views/widgets/CollectionInfoWidget.js","../../src/views/widgets/DateTimeWidget.js","../../src/views/widgets/EditApiKeyWidget.js","../../src/views/widgets/EditAssetstoreWidget.js","../../src/views/widgets/EditCollectionWidget.js","../../src/views/widgets/EditFileWidget.js","../../src/views/widgets/EditFolderWidget.js","../../src/views/widgets/EditGroupWidget.js","../../src/views/widgets/EditItemWidget.js","../../src/views/widgets/FileInfoWidget.js","../../src/views/widgets/FileListWidget.js","../../src/views/widgets/FolderInfoWidget.js","../../src/views/widgets/FolderListWidget.js","../../src/views/widgets/GroupAdminsWidget.js","../../src/views/widgets/GroupInvitesWidget.js","../../src/views/widgets/GroupMembersWidget.js","../../src/views/widgets/GroupModsWidget.js","../../src/views/widgets/HierarchyWidget.js","../../src/views/widgets/ItemBreadcrumbWidget.js","../../src/views/widgets/ItemListWidget.js","../../src/views/widgets/LoadingAnimation.js","../../src/views/widgets/MarkdownWidget.js","../../src/views/widgets/MetadataWidget.js","../../src/views/widgets/NewAssetstoreWidget.js","../../src/views/widgets/PaginateWidget.js","../../src/views/widgets/PluginConfigBreadcrumbWidget.js","../../src/views/widgets/RootSelectorWidget.js","../../src/views/widgets/SearchFieldWidget.js","../../src/views/widgets/TaskProgressWidget.js","../../src/views/widgets/TimelineWidget.js","../../src/views/widgets/UploadWidget.js"],"names":["this","locals","buf","push","join","jade_interp","locals_","assetstores","undefined","types","importableTypes","length","$$obj","$index","$$l","assetstore","jade","cls","get","attr","cid","escape","id","FILESYSTEM","toString","GRIDFS","S3","capacityKnown","capacityString","indexOf","call","girder","collections","currentUser","collection","formatDate","DATE_MINUTE","has","formatSize","name","downloadUrl","getAccessLevel","AccessType","WRITE","ADMIN","staticRoot","apiRoot","versionInfo","git","shortSHA","Date","date","toLocaleDateString","apiVersion","groups","group","DATE_DAY","isMember","isInvited","isAdmin","isModerator","isRequested","user","login","accessLevel","item","DATE_SECOND","allPlugins","plugin","experimental","value","version","key","unmetDependencies","enabled","configRoute","description","settings","defaults","JSON","stringify","users","temporaryToken","isCurrentUser","type","icon","text","navItems","navItem","title","jade_mixins","public","modelType","model","hideRecurseOption","typeName","block","attributes","hideSaveButton","entry","accessTypes","subtitle","sel","level","READ","apiKeys","moment","apiKey","lastUse","fromNow","help","preview","submit","folderCount","itemCount","pickedCount","pickedMoveAllowed","pickedCopyAllowed","pickedDesc","minFolderLevel","minItemLevel","pickedResources","intro","property","renderMarkdown","params","noText","yesText","fromLabel","showIcon","toLabel","userTokenScopes","adminTokenScopes","tokenScope","file","folder","groupAddAllowed","addToGroupPolicy","addAllowed","files","parentItem","hasMore","contentDisposition","folders","checkboxes","admins","accessType","userAccess","mayAdd","invitees","members","member","moderators","links","current","descriptionText","idx","obj","resourceName","showActions","capitalize","parentChain","parent","object","items","newDatum","prefix","enableUploads","placeholder","rows","pageNum","pluginName","selected","display","home","format","groupName","models","modes","mode","currentMode","results","result","progressClass","width","barClass","percentText","timeLeftText","progress","data","message","segments","points","startLabel","endLabel","segment","tooltip","point","parentType","window","console","log","$","noop","error","_","extend","views","replace","location","origin","currentToken","events","clone","Backbone","Events","uploadHandlers","corsAuth","UPLOAD_CHUNK_SIZE","SORT_ASC","SORT_DESC","MONTHS","NONE","AssetstoreType","Layout","DEFAULT","EMPTY","layout","restRequest","opts","dataType","status","info","trigger","timeout","statusText","responseJSON","responseText","lastError","path","substring","url","token","girderToken","cookie","find","headers","ajax","username","password","cors","auth","btoa","method","Girder-Authorization","then","response","authToken","UserModel","document","jqxhr","logout","fetchCurrentUser","templates","SHA","View","constructor","parentView","registerChildView","prototype","apply","arguments","destroy","each","_childViews","child","undelegateEvents","stopListening","off","eventStream","unregisterChildView","$el","is","el","isShown","on","empty","removeData","modal","without","App","initialize","_started","start","promise","Deferred","resolve","fetch","render","history","afterFetch","bind","EventStream","sseTimeout","_createLayout","open","pushState","done","bindGirderEvents","navigateTo","loginDialog","registerDialog","resetPasswordDialog","alert","headerView","LayoutHeaderView","globalNavView","LayoutGlobalNavView","footerView","LayoutFooterView","progressListView","ProgressListView","layoutRenderMap","_defaultLayout","_emptyLayout","show","addClass","hide","removeClass","html","setElement","view","deactivateAll","bodyView","closeDialogIfUser","girderModal","loginView","LoginView","registerView","RegisterView","resetPasswordView","ResetPasswordView","options","append","fadeIn","setTimeout","fadeOut","remove","route","dialogs","splitRoute","fragment","base","close","router","navigate","Router","_enabled","execute","callback","args","parseQueryString","pop","queryString","dialog","slice","dialogName","baseRoute","firstIndex","lastIndex","lastIndexOf","handleClose","nameId","curRoute","routeParts","dialogId","dialogid","unparsedQueryString","param","handleOpen","streamPath","EventSource","stream","_eventSource","onmessage","e","parse","err","fn","that","elem","$element","hasFade","hasClass","toggleClass","unbind","click","delegateEvents","jQuery","DATE_MONTH","datestr","resolution","output","getMonth","getDate","getFullYear","getHours","getMinutes","getSeconds","sizeBytes","i","sizeVal","precision","toFixed","Math","min","formatCount","n","sep","maxLen","max","confirm","yesClass","escapedHtml","confirmDialog","confirmCallback","localeComparator","model1","model2","a1","sortField","a2","localeCompare","sortDir","secondarySortField","localeSort","getModelClassByName","className","charAt","toUpperCase","substr","split","val","aux","decodeURIComponent","findAll","cookies","chain","map","m","c","arr","size","list","restartServer","waitForServer","resp","serverStartDate","_lastStartDate","_reloadWindow","_callSystemRestart","reload","defineFlags","allOption","opt","Remarkable","md","linkify","Error","str","_pluginConfigRoutes","exposePluginConfig","getPluginConfigRoute","restXhrPool","restXhrCount","ajaxSend","event","xhr","girderXhrNumber","ajaxComplete","num","numberOutstandingRestRequests","category","filter","cancelRestRequests","abort","s3","startByte","_xhrProgress","lengthComputable","loaded","payloadLength","total","s3Info","upload","handler","XMLHttpRequest","request","v","k","setRequestHeader","chunked","_multiChunkUpload","onload","bytes","uploadId","_id","msg","addEventListener","send","resume","_sendNextChunk","eTagList","chunkN","s3UploadId","match","sliceFn","webkitSlice","chunkLength","offset","chunk","partNumber","contentLength","getResponseHeader","_finalizeMultiChunkUpload","doc","implementation","createDocument","root","createElement","etag","partEl","partNumberEl","etagEl","appendChild","createTextNode","req","s3FinalizeRequest","XMLSerializer","serializeToString","wrap","funcName","wrapper","Collection","Model","comparator","pageLimit","altUrl","hasPreviousPage","hasNextPage","_hasMorePages","fetchPreviousPage","fetchNextPage","ceil","reset","limit","sort","sortdir","add","idAttribute","increment","amount","set","save","keys","isObject","restOpts","extraPath","ignoreError","download","assign","throwError","AccessControlledModel","updateAccess","access","fetchAccess","force","MetadataMixin","_sendMetadata","metadata","successCallback","errorCallback","contentType","field","meta","isFunction","addMetadata","datum","removeMetadata","editMetadata","newKey","oldKey","metas","ApiKeyModel","setActive","active","scope","AssetstoreModel","cap","free","import","isNumber","CollectionModel","FileModel","resumeInfo","_wrapData","wrapped","Blob","isArray","updateContents","_uploadToContainer","isString","uploadToFolder","parentFolder","FolderModel","uploadToItem","ItemModel","parentModel","_restParams","uploadHandler","parentId","mimeType","behavior","g:upload.complete","g:upload.chunkSent","g:upload.error","g:upload.errorStarting","g:upload.progress","_uploadChunk","identifier","resumeUpload","abortUpload","endByte","blob","fd","FormData","_uploadId","processData","success","_uploadProgress","GroupModel","sendInvitation","userId","addToGroup","addInvitation","joinGroup","removeInvitation","requestInvitation","promoteUser","role","demoteUser","removeMember","removeFromGroup","mayAddMembers","once","getRootPath","clear","groupId","index","splice","invites","filtered","invite","changePassword","oldPassword","newPassword","old","new","adminChangePassword","ApiKeyCollection","AssetstoreCollection","CollectionCollection","FileCollection","FolderCollection","GroupCollection","ItemCollection","UserCollection","AdminView","click .g-server-config","click .g-assetstore-config","click .g-plugins-config","adminConsole","AssetstoresView","click .g-set-current","click .g-delete-assetstore","click .g-edit-assetstore","assetstoreEdit","concat","newAssetstoreWidget","NewAssetstoreWidget","addAssetstore","toArray","getAssetstoreImportRoute","capacityChart","editAssetstoreDialog","capacity","used","jqplot","seriesDefaults","renderer","PieRenderer","rendererOptions","sliceMargin","shadow","highlightMouseOver","showDataLabels","padding","startAngle","legend","background","border","grid","borderWidth","gridPadding","top","right","bottom","left","setCurrentAssetstore","evt","currentTarget","deleteAssetstore","editAssetstore","container","editAssetstoreWidget","EditAssetstoreWidget","assetstoreImportViewMap","assetstoreId","viewName","CollectionView","click .g-edit-collection","click .g-collection-access-control","click .g-delete-collection","edit","folderAccess","folderCreate","folderEdit","itemCreate","folderId","_createHierarchyWidget","hierarchyWidget","HierarchyWidget","editCollection","editCollectionWidget","EditCollectionWidget","collectionPage","placement","animation","delay","editAccess","AccessWidget","recurse","refreshFolderList","_fetchAndInit","collectionId","CollectionsView","click a.g-collection-link","click button.g-collection-create-button","submit .g-collections-search-form","preventDefault","paginateWidget","PaginateWidget","searchWidget","SearchFieldWidget","_gotoCollection","create","createCollectionDialog","collectionList","FilesystemImportView","submit .g-filesystem-import-form","destId","trim","destType","foldersAsItems","importPath","leafFoldersAsItems","destinationId","destinationType","click .g-open-browser","_browserWidgetView","BrowserWidget","titleText","helpText","submitText","validate","listenTo","filesystemImport","_openBrowser","FolderView","FrontPageView","click .g-register-link","click .g-login-link","click .g-collections-link","click .g-quicksearch-link","focus","click .g-my-account-link","click .g-my-folders-link","frontPage","GroupView","click .g-edit-group","click .g-group-join","click .g-group-leave","click .g-group-delete","click .g-group-request-invite","click .g-group-request-accept","click .g-group-request-deny","click #g-group-tab-pending a.g-member-name","parents","tab","editGroup","editGroupWidget","EditGroupWidget","deleteGroup","every","inv","groupPage","_renderInvitesWidget","LoadingAnimation","updatePendingStatus","_updateRolesLists","tabLink","GroupInvitesWidget","count","leaveGroup","acceptMembershipRequest","denyMembershipRequest","mods","adminsWidget","GroupAdminsWidget","modsWidget","GroupModsWidget","membersWidget","GroupMembersWidget","GroupsView","click a.g-group-link","submit .g-group-search-form","click .g-group-create-button","createGroupDialog","_gotoGroup","groupList","userGroups","ItemView","click .g-edit-item","click .g-delete-item","click .g-upload-into-item","fileEdit","uploadIntoItem","UploadWidget","fileListWidget","editItem","editItemWidget","EditItemWidget","deleteItem","parentRoute","page","itemPage","FileListWidget","metadataWidget","MetadataWidget","breadcrumbWidget","ItemBreadcrumbWidget","itemId","PluginsView","click a.g-plugin-config-link","click .g-plugin-restart-button","all","_unmetDependencies","isEmpty","contains","plugins","_sortPlugins","bootstrapSwitch","state","pluginsChanged","_updatePlugins","reject","dependencies","sortedPlugins","a","b","intersection","UsersView","S3ImportView","submit .g-s3-import-form","s3Import","SystemConfigurationView","submit .g-settings-form","settingsKeys","click .g-edit-collection-create-policy","collectionCreateAccessWidget","default","systemConfiguration","settingValue","resetState","UserAccountView","submit #g-user-info-form","email","firstName","lastName","admin","submit #g-password-change-form","temporary","apiKeyListWidget","ApiKeyListWidget","userSettings","UserView","click a.g-edit-user","editUrl","click a.g-delete-user","click a.g-approve-user","_setAndSave","click a.g-disable-user","click a.g-enable-user","userPage","click a.g-user-link","click button.g-user-create-button","submit .g-user-search-form","_gotoUser","register","userList","createUserDialog","layoutFooter","click .g-nav-link","link","selectForView","defaultNavItems","target","layoutGlobalNav","LayoutHeaderUserView","click a.g-login","click a.g-register","click a.g-logout","click a.g-my-folders","click a.g-my-settings","layoutHeaderUser","click .g-app-title","userView","layoutHeader","submit #g-login-form","extra","click .g-send-verification-email","click a.g-register-link","click a.g-forgot-password","_handleProgress","_map","layoutProgressArea","_onUpdate","update","class","appendTo","TaskProgressWidget","p","submit #g-register-form","click a.g-login-link","submit #g-reset-password-form","click button.g-save-access-list","saveAccessList","click a.g-action-remove-access","change .g-public-container .radio input","addEntry","closeFunction","template","accessEditor","accessEditorNonModal","groupAccess","accessEntry","_makeTooltips","privacyChanged","_addUserEntry","_addGroupEntry","exists","acList","parseInt","removeAccessEntry","click .g-api-key-toggle-active","_getModelFromEvent","toggleActive","click .g-api-key-new","_renderEditWidget","click .g-api-key-edit","click .g-api-key-delete","fetched","apiKeyList","popover","editApiKeyWidget","EditApiKeyWidget","click .g-submit-button","showItems","showPreview","_rootSelectionView","RootSelectorWidget","rootSelectorSettings","_root","_renderHierarchyView","browserWidget","_renderRootSelection","selectedModel","_hierarchyView","routing","onItemClick","_selectItem","_selectModel","_submitButton","CheckedMenuWidget","dropdownToggle","removeAttr","checkedActionsMenu","CollectionInfoWidget","needToFetch","collectionInfoDialog","DateTimeWidget","defaultDate","dateTimeWidget","datetimepicker","showClear","showTodayButton","useCurrent","icons","time","up","down","previous","next","today","setDate","picker","_picker","localDate","utc","local","dateString","DateTimeRangeWidget","defaultFromDate","defaultToDate","dateTimeRangeWidget","minDate","maxDate","setFromDate","_setDate","setToDate","fromDate","_date","toDate","fromDateString","_dateString","toDateString","submit #g-api-key-edit-form","fields","tokenDuration","_getSelectedScopeMode","saveModel","change .g-scope-selection-container .radio input","scopeInfo","_shouldRender","custom","adminCustom","Event","relatedTarget","viewport","submit #g-assetstore-edit-form","fieldsMap","updateAssetstore","oldfields","perms","permStr","db","mongohost","replicaset","bucket","accessKeyId","secret","service","readOnly","submit #g-collection-edit-form","updateCollection","createCollection","EditFileWidget","submit #g-file-edit-form","editFileWidget","select","EditFolderWidget","submit #g-folder-edit-form","descriptionEditor","updateFolder","createFolder","MarkdownWidget","allowedExtensions","editFolderWidget","submit #g-group-edit-form","updateGroup","createGroup","pub","submit #g-item-edit-form","updateItem","createItem","FileInfoWidget","fileInfoDialog","click a.g-show-more-files","click a.g-show-info","click a.g-update-contents","uploadDialog","click a.g-update-info","editFileDialog","click a.g-delete-file","checked","fileList","insertFile","FolderInfoWidget","folderInfoDialog","FolderListWidget","click a.g-folder-list-link","click a.g-show-more-folders","_checkboxes","folderList","change","insertFolder","checkAll","prop","recomputeChecked","checkbox","click .g-demote-moderator","li","userid","click .g-demote-member","click a.g-group-admin-remove","click a.g-member-name","groupAdminList","click .g-group-uninvite","groupInviteList","membersColl","click a.g-group-member-remove","click .g-promote-moderator","click .g-promote-admin","modsAndAdmins","inArray","groupMemberList","userSearch","_inviteUser","InviteUserDialog","click .g-invite-as-member","_sendInvitation","click .g-invite-as-moderator","click .g-invite-as-admin","click .g-add-as-member","click .g-add-as-moderator","click .g-add-as-admin","groupInviteDialog","click .g-group-mod-promote","click .g-group-mod-demote","click a.g-group-mod-remove","groupModList","click a.g-create-subfolder","click a.g-edit-folder","click a.g-delete-folder","click .g-folder-info-button","click .g-collection-info-button","click .g-description-preview","click a.g-create-item","click .g-upload-here-button","click .g-edit-access","click .g-hierarchy-level-up","click a.g-download-checked","click a.g-pick-checked","click a.g-move-picked","click a.g-copy-picked","click a.g-clear-picked","click a.g-delete-checked","click .g-list-checkbox","change .g-select-all","folderListView","itemListView","_showActions","_showItems","_routing","_appendPages","appendPages","_onItemClick","breadcrumbs","breadcrumbView","HierarchyBreadcrumbView","objects","setCurrentModel","_setRoute","checkedMenuWidget","getPickedCount","getPickedCopyAllowed","getPickedMoveAllowed","getPickedDescription","descend","uploadWidget","updateChecked","_childCountCheck","_initFolderViewSubwidgets","_fetchToRoot","resetPickedResources","ItemListWidget","reverse","setItem","createFolderDialog","editFolderDialog","createItemDialog","fetchAndShowChildCount","upOneLevel","insertItem","deleteFolderDialog","showInfoDialog","showCounts","setRoute","_describeResources","resources","kinds","desc","kind","deleteCheckedDialog","_getCheckedResourceParam","X-HTTP-Method-Override","totalSize","asObject","downloadChecked","redirectViaForm","pickChecked","pickDesc","existing","resource","union","totalPickDesc","_incrementCounts","nFolders","nItems","movePickedResources","clearPickedResources","copyPickedResources","form","editFolderAccess","selectItem","getSelectedItem","checkboxListener","_lastCheckbox","shiftKey","from","to","click a.g-breadcrumb-link","hierarchyBreadcrumb","click a.g-item-breadcrumb-link","click a.g-hierarchy-level-up","itemBreadcrumb","click a.g-item-list-link","click a.g-show-more-items","itemList","loadingAnimation","show.bs.tab .g-preview-link","shown.bs.tab .g-write-link","click .g-browse","change .g-file-input","filesAdded","dragenter .g-markdown-drop-zone","stopPropagation","originalEvent","dataTransfer","dropEffect","dragleave .g-markdown-drop-zone","dragover .g-markdown-drop-zone","drop .g-markdown-drop-zone","maxUploadSize","validateFiles","fileModel","currentProgress","css","ext","toLowerCase","markdownWidget","click .g-add-json-metadata","click .g-add-simple-metadata","fieldName","apiPath","onMetadataEdited","onMetadataAdded","simple","editor","MetadatumEditWidget","displayValue","metadatumView","json","JsonMetadatumEditWidget","validation","jsonMetadatumView","getModeFromValue","EditWidget","newRow","widget","MetadatumWidget","newEditRow","metaDict","metaKeys","Object","metaKey","click .g-widget-metadata-edit-button","_validate","newMode","toggleEditor","newEditorMode","existingEditor","overrides","fromEditorMode","newValue","row","parentElement","jsonValue","g-key","g-value","click .g-widget-metadata-cancel-button","click .g-widget-metadata-save-button","click .g-widget-metadata-delete-button","click .g-widget-metadata-toggle-button","editorType","getCurrentValue","editTemplate","metadatumEditWidget","deleteMetadatum","stopImmediatePropagation","metadataList","cancelEdit","curRow","tempKey","tempValue","saveCallback","out","jsonMetadatumEditWidget","getText","JSONEditor","setText","expandAll","submit #g-new-fs-form","createAssetstore","submit #g-new-gridfs-form","submit #g-new-s3-form","newAssetstore","click .g-page-next","click .g-page-prev","PluginConfigBreadcrumbWidget","click a.g-admin-console-link","click a.g-plugins-link","pluginConfigBreadcrumb","change #g-root-selector","Collections","Users","_updateGroup","_home","rootSelectorWidget","_formatName","_selectRoot","input .g-search-field","click .g-search-mode-radio","hideResults","search","click .g-search-result>a","_resultClicked","keydown .g-search-field","pos","code","keyCode","which","eq","ajaxLock","pending","getInfoCallback","q","_doSearch","searchField","selector","content","searchHelp","searchModeSelect","clearText","res","searchResults","percent","round","timeLeft","estimatedTotalTime","updatedTime","startTime","sprintf","_scheduleHide","taskProgress","ms","TimelineWidget","endTime","numeric","defaultSegmentClass","defaultPointClass","_processData","_processedSegments","_processedPoints","range","end","classes","_segmentTooltip","_pointTooltip","toISOString","timeline","submit #g-upload-form","startUpload","click .g-resume-upload","currentFile","click .g-restart-upload","uploadNextFile","change #g-files","filesChanged","click .g-drop-zone","dragenter .g-drop-zone","dragleave .g-drop-zone","dragover .g-drop-zone","drop .g-drop-zone","noParent","overrideStart","uploadWidgetNonModal","filesDropped","setUploadEnabled","currentIndex","overallProgress"],"mappings":"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","file":"girder.app.min.js","sourcesContent":["/*global girder:true*/\n/*global console:true*/\n\n'use strict';\n\n/*\n * Initialize global girder object\n */\nvar girder = girder || {};\n\n/*\n * Some cross-browser globals\n */\nif (!window.console) {\n    var console = {\n        log: $.noop,\n        error: $.noop\n    };\n}\n\n_.extend(girder, {\n    models: {},\n    collections: {},\n    views: {},\n    apiRoot: $('#g-global-info-apiroot').text().replace(\n        '%HOST%', window.location.origin),\n    staticRoot: $('#g-global-info-staticroot').text().replace(\n        '%HOST%', window.location.origin),\n    currentUser: null,\n    currentToken: null,\n    events: _.clone(Backbone.Events),\n    uploadHandlers: {},\n    corsAuth: girder.corsAuth || false,\n\n    /**\n     * Constants and enums:\n     */\n    UPLOAD_CHUNK_SIZE: 1024 * 1024 * 64, // 64MB\n    SORT_ASC: 1,\n    SORT_DESC: -1,\n    MONTHS: [\n        'January', 'February', 'March', 'April', 'May', 'June', 'July',\n        'August', 'September', 'October', 'November', 'December'\n    ],\n    AccessType: {\n        NONE: -1,\n        READ: 0,\n        WRITE: 1,\n        ADMIN: 2\n    },\n    AssetstoreType: {\n        FILESYSTEM: 0,\n        GRIDFS: 1,\n        S3: 2\n    },\n    Layout: {\n        DEFAULT: 'default',\n        EMPTY: 'empty'\n    },\n    layout: 'default',\n\n    /**\n     * Make a request to the REST API. Bind a \"done\" handler to the return\n     * value that will be called when the response is successful. To bind a\n     * custom error handler, bind an \"error\" handler to the return promise,\n     * which will be executed in addition to the normal behavior of logging\n     * the error to the console. To override the default error handling\n     * behavior, pass an \"error\" key in your opts object; this should be done\n     * any time the server might throw an exception from validating user input,\n     * e.g. logging in, registering, or generally filling out forms.\n     *\n     * @param path The resource path, e.g. \"user/login\"\n     * @param data The form parameter object.\n     * @param [type='GET'] The HTTP method to invoke.\n     * @param [girderToken] An alternative auth token to use for this request.\n     */\n    restRequest: function (opts) {\n        opts = opts || {};\n        var defaults = {\n            dataType: 'json',\n            type: 'GET',\n\n            error: function (error, status) {\n                var info;\n                if (error.status === 401) {\n                    girder.events.trigger('g:loginUi');\n                    info = {\n                        text: 'You must log in to view this resource',\n                        type: 'warning',\n                        timeout: 4000,\n                        icon: 'info'\n                    };\n                } else if (error.status === 403) {\n                    info = {\n                        text: 'Access denied. See the console for more details.',\n                        type: 'danger',\n                        timeout: 5000,\n                        icon: 'attention'\n                    };\n                } else if (error.status === 0 && error.statusText === 'abort') {\n                    /* We expected this abort, so do nothing. */\n                    return;\n                } else if (error.status === 500 && error.responseJSON &&\n                           error.responseJSON.type === 'girder') {\n                    info = {\n                        text: error.responseJSON.message,\n                        type: 'warning',\n                        timeout: 5000,\n                        icon: 'info'\n                    };\n                } else if (status === 'parsererror') {\n                    info = {\n                        text: 'A parser error occurred while communicating with the ' +\n                              'server (did you use the correct value for `dataType`?). ' +\n                              'Details have been logged in the console.',\n                        type: 'danger',\n                        timeout: 5000,\n                        icon: 'attention'\n                    };\n                } else {\n                    info = {\n                        text: 'An error occurred while communicating with the ' +\n                              'server. Details have been logged in the console.',\n                        type: 'danger',\n                        timeout: 5000,\n                        icon: 'attention'\n                    };\n                }\n                girder.events.trigger('g:alert', info);\n                console.error(error.status + ' ' + error.statusText, error.responseText);\n                girder.lastError = error;\n            }\n        };\n\n        if (opts.path.substring(0, 1) !== '/') {\n            opts.path = '/' + opts.path;\n        }\n        opts.url = girder.apiRoot + opts.path;\n\n        opts = _.extend(defaults, opts);\n\n        var token = opts.girderToken ||\n                    girder.currentToken ||\n                    girder.cookie.find('girderToken');\n        if (token) {\n            opts.headers = opts.headers || {};\n            opts.headers['Girder-Token'] = token;\n        }\n        return Backbone.ajax(opts);\n    },\n\n    /**\n     * Log in to the server. If successful, sets the value of girder.currentUser\n     * and girder.currentToken and triggers the \"g:login\" and \"g:login.success\".\n     * On failure, triggers the \"g:login.error\" event.\n     *\n     * @param username The username or email to login as.\n     * @param password The password to use.\n     * @param cors If the girder server is on a different origin, set this\n     *        to \"true\" to save the auth cookie on the current domain. Alternatively,\n     *        you may set the global option \"girder.corsAuth = true\".\n     */\n    login: function (username, password, cors) {\n        var auth = 'Basic ' + window.btoa(username + ':' + password);\n        if (cors === undefined) {\n            cors = girder.corsAuth;\n        }\n\n        return girder.restRequest({\n            method: 'GET',\n            path: '/user/authentication',\n            headers: {\n                'Girder-Authorization': auth\n            },\n            error: null\n        }).then(function (response) {\n            response.user.token = response.authToken;\n\n            girder.currentUser = new girder.models.UserModel(response.user);\n            girder.currentToken = response.user.token.token;\n\n            if (cors && !girder.cookie.find('girderToken')) {\n                // For cross-origin requests, we should write the token into\n                // this document's cookie also.\n                document.cookie = 'girderToken=' + girder.currentToken;\n            }\n\n            girder.events.trigger('g:login.success', response.user);\n            girder.events.trigger('g:login', response);\n\n            return response.user;\n        }, function (jqxhr) {\n            girder.events.trigger('g:login.error', jqxhr.status, jqxhr);\n            return jqxhr;\n        });\n    },\n\n    logout: function () {\n        return girder.restRequest({\n            method: 'DELETE',\n            path: '/user/authentication'\n        }).then(function () {\n            girder.currentUser = null;\n            girder.currentToken = null;\n\n            girder.events.trigger('g:login', null);\n            girder.events.trigger('g:logout.success');\n        }, function (jqxhr) {\n            girder.events.trigger('g:logout.error', jqxhr.status, jqxhr);\n        });\n    },\n\n    fetchCurrentUser: function () {\n        return girder.restRequest({\n            method: 'GET',\n            path: '/user/me'\n        });\n    }\n});\n\n/**\n * The old \"jade.templates\" namespace is deprecated as of version 1.1, but is\n * retained here for backward compatibility. It will be removed in version 2.0.\n */\n/* jshint -W079 */\nvar jade = jade || {};\njade.templates = girder.templates;\n","this[\"girder\"] = this[\"girder\"] || {};\nthis[\"girder\"][\"templates\"] = this[\"girder\"][\"templates\"] || {};\n\nthis[\"girder\"][\"templates\"][\"adminConsole\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<ul class=\\\"g-admin-options\\\"><li class=\\\"g-server-config\\\"><i class=\\\"icon-cog-alt\\\"></i> Server configuration</li><li class=\\\"g-plugins-config\\\"><i class=\\\"icon-puzzle\\\"></i> Plugins</li><li class=\\\"g-assetstore-config\\\"><i class=\\\"icon-box-1\\\"></i> Assetstores</li></ul>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"assetstores\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),assetstores = locals_.assetstores,undefined = locals_.undefined,types = locals_.types,importableTypes = locals_.importableTypes;\nbuf.push(\"<div class=\\\"g-current-assetstores-container\\\"><div class=\\\"g-body-title\\\">Assetstores</div>\");\nif ( !assetstores.length)\n{\nbuf.push(\"<div class=\\\"g-bottom-message\\\">You must create an assetstore before you can upload files to the server.\\nSelect from the options below to create one.</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"g-bottom-message\\\">Below is a list of all of the assetstores available to the server. The\\none set as \\\"current\\\" is the one that uploaded files will be written to.</div>\");\n}\n// iterate assetstores\n;(function(){\n  var $$obj = assetstores;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var assetstore = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.cls(['g-assetstore-container','panel','panel-default',assetstore.get('current')? 'g-assetstore-current' : undefined], [null,null,null,true])) + \"><div class=\\\"panel-body\\\"><div\" + (jade.attr(\"assetstore-type\", assetstore.get('type'), true, true)) + (jade.attr(\"cid\", assetstore.cid, true, true)) + \" class=\\\"g-assetstore-info-section\\\"><div><b>Name:</b><span class=\\\"g-assetstore-name\\\"> \" + (jade.escape((jade_interp = assetstore.get('name')) == null ? '' : jade_interp)) + \"</span>\");\nif ( assetstore.get('current'))\n{\nbuf.push(\"<span class=\\\"g-assetstore-current-text\\\"> (Current assetstore)</span>\");\n}\nbuf.push(\"</div><div><b>Unique ID:</b><span class=\\\"g-assetstore-id\\\"> \" + (jade.escape((jade_interp = assetstore.id) == null ? '' : jade_interp)) + \"</span></div>\");\nif ( assetstore.get('type') === types.FILESYSTEM)\n{\nbuf.push(\"<div><b>Type:</b><span class=\\\"g-assetstore-type\\\"> Filesystem</span></div><div><b>Root path:</b><span class=\\\"g-assetstore-root\\\"> \" + (jade.escape((jade_interp = assetstore.get('root')) == null ? '' : jade_interp)) + \"</span></div><div><b>File creation permissions (octal):</b><span class=\\\"g-assetstore-perms\\\"> \" + (jade.escape((jade_interp = (assetstore.get('perms') || 0600).toString(8)) == null ? '' : jade_interp)) + \"</span></div>\");\n}\nelse if ( assetstore.get('type') === types.GRIDFS)\n{\nbuf.push(\"<div><b>Type:</b><span class=\\\"g-assetstore-type\\\"> GridFS</span></div><div><b>Database name:</b><span class=\\\"g-assetstore-root\\\"> \" + (jade.escape((jade_interp = assetstore.get('db')) == null ? '' : jade_interp)) + \"</span></div>\");\nif ( assetstore.get('mongohost'))\n{\nbuf.push(\"<div><b>Mongo Host URI:</b><span class=\\\"g-assetstore-mongohost\\\"> \" + (jade.escape((jade_interp = assetstore.get('mongohost')) == null ? '' : jade_interp)) + \"</span></div>\");\nif ( assetstore.get('replicaset'))\n{\nbuf.push(\"<div><b>Replica Set:</b><span class=\\\"g-assetstore-replicaset\\\"> \" + (jade.escape((jade_interp = assetstore.get('replicaset')) == null ? '' : jade_interp)) + \"</span></div>\");\n}\n}\n}\nelse if ( assetstore.get('type') === types.S3)\n{\nbuf.push(\"<div><b>Type:</b><span class=\\\"g-assetstore-type\\\"> S3</span></div><div><b>Bucket:</b><span class=\\\"g-assetstore-bucket\\\"> \" + (jade.escape((jade_interp = assetstore.get('bucket')) == null ? '' : jade_interp)) + \"</span></div>\");\nif ( assetstore.get('prefix'))\n{\nbuf.push(\"<div><b>Path prefix:</b><span class=\\\"g-assetstore-prefix\\\"> \" + (jade.escape((jade_interp = assetstore.get('prefix')) == null ? '' : jade_interp)) + \"</span></div>\");\n}\nbuf.push(\"<div><b>Access key ID:</b><span class=\\\"g-access-key-id\\\"> \" + (jade.escape((jade_interp = assetstore.get('accessKeyId')) == null ? '' : jade_interp)) + \"</span></div><div><b>Secret access key:</b><span class=\\\"g-secret-key\\\"> \" + (jade.escape((jade_interp = assetstore.get('secret')) == null ? '' : jade_interp)) + \"</span></div><div><b>Service:</b><span class=\\\"g-service-key\\\"> \" + (jade.escape((jade_interp = assetstore.get('service')) == null ? '' : jade_interp)) + \"</span></div>\");\n}\nbuf.push(\"</div>\");\nif ( assetstore.capacityKnown())\n{\nbuf.push(\"<div><b>Capacity:</b><span class=\\\"g-assetstore-capacity\\\"> \" + (jade.escape((jade_interp = assetstore.capacityString()) == null ? '' : jade_interp)) + \"</span><div\" + (jade.attr(\"cid\", \"\" + (assetstore.cid) + \"\", true, true)) + \" class=\\\"g-assetstore-capacity-chart\\\"></div></div>\");\n}\nbuf.push(\"<div class=\\\"g-assetstore-buttons\\\"><button\" + (jade.attr(\"cid\", \"\" + (assetstore.cid) + \"\", true, true)) + \" class=\\\"g-edit-assetstore btn btn-sm btn-default\\\">Edit</button>\");\nif ( !assetstore.get('hasFiles'))\n{\nbuf.push(\"<button\" + (jade.attr(\"cid\", \"\" + (assetstore.cid) + \"\", true, true)) + \" class=\\\"g-delete-assetstore btn btn-sm btn-danger\\\">Delete</button>\");\n}\nelse\n{\nbuf.push(\"<div title=\\\"You must delete all files from the assetstore before you can delete the assetstore.\\\" class=\\\"g-assetstore-button-container\\\"><button\" + (jade.attr(\"cid\", \"\" + (assetstore.cid) + \"\", true, true)) + \" class=\\\"g-delete-assetstore btn btn-sm btn-danger disabled\\\">Delete</button></div>\");\n}\nif ( !assetstore.get('current') && !assetstore.get('readOnly'))\n{\nbuf.push(\"<button\" + (jade.attr(\"cid\", \"\" + (assetstore.cid) + \"\", true, true)) + \" class=\\\"g-set-current btn btn-sm btn-primary\\\">Set as current</button>\");\n}\nif ( importableTypes.indexOf(assetstore.get('type')) !== -1)\n{\nbuf.push(\"<div class=\\\"g-assetstore-import-button-container\\\"><a\" + (jade.attr(\"href\", \"#assetstore/\" + (assetstore.id) + \"/import\", true, true)) + \" class=\\\"g-import-button btn btn-sm btn-success\\\"><i class=\\\"icon-link-ext\\\"></i> Import data</a></div>\");\n}\nbuf.push(\"</div></div></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var assetstore = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.cls(['g-assetstore-container','panel','panel-default',assetstore.get('current')? 'g-assetstore-current' : undefined], [null,null,null,true])) + \"><div class=\\\"panel-body\\\"><div\" + (jade.attr(\"assetstore-type\", assetstore.get('type'), true, true)) + (jade.attr(\"cid\", assetstore.cid, true, true)) + \" class=\\\"g-assetstore-info-section\\\"><div><b>Name:</b><span class=\\\"g-assetstore-name\\\"> \" + (jade.escape((jade_interp = assetstore.get('name')) == null ? '' : jade_interp)) + \"</span>\");\nif ( assetstore.get('current'))\n{\nbuf.push(\"<span class=\\\"g-assetstore-current-text\\\"> (Current assetstore)</span>\");\n}\nbuf.push(\"</div><div><b>Unique ID:</b><span class=\\\"g-assetstore-id\\\"> \" + (jade.escape((jade_interp = assetstore.id) == null ? '' : jade_interp)) + \"</span></div>\");\nif ( assetstore.get('type') === types.FILESYSTEM)\n{\nbuf.push(\"<div><b>Type:</b><span class=\\\"g-assetstore-type\\\"> Filesystem</span></div><div><b>Root path:</b><span class=\\\"g-assetstore-root\\\"> \" + (jade.escape((jade_interp = assetstore.get('root')) == null ? '' : jade_interp)) + \"</span></div><div><b>File creation permissions (octal):</b><span class=\\\"g-assetstore-perms\\\"> \" + (jade.escape((jade_interp = (assetstore.get('perms') || 0600).toString(8)) == null ? '' : jade_interp)) + \"</span></div>\");\n}\nelse if ( assetstore.get('type') === types.GRIDFS)\n{\nbuf.push(\"<div><b>Type:</b><span class=\\\"g-assetstore-type\\\"> GridFS</span></div><div><b>Database name:</b><span class=\\\"g-assetstore-root\\\"> \" + (jade.escape((jade_interp = assetstore.get('db')) == null ? '' : jade_interp)) + \"</span></div>\");\nif ( assetstore.get('mongohost'))\n{\nbuf.push(\"<div><b>Mongo Host URI:</b><span class=\\\"g-assetstore-mongohost\\\"> \" + (jade.escape((jade_interp = assetstore.get('mongohost')) == null ? '' : jade_interp)) + \"</span></div>\");\nif ( assetstore.get('replicaset'))\n{\nbuf.push(\"<div><b>Replica Set:</b><span class=\\\"g-assetstore-replicaset\\\"> \" + (jade.escape((jade_interp = assetstore.get('replicaset')) == null ? '' : jade_interp)) + \"</span></div>\");\n}\n}\n}\nelse if ( assetstore.get('type') === types.S3)\n{\nbuf.push(\"<div><b>Type:</b><span class=\\\"g-assetstore-type\\\"> S3</span></div><div><b>Bucket:</b><span class=\\\"g-assetstore-bucket\\\"> \" + (jade.escape((jade_interp = assetstore.get('bucket')) == null ? '' : jade_interp)) + \"</span></div>\");\nif ( assetstore.get('prefix'))\n{\nbuf.push(\"<div><b>Path prefix:</b><span class=\\\"g-assetstore-prefix\\\"> \" + (jade.escape((jade_interp = assetstore.get('prefix')) == null ? '' : jade_interp)) + \"</span></div>\");\n}\nbuf.push(\"<div><b>Access key ID:</b><span class=\\\"g-access-key-id\\\"> \" + (jade.escape((jade_interp = assetstore.get('accessKeyId')) == null ? '' : jade_interp)) + \"</span></div><div><b>Secret access key:</b><span class=\\\"g-secret-key\\\"> \" + (jade.escape((jade_interp = assetstore.get('secret')) == null ? '' : jade_interp)) + \"</span></div><div><b>Service:</b><span class=\\\"g-service-key\\\"> \" + (jade.escape((jade_interp = assetstore.get('service')) == null ? '' : jade_interp)) + \"</span></div>\");\n}\nbuf.push(\"</div>\");\nif ( assetstore.capacityKnown())\n{\nbuf.push(\"<div><b>Capacity:</b><span class=\\\"g-assetstore-capacity\\\"> \" + (jade.escape((jade_interp = assetstore.capacityString()) == null ? '' : jade_interp)) + \"</span><div\" + (jade.attr(\"cid\", \"\" + (assetstore.cid) + \"\", true, true)) + \" class=\\\"g-assetstore-capacity-chart\\\"></div></div>\");\n}\nbuf.push(\"<div class=\\\"g-assetstore-buttons\\\"><button\" + (jade.attr(\"cid\", \"\" + (assetstore.cid) + \"\", true, true)) + \" class=\\\"g-edit-assetstore btn btn-sm btn-default\\\">Edit</button>\");\nif ( !assetstore.get('hasFiles'))\n{\nbuf.push(\"<button\" + (jade.attr(\"cid\", \"\" + (assetstore.cid) + \"\", true, true)) + \" class=\\\"g-delete-assetstore btn btn-sm btn-danger\\\">Delete</button>\");\n}\nelse\n{\nbuf.push(\"<div title=\\\"You must delete all files from the assetstore before you can delete the assetstore.\\\" class=\\\"g-assetstore-button-container\\\"><button\" + (jade.attr(\"cid\", \"\" + (assetstore.cid) + \"\", true, true)) + \" class=\\\"g-delete-assetstore btn btn-sm btn-danger disabled\\\">Delete</button></div>\");\n}\nif ( !assetstore.get('current') && !assetstore.get('readOnly'))\n{\nbuf.push(\"<button\" + (jade.attr(\"cid\", \"\" + (assetstore.cid) + \"\", true, true)) + \" class=\\\"g-set-current btn btn-sm btn-primary\\\">Set as current</button>\");\n}\nif ( importableTypes.indexOf(assetstore.get('type')) !== -1)\n{\nbuf.push(\"<div class=\\\"g-assetstore-import-button-container\\\"><a\" + (jade.attr(\"href\", \"#assetstore/\" + (assetstore.id) + \"/import\", true, true)) + \" class=\\\"g-import-button btn btn-sm btn-success\\\"><i class=\\\"icon-link-ext\\\"></i> Import data</a></div>\");\n}\nbuf.push(\"</div></div></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div><div id=\\\"g-new-assetstore-container\\\"></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"collectionList\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),girder = locals_.girder,collections = locals_.collections;\nbuf.push(\"<div class=\\\"g-collection-list-header\\\"><div class=\\\"g-collection-pagination\\\"></div><form role=\\\"form\\\" class=\\\"g-collection-search-form form-inline\\\"><div class=\\\"form-group g-collections-search-container\\\"></div></form>\");\nif ( girder.currentUser)\n{\nbuf.push(\"<button class=\\\"g-collection-create-button btn btn-sm btn-default\\\"><i class=\\\"icon-plus-squared\\\"></i> Create collection</button>\");\n}\nbuf.push(\"</div>\");\n// iterate collections\n;(function(){\n  var $$obj = collections;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var collection = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attr(\"public\", (collection.get('public') ? \"true\" : \"false\"), true, true)) + \" class=\\\"g-collection-list-entry g-top-level-list-entry\\\"><div class=\\\"g-collection-right-column\\\"><div class=\\\"g-collection-created\\\"><i class=\\\"icon-clock\\\"></i>Created on<span class=\\\"g-collection-created-date\\\"> \" + (jade.escape((jade_interp = girder.formatDate(collection.get('created'), girder.DATE_MINUTE)) == null ? '' : jade_interp)) + \"</span></div>\");\nif ( collection.has('size'))\n{\nbuf.push(\"<div class=\\\"g-space-used\\\"><i class=\\\"icon-floppy\\\"></i>Currently using<span class=\\\"g-user-space-used\\\"> \" + (jade.escape((jade_interp = girder.formatSize(collection.get('size'))) == null ? '' : jade_interp)) + \"</span></div>\");\n}\nbuf.push(\"</div><div class=\\\"g-list-public-status-icon\\\">\");\nif ( collection.get('public'))\n{\nbuf.push(\"<i title=\\\"Public collection\\\" class=\\\"icon-globe\\\"></i>\");\n}\nelse\n{\nbuf.push(\"<i title=\\\"Private collection\\\" class=\\\"icon-lock\\\"></i>\");\n}\nbuf.push(\"</div><div class=\\\"g-top-level-list-title-container\\\"><div class=\\\"g-collection-title\\\"><a\" + (jade.attr(\"g-collection-cid\", collection.cid, true, true)) + \" class=\\\"g-collection-link\\\"><b>\" + (jade.escape(null == (jade_interp = collection.name()) ? \"\" : jade_interp)) + \"</b></a></div><div class=\\\"g-collection-subtitle\\\"><span class=\\\"g-collection-description\\\">\" + (jade.escape(null == (jade_interp = collection.get('description')) ? \"\" : jade_interp)) + \"</span></div></div><div class=\\\"g-clear-right\\\"></div></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var collection = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attr(\"public\", (collection.get('public') ? \"true\" : \"false\"), true, true)) + \" class=\\\"g-collection-list-entry g-top-level-list-entry\\\"><div class=\\\"g-collection-right-column\\\"><div class=\\\"g-collection-created\\\"><i class=\\\"icon-clock\\\"></i>Created on<span class=\\\"g-collection-created-date\\\"> \" + (jade.escape((jade_interp = girder.formatDate(collection.get('created'), girder.DATE_MINUTE)) == null ? '' : jade_interp)) + \"</span></div>\");\nif ( collection.has('size'))\n{\nbuf.push(\"<div class=\\\"g-space-used\\\"><i class=\\\"icon-floppy\\\"></i>Currently using<span class=\\\"g-user-space-used\\\"> \" + (jade.escape((jade_interp = girder.formatSize(collection.get('size'))) == null ? '' : jade_interp)) + \"</span></div>\");\n}\nbuf.push(\"</div><div class=\\\"g-list-public-status-icon\\\">\");\nif ( collection.get('public'))\n{\nbuf.push(\"<i title=\\\"Public collection\\\" class=\\\"icon-globe\\\"></i>\");\n}\nelse\n{\nbuf.push(\"<i title=\\\"Private collection\\\" class=\\\"icon-lock\\\"></i>\");\n}\nbuf.push(\"</div><div class=\\\"g-top-level-list-title-container\\\"><div class=\\\"g-collection-title\\\"><a\" + (jade.attr(\"g-collection-cid\", collection.cid, true, true)) + \" class=\\\"g-collection-link\\\"><b>\" + (jade.escape(null == (jade_interp = collection.name()) ? \"\" : jade_interp)) + \"</b></a></div><div class=\\\"g-collection-subtitle\\\"><span class=\\\"g-collection-description\\\">\" + (jade.escape(null == (jade_interp = collection.get('description')) ? \"\" : jade_interp)) + \"</span></div></div><div class=\\\"g-clear-right\\\"></div></div>\");\n    }\n\n  }\n}).call(this);\n;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"collectionPage\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),collection = locals_.collection,girder = locals_.girder;\nbuf.push(\"<div class=\\\"g-collection-header\\\"><div class=\\\"btn-group pull-right\\\"><button data-toggle=\\\"dropdown\\\" title=\\\"Collection actions\\\" class=\\\"g-collection-actions-button btn btn-default dropdown-toggle\\\"><i class=\\\"icon-sitemap\\\"></i> Actions<i class=\\\"icon-down-dir\\\"></i></button><ul role=\\\"menu\\\" class=\\\"g-collection-actions-menu dropdown-menu pull-right\\\"><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\"\" + (jade.attr(\"href\", \"\" + (collection.downloadUrl()) + \"\", true, true)) + \" class=\\\"g-download-collection\\\"><i class=\\\"icon-download\\\"></i>Download collection</a></li>\");\nif ( (collection.getAccessLevel() >= girder.AccessType.WRITE))\n{\nbuf.push(\"<li role=\\\"presentation\\\" class=\\\"divider\\\"></li><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-edit-collection\\\"><i class=\\\"icon-edit\\\"></i>Edit collection</a></li>\");\n}\nif ( (collection.getAccessLevel() >= girder.AccessType.ADMIN))\n{\nbuf.push(\"<li role=\\\"presentation\\\" class=\\\"divider\\\"></li><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-collection-access-control\\\"><i class=\\\"icon-lock\\\"></i>Access control</a></li><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-delete-collection\\\"><i class=\\\"icon-trash\\\"></i>Delete collection</a></li>\");\n}\nbuf.push(\"</ul></div><div class=\\\"g-collection-name g-body-title\\\">\" + (jade.escape((jade_interp = collection.get('name')) == null ? '' : jade_interp)) + \"</div><div class=\\\"g-collection-description g-body-subtitle\\\">\" + (jade.escape((jade_interp = collection.get('description')) == null ? '' : jade_interp)) + \"</div><div class=\\\"g-clear-right\\\"></div></div><div class=\\\"g-collection-hierarchy-container\\\"></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"filesystemImport\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),assetstore = locals_.assetstore;\nbuf.push(\"<div class=\\\"g-body-title\\\">Import existing data from the filesystem</div><div class=\\\"g-body-subtitle\\\">\" + (jade.escape((jade_interp = assetstore.get('name')) == null ? '' : jade_interp)) + \"</div><div class=\\\"g-import-instructions\\\">Use this page to import existing data from this assetstore's filesystem.\\nSpecify a root directory on the filesystem, and it will be imported recursively.\\nThe directory does not need to be under the assetstore's root dir. You must also\\nspecify a destination collection, user, or folder ID under which to place the\\nimported data. Files that are imported are not managed directly by the server.\\nThey will not be copied, but will be served from their existing location. When\\nthe referencing files in Girder are deleted, the underlying imported file will\\nnot be removed.\\n</div><form class=\\\"g-filesystem-import-form\\\"><div class=\\\"form-group\\\"><label for=\\\"g-filesystem-import-path\\\">Import path (absolute path to directory or file)</label><input id=\\\"g-filesystem-import-path\\\" type=\\\"text\\\" class=\\\"form-control input-sm\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-filesystem-import-dest-type\\\">Destination type</label><select id=\\\"g-filesystem-import-dest-type\\\" class=\\\"form-control\\\"><option value=\\\"folder\\\">Folder</option><option value=\\\"user\\\">User</option><option value=\\\"collection\\\">Collection</option></select></div><div class=\\\"form-group\\\"><label for=\\\"g-filesystem-import-dest-id\\\">Destination ID</label><div class=\\\"input-group input-group-sm\\\"><input id=\\\"g-filesystem-import-dest-id\\\" type=\\\"text\\\" placeholder=\\\"Existing folder, user, or collection ID to use as the destination\\\" class=\\\"form-control input-sm\\\"><div class=\\\"input-group-btn\\\"><button type=\\\"button\\\" class=\\\"g-open-browser btn btn-default\\\"><i class=\\\"icon-folder-open\\\"></i></button></div></div></div><div class=\\\"form-group\\\"><label for=\\\"g-filesystem-import-leaf-items\\\">Leaf Folders as Items</label><select id=\\\"g-filesystem-import-leaf-items\\\" class=\\\"form-control\\\"><option value=\\\"false\\\">False</option><option value=\\\"true\\\">True</option></select></div><div class=\\\"g-validation-failed-message\\\"></div><button type=\\\"submit\\\" class=\\\"g-submit-assetstore-import btn btn-success\\\"><i class=\\\"icon-link-ext\\\"></i> Begin import</button></form>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"frontPage\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),staticRoot = locals_.staticRoot,apiRoot = locals_.apiRoot,currentUser = locals_.currentUser,versionInfo = locals_.versionInfo;\nbuf.push(\"<div class=\\\"g-frontpage-header\\\"><img\" + (jade.attr(\"src\", \"\" + (staticRoot) + \"/img/Girder_Mark.png\", true, true)) + \" width=\\\"82\\\" class=\\\"g-frontpage-logo\\\"><div class=\\\"g-frontpage-title-container\\\"><div class=\\\"g-frontpage-title\\\">Girder</div><div class=\\\"g-frontpage-subtitle\\\">Data management platform</div></div></div><div class=\\\"g-frontpage-body\\\"><p class=\\\"g-frontpage-paragraph\\\"><b>Welcome to Girder!</b> If this is your first time here, you might want to check out the<a target=\\\"_blank\\\" href=\\\"http://girder.readthedocs.org/en/latest/user-guide.html\\\"> User Guide</a> to learn the basics of how to use the application.\\n To browse the data hosted on this server, start on the<a class=\\\"g-collections-link\\\"> Collections</a> page. If you want to search for specific data on this server, use the<a class=\\\"g-quicksearch-link\\\"> Quick Search</a> box at the top of the screen. Developers who want to use the Girder REST API\\n should check out the<a\" + (jade.attr(\"href\", \"\" + (apiRoot) + \"\", true, true)) + \"> interactive web API docs</a>.\");\nif ( !currentUser)\n{\nbuf.push(\"<p class=\\\"g-frontpage-paragraph\\\"> You are currently browsing anonymously. If you want to create a user\\n account on this server, click the<a class=\\\"g-register-link\\\"> Register</a> link in the upper right corner. If you already have a user, click the<a class=\\\"g-login-link\\\"> Log In</a> link. Otherwise, you will only be able to see publicly visible data\\n in the system.</p>\");\n}\nelse\n{\nbuf.push(\"<p class=\\\"g-frontpage-paragraph\\\"> You are currently logged in as<b> \" + (jade.escape((jade_interp = currentUser.get('login')) == null ? '' : jade_interp)) + \"</b>. You can view your<a class=\\\"g-my-folders-link\\\"> personal data space</a> or go to your<a class=\\\"g-my-account-link\\\"> user account page.</a></p>\");\n}\nbuf.push(\"<p class=\\\"g-frontpage-paragraph\\\">\");\nif ( versionInfo.git)\n{\nbuf.push(\"This instance of Girder was built from Git version&nbsp;<a target=\\\"_blank\\\"\" + (jade.attr(\"href\", \"https://github.com/girder/girder/tree/\" + (versionInfo.SHA) + \"\", true, true)) + \" class=\\\"g-git-sha\\\">\" + (jade.escape(null == (jade_interp = versionInfo.shortSHA) ? \"\" : jade_interp)) + \"</a>.\");\n}\nelse\n{\nbuf.push(\"This instance of Girder was built on \" + (jade.escape((jade_interp = new Date(versionInfo.date).toLocaleDateString()) == null ? '' : jade_interp)) + \".\");\n}\nif ( versionInfo.apiVersion)\n{\nbuf.push(\"  API Version \" + (jade.escape((jade_interp = versionInfo.apiVersion) == null ? '' : jade_interp)) + \".\");\n}\nbuf.push(\"</p></p></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"groupList\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),girder = locals_.girder,groups = locals_.groups;\nbuf.push(\"<div class=\\\"g-groups-list-header\\\"><div class=\\\"g-group-pagination\\\"></div><form role=\\\"form\\\" class=\\\"g-group-search-form form-inline\\\"><div class=\\\"form-group g-groups-search-container\\\"></div></form>\");\nif ( girder.currentUser)\n{\nbuf.push(\"<button class=\\\"g-group-create-button btn btn-sm btn-default\\\"><i class=\\\"icon-plus-squared\\\"></i> Create Group</button>\");\n}\nbuf.push(\"</div>\");\n// iterate groups\n;(function(){\n  var $$obj = groups;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var group = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attr(\"public\", (group.get('public') ? \"true\" : \"false\"), true, true)) + \" class=\\\"g-group-list-entry g-top-level-list-entry\\\"><div class=\\\"g-group-right-column\\\"><div class=\\\"g-group-created\\\"><i class=\\\"icon-clock\\\"></i>Created on<span class=\\\"g-group-created-date\\\"> \" + (jade.escape((jade_interp = girder.formatDate(group.get('created'), girder.DATE_DAY)) == null ? '' : jade_interp)) + \"</span></div></div><div class=\\\"g-list-public-status-icon\\\">\");\nif ( group.get('public'))\n{\nbuf.push(\"<i title=\\\"Public group\\\" class=\\\"icon-globe\\\"></i>\");\n}\nelse\n{\nbuf.push(\"<i title=\\\"Private group\\\" class=\\\"icon-lock\\\"></i>\");\n}\nbuf.push(\"</div><div class=\\\"g-top-level-list-title-container\\\"><div class=\\\"g-group-title\\\"><a\" + (jade.attr(\"g-group-cid\", group.cid, true, true)) + \" class=\\\"g-group-link\\\"><b>\" + (jade.escape(null == (jade_interp = group.name()) ? \"\" : jade_interp)) + \"</b></a></div><div class=\\\"g-group-subtitle\\\"><span class=\\\"g-group-description\\\">\" + (jade.escape(null == (jade_interp = group.get('description')) ? \"\" : jade_interp)) + \"</span></div></div><div class=\\\"g-clear-right\\\"></div></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var group = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attr(\"public\", (group.get('public') ? \"true\" : \"false\"), true, true)) + \" class=\\\"g-group-list-entry g-top-level-list-entry\\\"><div class=\\\"g-group-right-column\\\"><div class=\\\"g-group-created\\\"><i class=\\\"icon-clock\\\"></i>Created on<span class=\\\"g-group-created-date\\\"> \" + (jade.escape((jade_interp = girder.formatDate(group.get('created'), girder.DATE_DAY)) == null ? '' : jade_interp)) + \"</span></div></div><div class=\\\"g-list-public-status-icon\\\">\");\nif ( group.get('public'))\n{\nbuf.push(\"<i title=\\\"Public group\\\" class=\\\"icon-globe\\\"></i>\");\n}\nelse\n{\nbuf.push(\"<i title=\\\"Private group\\\" class=\\\"icon-lock\\\"></i>\");\n}\nbuf.push(\"</div><div class=\\\"g-top-level-list-title-container\\\"><div class=\\\"g-group-title\\\"><a\" + (jade.attr(\"g-group-cid\", group.cid, true, true)) + \" class=\\\"g-group-link\\\"><b>\" + (jade.escape(null == (jade_interp = group.name()) ? \"\" : jade_interp)) + \"</b></a></div><div class=\\\"g-group-subtitle\\\"><span class=\\\"g-group-description\\\">\" + (jade.escape(null == (jade_interp = group.get('description')) ? \"\" : jade_interp)) + \"</span></div></div><div class=\\\"g-clear-right\\\"></div></div>\");\n    }\n\n  }\n}).call(this);\n;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"groupPage\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),isMember = locals_.isMember,isInvited = locals_.isInvited,girder = locals_.girder,group = locals_.group,isAdmin = locals_.isAdmin,isModerator = locals_.isModerator,isRequested = locals_.isRequested;\nbuf.push(\"<div class=\\\"g-group-header\\\"><div class=\\\"btn-group pull-right\\\">\");\nif ( (isMember || isInvited || girder.currentUser || group.get('_accessLevel') >= girder.AccessType.ADMIN))\n{\nbuf.push(\"<button data-toggle=\\\"dropdown\\\" title=\\\"Group actions\\\" class=\\\"g-group-actions-button btn btn-default dropdown-toggle\\\"><i class=\\\"icon-users\\\"></i> Actions<i class=\\\"icon-down-dir\\\"></i></button><ul role=\\\"menu\\\" class=\\\"g-group-actions-menu dropdown-menu pull-right\\\">\");\nif ( (isMember))\n{\nbuf.push(\"<li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-group-leave\\\"><i class=\\\"icon-block\\\"></i>Leave group</a></li>\");\n}\nelse if ( (isInvited))\n{\nbuf.push(\"<li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-group-join\\\"><i class=\\\"icon-login\\\"></i>Join group</a></li>\");\n}\nelse if ( (girder.currentUser))\n{\nbuf.push(\"<li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-group-request-invite\\\"><i class=\\\"icon-export\\\"></i>Request membership</a></li>\");\n}\nif ( (group.get('_accessLevel') >= girder.AccessType.ADMIN))\n{\nbuf.push(\"<li role=\\\"presentation\\\" class=\\\"divider\\\"></li><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-edit-group\\\"><i class=\\\"icon-edit\\\"></i>Edit group</a></li>\");\n}\nif ( (group.get('_accessLevel') >= girder.AccessType.ADMIN))\n{\nbuf.push(\"<li role=\\\"presentation\\\" class=\\\"divider\\\"></li><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-group-delete\\\"><i class=\\\"icon-trash\\\"></i>Delete group</a></li>\");\n}\nbuf.push(\"</ul>\");\n}\nbuf.push(\"</div><div class=\\\"g-group-name g-body-title\\\">\" + (jade.escape((jade_interp = group.get('name')) == null ? '' : jade_interp)) + \"</div><div class=\\\"g-group-description g-body-subtitle\\\">\" + (jade.escape((jade_interp = group.get('description')) == null ? '' : jade_interp)) + \"</div><div class=\\\"g-clear-right\\\"></div></div>\");\nif ( (girder.currentUser))\n{\nif ( (isMember))\n{\nbuf.push(\"<div class=\\\"g-group-status-container g-member\\\"><i class=\\\"icon-ok\\\"></i>\");\nif ( (isAdmin))\n{\nbuf.push(\" You are an <b>administrator</b> of this group.\");\n}\nelse if ( (isModerator))\n{\nbuf.push(\" You are a <b>moderator</b> of this group.\");\n}\nelse\n{\nbuf.push(\" You are a <b>member</b> of this group.\");\n}\nbuf.push(\"</div>\");\n}\nelse if ( (isInvited))\n{\nbuf.push(\"<div class=\\\"g-group-status-container g-invited\\\"><i class=\\\"icon-mail-alt\\\"></i> You have been invited to this group.<a class=\\\"g-group-join\\\"> Join group</a></div>\");\n}\nelse if ( (isRequested))\n{\nbuf.push(\"<div class=\\\"g-group-status-container g-requested-invite\\\"><i class=\\\"icon-comment\\\"></i> You have requested to join this group.</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"g-group-status-container g-nonmember\\\"><i class=\\\"icon-minus-circled\\\"></i> You are not a member of this group.<a class=\\\"g-group-request-invite\\\"> Request membership</a></div>\");\n}\nif ( (group.get('_accessLevel') >= girder.AccessType.ADMIN && !isAdmin))\n{\nbuf.push(\"<div class=\\\"g-group-status-container g-admin\\\"><i class=\\\"icon-star\\\"></i> You have <b>administrator</b> privileges.</div>\");\n}\n}\nbuf.push(\"<ul class=\\\"g-group-tabs nav nav-tabs\\\"><li class=\\\"active\\\"><a href=\\\"#g-group-tab-roles\\\" data-toggle=\\\"tab\\\" name=\\\"roles\\\"><i class=\\\"icon-th-list\\\"></i> Roles</a></li><li><a href=\\\"#g-group-tab-pending\\\" data-toggle=\\\"tab\\\" name=\\\"pending\\\"><i class=\\\"icon-inbox\\\"></i>Pending<div id=\\\"g-group-tab-pending-status\\\"></div></a></li></ul><div class=\\\"tab-content\\\"><div id=\\\"g-group-tab-roles\\\" class=\\\"tab-pane active\\\"><div class=\\\"g-group-admins-container\\\"></div><div class=\\\"g-group-mods-container\\\"></div><div class=\\\"g-group-members-container\\\"></div></div><div id=\\\"g-group-tab-pending\\\" class=\\\"tab-pane\\\"><div class=\\\"g-group-requests-container\\\"><div class=\\\"g-group-requests-header g-group-list-header\\\"><i class=\\\"icon-comment\\\"></i> Requests for membership</div><div class=\\\"g-group-requests-body\\\"><ul class=\\\"g-group-requests\\\">\");\n// iterate group.get('requests')\n;(function(){\n  var $$obj = group.get('requests');\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var user = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attr(\"userid\", \"\" + (user.id) + \"\", true, true)) + \"><a class=\\\"g-member-name\\\"><i class=\\\"icon-user\\\"></i> \" + (jade.escape((jade_interp = user.name) == null ? '' : jade_interp)) + \" (\" + (jade.escape((jade_interp = user.login) == null ? '' : jade_interp)) + \")</a><div class=\\\"g-group-member-controls pull-right\\\">\");\nif ( group.get('_accessLevel') >= girder.AccessType.WRITE)\n{\nbuf.push(\"<a title=\\\"Add to group\\\" class=\\\"g-group-request-accept\\\"><i class=\\\"icon-thumbs-up\\\"></i></a><a title=\\\"Deny request\\\" class=\\\"g-group-request-deny\\\"><i class=\\\"icon-thumbs-down\\\"></i></a>\");\n}\nbuf.push(\"</div></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var user = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attr(\"userid\", \"\" + (user.id) + \"\", true, true)) + \"><a class=\\\"g-member-name\\\"><i class=\\\"icon-user\\\"></i> \" + (jade.escape((jade_interp = user.name) == null ? '' : jade_interp)) + \" (\" + (jade.escape((jade_interp = user.login) == null ? '' : jade_interp)) + \")</a><div class=\\\"g-group-member-controls pull-right\\\">\");\nif ( group.get('_accessLevel') >= girder.AccessType.WRITE)\n{\nbuf.push(\"<a title=\\\"Add to group\\\" class=\\\"g-group-request-accept\\\"><i class=\\\"icon-thumbs-up\\\"></i></a><a title=\\\"Deny request\\\" class=\\\"g-group-request-deny\\\"><i class=\\\"icon-thumbs-down\\\"></i></a>\");\n}\nbuf.push(\"</div></li>\");\n    }\n\n  }\n}).call(this);\n\nif ( (!group.get('requests').length))\n{\nbuf.push(\"<div class=\\\"g-member-list-empty\\\"><i class=\\\"icon-info-circled\\\"></i> There are no outstanding invitation requests for this group.</div>\");\n}\nbuf.push(\"</ul></div></div><div class=\\\"g-group-invites-container\\\"><div class=\\\"g-group-invites-header g-group-list-header\\\"><i class=\\\"icon-mail-alt\\\"></i> Sent invitations</div><div class=\\\"g-group-invites-body\\\"></div></div></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"itemPage\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),accessLevel = locals_.accessLevel,girder = locals_.girder,item = locals_.item;\nbuf.push(\"<div class=\\\"g-item-breadcrumb-container\\\"></div><div class=\\\"g-item-header\\\"><div class=\\\"pull-right\\\">\");\nif ( (accessLevel >= girder.AccessType.WRITE))\n{\nbuf.push(\"<button title=\\\"Upload files into item\\\" class=\\\"g-upload-into-item btn btn-sm btn-success\\\"><i class=\\\"icon-upload\\\"></i></button>\");\n}\nbuf.push(\"<div class=\\\"btn-group\\\"><button data-toggle=\\\"dropdown\\\" title=\\\"Item actions\\\" class=\\\"g-item-actions-button btn btn-sm btn-default dropdown-toggle\\\"><i class=\\\"icon-doc-text-inv\\\"></i> Actions<i class=\\\"icon-down-dir\\\"></i></button><ul role=\\\"menu\\\" class=\\\"g-item-actions-menu dropdown-menu pull-right\\\"><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\"\" + (jade.attr(\"href\", item.downloadUrl(), true, true)) + \" class=\\\"g-download-item\\\"><i class=\\\"icon-download\\\"></i>Download item</a></li>\");\nif ( (accessLevel >= girder.AccessType.WRITE))\n{\nbuf.push(\"<li role=\\\"presentation\\\" class=\\\"divider\\\"></li><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-edit-item\\\"><i class=\\\"icon-edit\\\"></i>Edit item</a></li><li role=\\\"presentation\\\" class=\\\"divider\\\"></li><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-delete-item\\\"><i class=\\\"icon-trash\\\"></i>Delete item</a></li>\");\n}\nbuf.push(\"</ul></div></div><div class=\\\"g-item-name g-body-title\\\">\" + (jade.escape(null == (jade_interp = item.name()) ? \"\" : jade_interp)) + \"</div><div class=\\\"g-item-description g-body-subtitle\\\">\" + (jade.escape(null == (jade_interp = item.get('description')) ? \"\" : jade_interp)) + \"</div></div><div class=\\\"g-item-info\\\"><div class=\\\"g-item-info-header\\\"><i class=\\\"icon-info\\\"></i>Info</div><div class=\\\"g-item-size g-info-list-entry\\\"><i class=\\\"icon-hdd\\\"></i>\");\nif ( item.get('size') < 1024)\n{\nbuf.push(\"\" + (jade.escape((jade_interp = item.get('size')) == null ? '' : jade_interp)) + \" bytes\");\n}\nelse\n{\nbuf.push(\"\" + (jade.escape((jade_interp = girder.formatSize(item.get('size'))) == null ? '' : jade_interp)) + \" (\" + (jade.escape((jade_interp = item.get('size')) == null ? '' : jade_interp)) + \" bytes)\");\n}\nbuf.push(\"</div><div class=\\\"g-item-created g-info-list-entry\\\"><i class=\\\"icon-clock\\\"></i>Created on \" + (jade.escape((jade_interp = girder.formatDate(item.get('created'), girder.DATE_SECOND)) == null ? '' : jade_interp)) + \"</div><div class=\\\"g-item-updated g-info-list-entry\\\"><i class=\\\"icon-clock\\\"></i>Updated on \" + (jade.escape((jade_interp = girder.formatDate(item.get('updated'), girder.DATE_SECOND)) == null ? '' : jade_interp)) + \"</div></div><div class=\\\"g-item-metadata\\\"></div><div class=\\\"g-item-files\\\"><div class=\\\"g-item-files-header\\\"><i class=\\\"icon-docs\\\"></i> Files &amp; links</div><div class=\\\"g-item-files-container\\\"></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"plugins\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),allPlugins = locals_.allPlugins,undefined = locals_.undefined;\nbuf.push(\"<div class=\\\"g-body-title\\\">Plugins</div><div class=\\\"g-plugin-restart\\\"><button class=\\\"g-plugin-restart-button btn btn-danger\\\"><i class=\\\"icon-cw\\\"></i>Restart Server</button><div class=\\\"g-plugin-restart-text\\\">The selected plugins have changed.  You must restart the server for the\\nchanges to take effect.</div><div class=\\\"g-plugin-clear\\\"></div></div><div class=\\\"g-plugin-list-container\\\">\");\n// iterate allPlugins\n;(function(){\n  var $$obj = allPlugins;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var plugin = $$obj[$index];\n\nvar experimental = plugin.value.version ? plugin.value.version.indexOf('0.') === 0 : true\nbuf.push(\"<div class=\\\"g-plugin-list-item\\\"><input type=\\\"checkbox\\\"\" + (jade.attr(\"key\", plugin.key, true, true)) + (jade.attr(\"disabled\", plugin.value.unmetDependencies.length > 0, true, true)) + (jade.attr(\"checked\", (plugin.value.enabled ? \"checked\" : undefined), true, true)) + (jade.attr(\"experimental\", (experimental ? \"true\" : undefined), true, true)) + (jade.attr(\"data-on-color\", (experimental ? \"warning\" : \"primary\"), true, true)) + \" class=\\\"g-plugin-switch\\\"><div class=\\\"g-plugin-name\\\"><span>\" + (jade.escape(null == (jade_interp = plugin.value.name) ? \"\" : jade_interp)) + \"</span>\");\nif ( plugin.value.version)\n{\nbuf.push(\"<span class=\\\"g-plugin-version\\\">Version \" + (jade.escape((jade_interp = plugin.value.version) == null ? '' : jade_interp)) + \"</span>\");\n}\nif ( experimental)\n{\nbuf.push(\"<span title=\\\"WARNING: this plugin is an alpha version and is subject to breaking changes; use at your own risk.\\\" class=\\\"g-experimental-notice\\\">Experimental</span>\");\n}\nif ( plugin.value.configRoute)\n{\nbuf.push(\"<a\" + (jade.attr(\"g-route\", plugin.value.configRoute, true, true)) + \" title=\\\"Configure Plugin\\\" class=\\\"g-plugin-config-link\\\"><i class=\\\"icon-cog\\\"></i></a>\");\n}\nbuf.push(\"</div><div class=\\\"g-plugin-description\\\">\" + (jade.escape((jade_interp = plugin.value.description) == null ? '' : jade_interp)) + \"\");\nif ( (plugin.value.unmetDependencies.length))\n{\nbuf.push(\"<div class=\\\"g-plugin-warning g-plugin-error-message\\\">This plugin has unmet dependencies: \" + (jade.escape((jade_interp = plugin.value.unmetDependencies.join(', ')) == null ? '' : jade_interp)) + \".</div>\");\n}\nbuf.push(\"</div></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var plugin = $$obj[$index];\n\nvar experimental = plugin.value.version ? plugin.value.version.indexOf('0.') === 0 : true\nbuf.push(\"<div class=\\\"g-plugin-list-item\\\"><input type=\\\"checkbox\\\"\" + (jade.attr(\"key\", plugin.key, true, true)) + (jade.attr(\"disabled\", plugin.value.unmetDependencies.length > 0, true, true)) + (jade.attr(\"checked\", (plugin.value.enabled ? \"checked\" : undefined), true, true)) + (jade.attr(\"experimental\", (experimental ? \"true\" : undefined), true, true)) + (jade.attr(\"data-on-color\", (experimental ? \"warning\" : \"primary\"), true, true)) + \" class=\\\"g-plugin-switch\\\"><div class=\\\"g-plugin-name\\\"><span>\" + (jade.escape(null == (jade_interp = plugin.value.name) ? \"\" : jade_interp)) + \"</span>\");\nif ( plugin.value.version)\n{\nbuf.push(\"<span class=\\\"g-plugin-version\\\">Version \" + (jade.escape((jade_interp = plugin.value.version) == null ? '' : jade_interp)) + \"</span>\");\n}\nif ( experimental)\n{\nbuf.push(\"<span title=\\\"WARNING: this plugin is an alpha version and is subject to breaking changes; use at your own risk.\\\" class=\\\"g-experimental-notice\\\">Experimental</span>\");\n}\nif ( plugin.value.configRoute)\n{\nbuf.push(\"<a\" + (jade.attr(\"g-route\", plugin.value.configRoute, true, true)) + \" title=\\\"Configure Plugin\\\" class=\\\"g-plugin-config-link\\\"><i class=\\\"icon-cog\\\"></i></a>\");\n}\nbuf.push(\"</div><div class=\\\"g-plugin-description\\\">\" + (jade.escape((jade_interp = plugin.value.description) == null ? '' : jade_interp)) + \"\");\nif ( (plugin.value.unmetDependencies.length))\n{\nbuf.push(\"<div class=\\\"g-plugin-warning g-plugin-error-message\\\">This plugin has unmet dependencies: \" + (jade.escape((jade_interp = plugin.value.unmetDependencies.join(', ')) == null ? '' : jade_interp)) + \".</div>\");\n}\nbuf.push(\"</div></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"s3Import\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),assetstore = locals_.assetstore;\nbuf.push(\"<div class=\\\"g-body-title\\\">Import existing data from S3</div><div class=\\\"g-body-subtitle\\\">\" + (jade.escape((jade_interp = assetstore.get('name')) == null ? '' : jade_interp)) + \"</div><div class=\\\"g-import-instructions g-s3import-instructions\\\">Use this page to import existing data from this assetstore's S3 bucket\\n(<b>\" + (jade.escape((jade_interp = assetstore.get('bucket')) == null ? '' : jade_interp)) + \"</b>). You may import a specific directory of keys\\nwithin the bucket, or a specific key by path. If you wish to import the entire\\nbucket into the selected destination, simply leave the import path field blank.\\nIf you specify a directory, it will be imported recursively. You must also\\nspecify a destination collection, user, or folder ID under which to place the\\nimported data.\\n</div><form class=\\\"g-s3-import-form\\\"><div class=\\\"form-group\\\"><label for=\\\"g-s3-import-path\\\">Import path (key or directory)</label><input id=\\\"g-s3-import-path\\\" type=\\\"text\\\" class=\\\"form-control input-sm\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-s3-import-dest-type\\\">Destination type</label><select id=\\\"g-s3-import-dest-type\\\" class=\\\"form-control\\\"><option value=\\\"folder\\\">Folder</option><option value=\\\"user\\\">User</option><option value=\\\"collection\\\">Collection</option></select></div><div class=\\\"form-group\\\"><label for=\\\"g-s3-import-dest-id\\\">Destination ID</label><input id=\\\"g-s3-import-dest-id\\\" type=\\\"text\\\" placeholder=\\\"Existing folder, user, or collection ID to use as the destination\\\" class=\\\"form-control input-sm\\\"></div><div class=\\\"g-validation-failed-message\\\"></div><button type=\\\"submit\\\" class=\\\"g-submit-assetstore-import g-submit-s3-import btn btn-success\\\"><i class=\\\"icon-link-ext\\\"></i> Begin import</button></form>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"systemConfiguration\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),settings = locals_.settings,defaults = locals_.defaults;\nbuf.push(\"<div class=\\\"g-body-title\\\">System configuration</div><form role=\\\"form\\\" class=\\\"g-settings-form\\\"><div class=\\\"form-group\\\"><label for=\\\"g-core-cookie-lifetime\\\">Cookie duration (days)</label><input id=\\\"g-core-cookie-lifetime\\\" type=\\\"text\\\"\" + (jade.attr(\"value\", \"\" + (settings['core.cookie_lifetime'] || '') + \"\", true, true)) + (jade.attr(\"placeholder\", \"Default: \" + (defaults['core.cookie_lifetime'] || 'none') + \"\", true, true)) + \" title=\\\"How long users will stay logged in.\\\" class=\\\"form-control input-sm\\\"></div><div class=\\\"g-settings-form-container\\\"><h4>Administrative Policy</h4><div class=\\\"form-group\\\"><label for=\\\"g-core-registration-policy\\\">Registration policy</label><select id=\\\"g-core-registration-policy\\\" class=\\\"form-control input-sm\\\"><option value=\\\"open\\\"\" + (jade.attr(\"selected\", ((settings['core.registration_policy'] ||\n          defaults['core.registration_policy']) === \"open\"), true, true)) + \">Open registration</option><option value=\\\"closed\\\"\" + (jade.attr(\"selected\", ((settings['core.registration_policy'] ||\n          defaults['core.registration_policy']) === \"closed\"), true, true)) + \">Closed registration</option><option value=\\\"approve\\\"\" + (jade.attr(\"selected\", ((settings['core.registration_policy'] ||\n          defaults['core.registration_policy']) === \"approve\"), true, true)) + \">Admin approval required</option></select></div><div class=\\\"form-group\\\"><label for=\\\"g-core-email-verification\\\">Email verification</label><select id=\\\"g-core-email-verification\\\" class=\\\"form-control input-sm\\\"><option value=\\\"required\\\"\" + (jade.attr(\"selected\", ((settings['core.email_verification'] ||\n          defaults['core.email_verification']) === \"required\"), true, true)) + \">Required</option><option value=\\\"optional\\\"\" + (jade.attr(\"selected\", ((settings['core.email_verification'] ||\n          defaults['core.email_verification']) === \"optional\"), true, true)) + \">Optional</option><option value=\\\"disabled\\\"\" + (jade.attr(\"selected\", ((settings['core.email_verification'] ||\n          defaults['core.email_verification']) === \"disabled\"), true, true)) + \">Disabled</option></select></div><div class=\\\"form-group\\\"><label for=\\\"g-core-add-to-group-policy\\\">Allow members to be directly added to groups</label><select id=\\\"g-core-add-to-group-policy\\\" class=\\\"form-control input-sm\\\"><option value=\\\"never\\\"\" + (jade.attr(\"selected\", ((settings['core.add_to_group_policy'] ||\n          defaults['core.add_to_group_policy']) === \"never\"), true, true)) + \">No, members must be invited and accept invitations</option><option value=\\\"noadmin\\\"\" + (jade.attr(\"selected\", ((settings['core.add_to_group_policy'] ||\n          defaults['core.add_to_group_policy']) === \"noadmin\"), true, true)) + \">No, except for group administrators when enabled per group</option><option value=\\\"nomod\\\"\" + (jade.attr(\"selected\", ((settings['core.add_to_group_policy'] ||\n          defaults['core.add_to_group_policy']) === \"nomod\"), true, true)) + \">No, except for group administrators and moderators when enabled per group</option><option value=\\\"yesadmin\\\"\" + (jade.attr(\"selected\", ((settings['core.add_to_group_policy'] ||\n          defaults['core.add_to_group_policy']) === \"yesadmin\"), true, true)) + \">Yes, by group administrators unless disabled per group</option><option value=\\\"yesmod\\\"\" + (jade.attr(\"selected\", ((settings['core.add_to_group_policy'] ||\n          defaults['core.add_to_group_policy']) === \"yesmod\"), true, true)) + \">Yes, by group administrators and moderators unless disabled per group</option></select></div><div class=\\\"g-collection-create-policy-container g-settings-form-container\\\"><label for=\\\"g-core-collection-create-policy\\\">Collection creation policy</label><textarea id=\\\"g-core-collection-create-policy\\\" class=\\\"form-control\\\">\" + (jade.escape(null == (jade_interp = JSON.stringify(settings['core.collection_create_policy'] || defaults['core.collection_create_policy'], null, 4)) ? \"\" : jade_interp)) + \"</textarea><div class=\\\"g-search-container\\\"></div></div><div class=\\\"form-group\\\"><label for=\\\"g-core-user-default-folders\\\">Create default folders for new users</label><select id=\\\"g-core-user-default-folders\\\" class=\\\"form-control input-sm\\\"><option value=\\\"none\\\"\" + (jade.attr(\"selected\", ((settings['core.user_default_folders'] ||\n          defaults['core.user_default_folders']) === \"none\"), true, true)) + \">No</option><option value=\\\"public_private\\\"\" + (jade.attr(\"selected\", ((settings['core.user_default_folders'] ||\n          defaults['core.user_default_folders']) === \"public_private\"), true, true)) + \">Yes, \\\"Public\\\" and \\\"Private\\\"</option></select></div></div><div class=\\\"g-settings-form-container\\\"><h4>Email Creation</h4><div class=\\\"form-group\\\"><label for=\\\"g-core-email-from-address\\\">Email from address</label><input id=\\\"g-core-email-from-address\\\" type=\\\"text\\\"\" + (jade.attr(\"value\", \"\" + (settings['core.email_from_address'] || '') + \"\", true, true)) + (jade.attr(\"placeholder\", \"Default: \" + (defaults['core.email_from_address'] || 'none') + \"\", true, true)) + \" title=\\\"The email address the system will use when sending emails.\\\" class=\\\"form-control input-sm\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-core-email-host\\\">Email host</label><input id=\\\"g-core-email-host\\\" type=\\\"text\\\"\" + (jade.attr(\"value\", \"\" + (settings['core.email_host'] || '') + \"\", true, true)) + (jade.attr(\"placeholder\", \"Default: \" + (defaults['core.email_host'] || 'none') + \"\", true, true)) + \" title=\\\"The host email server that is shown as a link in the footer of emails.\\\" class=\\\"form-control input-sm\\\"></div></div><div class=\\\"g-settings-form-container\\\"><h4>Email Delivery</h4><div class=\\\"form-group\\\"><label for=\\\"g-core-smtp-host\\\">SMTP host</label><input id=\\\"g-core-smtp-host\\\" type=\\\"text\\\"\" + (jade.attr(\"value\", \"\" + (settings['core.smtp_host'] || '') + \"\", true, true)) + (jade.attr(\"placeholder\", \"Default: \" + (defaults['core.smtp_host'] || 'none') + \"\", true, true)) + \" title=\\\"The hostname of the SMTP server used to send emails.\\\" class=\\\"form-control input-sm\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-core-smtp-port\\\">SMTP port</label><input id=\\\"g-core-smtp-port\\\" type=\\\"text\\\"\" + (jade.attr(\"value\", \"\" + (settings['core.smtp.port'] || '') + \"\", true, true)) + (jade.attr(\"placeholder\", \"Default: \" + (defaults['core.smtp.port'] || 'none') + \"\", true, true)) + \" title=\\\"The port number of the SMTP server used to send emails.\\\" class=\\\"form-control input-sm\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-core-smtp-encryption\\\">SMTP encryption</label><select id=\\\"g-core-smtp-encryption\\\" class=\\\"form-control input-sm\\\"><option value=\\\"none\\\"\" + (jade.attr(\"selected\", ((settings['core.smtp.encryption'] || defaults['core.smtp.encryption']) === \"none\"), true, true)) + \">None</option><option value=\\\"starttls\\\"\" + (jade.attr(\"selected\", ((settings['core.smtp.encryption'] || defaults['core.smtp.encryption']) === \"starttls\"), true, true)) + \">Use STARTTLS</option><option value=\\\"ssl\\\"\" + (jade.attr(\"selected\", ((settings['core.smtp.encryption'] || defaults['core.smtp.encryption']) === \"ssl\"), true, true)) + \">Use SSL/TLS</option></select></div><div class=\\\"form-group\\\"><label for=\\\"g-core-smtp-username\\\">SMTP username</label><input id=\\\"g-core-smtp-username\\\" type=\\\"text\\\"\" + (jade.attr(\"value\", \"\" + (settings['core.smtp.username'] || '') + \"\", true, true)) + (jade.attr(\"placeholder\", \"Default: \" + (defaults['core.smtp.username'] || 'none') + \"\", true, true)) + \" title=\\\"The username, if any, used to authenticate to the SMTP server used to send emails.\\\" class=\\\"form-control input-sm\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-core-smtp-password\\\">SMTP password</label><input id=\\\"g-core-smtp-password\\\" type=\\\"password\\\"\" + (jade.attr(\"value\", \"\" + (settings['core.smtp.password'] || '') + \"\", true, true)) + (jade.attr(\"placeholder\", \"Default: \" + (defaults['core.smtp.password'] || 'none') + \"\", true, true)) + \" title=\\\"The password, if any, used to authenticate to the SMTP server used to send emails.\\\" class=\\\"form-control input-sm\\\"></div></div><div id=\\\"g-configuration-accordion\\\" class=\\\"panel-group\\\"><div class=\\\"panel panel-default\\\"><div data-toggle=\\\"collapse\\\" data-parent=\\\"#g-configuration-accordion\\\" data-target=\\\"#g-advanced-settings-tab\\\" class=\\\"panel-heading\\\"><div class=\\\"panel-title\\\"><a><b>Advanced Settings</b></a></div></div><div id=\\\"g-advanced-settings-tab\\\" class=\\\"panel-collapse collapse\\\"><div class=\\\"panel-body\\\"><p>These settings should only be changed if you are certain of what you are doing.</p><div class=\\\"form-group\\\"><label for=\\\"g-core-upload-minimum-chunk-size\\\">Upload minimum chunk size (bytes)</label><br><span>This applies to Filesystem and GridFS assetstores.</span><input id=\\\"g-core-upload-minimum-chunk-size\\\" type=\\\"text\\\"\" + (jade.attr(\"value\", \"\" + (settings['core.upload_minimum_chunk_size'] || '') + \"\", true, true)) + (jade.attr(\"placeholder\", \"Default: \" + (defaults['core.upload_minimum_chunk_size'] || 'none') + \"\", true, true)) + \" title=\\\"For large files, the minimum size of all but the last chunk.\\\" class=\\\"form-control input-sm\\\"></div><div class=\\\"g-settings-form-container\\\"><h4>CORS</h4><p>CORS (Cross-origin resource sharing) allows access from other websites.\\nThese settings are described in\\ndetail <a href=\\\"http://girder.readthedocs.org/en/latest/security.html#cors-cross-origin-resource-sharing\\\" target=\\\"_blank\\\">here</a>.</p><div class=\\\"form-group\\\"><label for=\\\"g-core-cors-allow-origin\\\">CORS Allowed Origins</label><input id=\\\"g-core-cors-allow-origin\\\" type=\\\"text\\\"\" + (jade.attr(\"value\", \"\" + (settings['core.cors.allow_origin'] || '') + \"\", true, true)) + (jade.attr(\"placeholder\", \"Default: \" + (defaults['core.cors.allow_origin'] || 'none') + \"\", true, true)) + \" title=\\\"A comma-separated list of allowed base URLs that can make cross-site requests. This may include *.\\\" class=\\\"form-control input-sm\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-core-cors-allow-methods\\\">CORS Allowed Methods</label><input id=\\\"g-core-cors-allow-methods\\\" type=\\\"text\\\"\" + (jade.attr(\"value\", \"\" + (settings['core.cors.allow_methods'] || '') + \"\", true, true)) + \" placeholder=\\\"Default: allow all methods\\\" title=\\\"A comma-separated list of allowed methods\\\" class=\\\"form-control input-sm\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-core-cors-allow-headers\\\">CORS Allowed Headers</label><input id=\\\"g-core-cors-allow-headers\\\" type=\\\"text\\\"\" + (jade.attr(\"value\", \"\" + (settings['core.cors.allow_headers'] || '') + \"\", true, true)) + (jade.attr(\"placeholder\", \"Default: \" + (defaults['core.cors.allow_headers'] || 'none') + \"\", true, true)) + \" title=\\\"A comma-separated list of allowed headers.\\\" class=\\\"form-control input-sm\\\"></div></div></div></div></div></div><p></p><div class=\\\"form-group\\\"><button class=\\\"g-submit-settings btn btn-default btn-sm\\\"><i class=\\\"icon-ok\\\"></i>  Save</button></div><div id=\\\"g-settings-error-message\\\" class=\\\"g-validation-failed-message\\\"></div></form>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"userList\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),girder = locals_.girder,users = locals_.users,undefined = locals_.undefined;\nbuf.push(\"<div class=\\\"g-user-list-header\\\"><div class=\\\"g-user-pagination\\\"></div><form role=\\\"form\\\" class=\\\"g-user-search-form form-inline\\\"><div class=\\\"form-group g-users-search-container\\\"></div></form>\");\nif ( girder.currentUser && girder.currentUser.get('admin'))\n{\nbuf.push(\"<button class=\\\"g-user-create-button btn btn-sm btn-default\\\"><i class=\\\"icon-plus-squared\\\"></i> Create user</button>\");\n}\nbuf.push(\"</div>\");\n// iterate users\n;(function(){\n  var $$obj = users;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var user = $$obj[$index];\n\nbuf.push(\"<div class=\\\"g-user-list-entry\\\"><div class=\\\"g-user-right-column\\\"><div class=\\\"g-user-joined\\\"><i class=\\\"icon-clock\\\"></i>Joined on<span class=\\\"g-user-joined-date\\\"> \" + (jade.escape((jade_interp = girder.formatDate(user.get('created'), girder.DATE_DAY)) == null ? '' : jade_interp)) + \"</span></div>\");\nif ( user.get('size') !== undefined)\n{\nbuf.push(\"<div class=\\\"g-space-used\\\"><i class=\\\"icon-floppy\\\"></i>Currently using<span class=\\\"g-user-space-used\\\"> \" + (jade.escape((jade_interp = girder.formatSize(user.get('size'))) == null ? '' : jade_interp)) + \"</span></div>\");\n}\nif ( user.get('status') === 'disabled')\n{\nbuf.push(\"<div class=\\\"g-user-status\\\"><i class=\\\"icon-cancel-circled\\\"></i>Account disabled</div>\");\n}\nelse if ( user.get('status') === 'pending')\n{\nbuf.push(\"<div class=\\\"g-user-status\\\"><i class=\\\"icon-attention-circled\\\"></i>Account pending approval</div>\");\n}\nbuf.push(\"</div><div class=\\\"g-user-title\\\"><a\" + (jade.attr(\"g-user-cid\", user.cid, true, true)) + \" class=\\\"g-user-link\\\"><b>\" + (jade.escape(null == (jade_interp = user.name()) ? \"\" : jade_interp)) + \"</b></a></div><div class=\\\"g-user-subtitle\\\"><span class=\\\"g-user-login\\\"> \" + (jade.escape((jade_interp = user.get('login')) == null ? '' : jade_interp)) + \"</span></div><div class=\\\"g-clear-right\\\"></div></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var user = $$obj[$index];\n\nbuf.push(\"<div class=\\\"g-user-list-entry\\\"><div class=\\\"g-user-right-column\\\"><div class=\\\"g-user-joined\\\"><i class=\\\"icon-clock\\\"></i>Joined on<span class=\\\"g-user-joined-date\\\"> \" + (jade.escape((jade_interp = girder.formatDate(user.get('created'), girder.DATE_DAY)) == null ? '' : jade_interp)) + \"</span></div>\");\nif ( user.get('size') !== undefined)\n{\nbuf.push(\"<div class=\\\"g-space-used\\\"><i class=\\\"icon-floppy\\\"></i>Currently using<span class=\\\"g-user-space-used\\\"> \" + (jade.escape((jade_interp = girder.formatSize(user.get('size'))) == null ? '' : jade_interp)) + \"</span></div>\");\n}\nif ( user.get('status') === 'disabled')\n{\nbuf.push(\"<div class=\\\"g-user-status\\\"><i class=\\\"icon-cancel-circled\\\"></i>Account disabled</div>\");\n}\nelse if ( user.get('status') === 'pending')\n{\nbuf.push(\"<div class=\\\"g-user-status\\\"><i class=\\\"icon-attention-circled\\\"></i>Account pending approval</div>\");\n}\nbuf.push(\"</div><div class=\\\"g-user-title\\\"><a\" + (jade.attr(\"g-user-cid\", user.cid, true, true)) + \" class=\\\"g-user-link\\\"><b>\" + (jade.escape(null == (jade_interp = user.name()) ? \"\" : jade_interp)) + \"</b></a></div><div class=\\\"g-user-subtitle\\\"><span class=\\\"g-user-login\\\"> \" + (jade.escape((jade_interp = user.get('login')) == null ? '' : jade_interp)) + \"</span></div><div class=\\\"g-clear-right\\\"></div></div>\");\n    }\n\n  }\n}).call(this);\n;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"userPage\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),user = locals_.user,girder = locals_.girder;\nbuf.push(\"<div class=\\\"g-user-header\\\">\");\nif ( user.getAccessLevel() >= girder.AccessType.WRITE)\n{\nbuf.push(\"<div class=\\\"btn-group pull-right\\\"><button data-toggle=\\\"dropdown\\\" title=\\\"Item actions\\\" class=\\\"g-user-actions-button btn btn-default dropdown-toggle\\\"><i class=\\\"icon-user\\\"></i> Actions<i class=\\\"icon-down-dir\\\"></i></button><ul role=\\\"menu\\\" class=\\\"g-item-actions-menu dropdown-menu pull-right\\\"><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-edit-user\\\"><i class=\\\"icon-edit\\\"></i>Edit user</a></li>\");\nif ( user.getAccessLevel() >= girder.AccessType.ADMIN)\n{\nbuf.push(\"<li role=\\\"presentation\\\" class=\\\"divider\\\"></li>\");\nif ( user.get('status') === 'pending')\n{\nbuf.push(\"<li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-approve-user\\\"><i class=\\\"icon-ok-squared\\\"></i>Approve account</a></li>\");\n}\nelse if ( user.get('status') === 'enabled')\n{\nbuf.push(\"<li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-disable-user\\\"><i class=\\\"icon-cancel\\\"></i>Disable account</a></li>\");\n}\nelse if ( user.get('status') === 'disabled')\n{\nbuf.push(\"<li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-enable-user\\\"><i class=\\\"icon-ok\\\"></i>Enable account</a></li>\");\n}\nbuf.push(\"<li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-delete-user\\\"><i class=\\\"icon-trash\\\"></i>Delete user</a></li>\");\n}\nbuf.push(\"</ul></div>\");\n}\nbuf.push(\"<div class=\\\"g-user-name g-body-title\\\">\" + (jade.escape((jade_interp = user.get('firstName')) == null ? '' : jade_interp)) + \" \" + (jade.escape((jade_interp = user.get('lastName')) == null ? '' : jade_interp)) + \"</div><div class=\\\"g-user-login g-body-subtitle\\\">\" + (jade.escape((jade_interp = user.get('login')) == null ? '' : jade_interp)) + \"</div></div><div class=\\\"g-user-hierarchy-container\\\"></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"userSettings\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),user = locals_.user,girder = locals_.girder,temporaryToken = locals_.temporaryToken,isCurrentUser = locals_.isCurrentUser;\nbuf.push(\"<div class=\\\"g-account-header\\\"><div class=\\\"g-user-name g-body-title\\\">\" + (jade.escape((jade_interp = user.name()) == null ? '' : jade_interp)) + \"</div><div class=\\\"g-user-description g-body-subtitle\\\">\" + (jade.escape((jade_interp = user.get('login')) == null ? '' : jade_interp)) + \"</div></div><ul class=\\\"g-account-tabs nav nav-tabs\\\"><li class=\\\"active\\\"><a href=\\\"#g-account-tab-info\\\" data-toggle=\\\"tab\\\" name=\\\"info\\\"><i class=\\\"icon-info-circled\\\"></i> Profile</a></li><li><a href=\\\"#g-account-tab-password\\\" data-toggle=\\\"tab\\\" name=\\\"password\\\"><i class=\\\"icon-lock\\\"></i>Password</a></li><li><a href=\\\"#g-account-tab-api-keys\\\" data-toggle=\\\"tab\\\" name=\\\"apikeys\\\"><i class=\\\"icon-key-inv\\\"></i>API keys</a></li></ul><div class=\\\"tab-content\\\"><div id=\\\"g-account-tab-info\\\" class=\\\"tab-pane active\\\"><div class=\\\"g-user-info-container g-user-settings-container\\\"><form id=\\\"g-user-info-form\\\" role=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"g-login\\\">Login</label><p class=\\\"form-control-static\\\">\" + (jade.escape((jade_interp = user.get('login')) == null ? '' : jade_interp)) + \"</p></div><div class=\\\"form-group\\\"><label for=\\\"g-email\\\">Email</label><input id=\\\"g-email\\\" type=\\\"text\\\"\" + (jade.attr(\"value\", \"\" + (user.get('email')) + \"\", true, true)) + \" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-firstName\\\">First name</label><input id=\\\"g-firstName\\\" type=\\\"text\\\"\" + (jade.attr(\"value\", \"\" + (user.get('firstName')) + \"\", true, true)) + \" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-lastName\\\">Last name</label><input id=\\\"g-lastName\\\" type=\\\"text\\\"\" + (jade.attr(\"value\", \"\" + (user.get('lastName')) + \"\", true, true)) + \" class=\\\"input-sm form-control\\\"></div>\");\nif ( girder.currentUser.get('admin'))\n{\nbuf.push(\"<div class=\\\"form-group\\\"><label for=\\\"g-admin\\\">User is site admin</label>\");\nif ( user.get('admin'))\n{\nbuf.push(\"<input id=\\\"g-admin\\\" type=\\\"checkbox\\\" checked class=\\\"input-sm-form-control\\\">\");\n}\nelse\n{\nbuf.push(\"<input id=\\\"g-admin\\\" type=\\\"checkbox\\\" class=\\\"input-sm-form-control\\\">\");\n}\nbuf.push(\"</div>\");\n}\nbuf.push(\"<button type=\\\"submit\\\" class=\\\"btn btn-default btn-sm\\\"><i class=\\\"icon-edit\\\"></i>Save</button><div id=\\\"g-user-info-error-msg\\\" class=\\\"g-validation-failed-message\\\"></div></form></div></div><div id=\\\"g-account-tab-password\\\" class=\\\"tab-pane\\\"><div class=\\\"g-password-change-container g-user-settings-container\\\"><form id=\\\"g-password-change-form\\\" role=\\\"form\\\">\");\nif ( temporaryToken)\n{\nbuf.push(\"<input id=\\\"g-password-old\\\" type=\\\"hidden\\\"\" + (jade.attr(\"value\", \"\" + (temporaryToken) + \"\", true, true)) + \" class=\\\"input-sm form-control\\\">\");\n}\nelse if ( isCurrentUser)\n{\nbuf.push(\"<div class=\\\"form-group\\\"><label for=\\\"g-password-old\\\">Current password</label><input id=\\\"g-password-old\\\" type=\\\"password\\\" placeholder=\\\"Enter current password\\\" class=\\\"input-sm form-control\\\"></div>\");\n}\nbuf.push(\"<div class=\\\"form-group\\\"><label for=\\\"g-password-new\\\">New password</label><input id=\\\"g-password-new\\\" type=\\\"password\\\" placeholder=\\\"Enter new password\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-password-retype\\\">Retype new password</label><input id=\\\"g-password-retype\\\" type=\\\"password\\\" placeholder=\\\"Retype new password\\\" class=\\\"input-sm form-control\\\"></div><button type=\\\"submit\\\" class=\\\"btn btn-default btn-sm\\\"><i class=\\\"icon-lock\\\"></i>Change</button><div id=\\\"g-password-change-error-msg\\\" class=\\\"g-validation-failed-message\\\"></div></form></div></div><div id=\\\"g-account-tab-api-keys\\\" class=\\\"tab-pane\\\"><div class=\\\"g-api-keys-container g-user-settings-container\\\"><div class=\\\"g-api-keys-info-text\\\">API keys can be used to grant limited or total access to client applications on your behalf.\\nClients can use these keys to create tokens that can be used for authenticated access. You may\\nlimit the tokens created with a given key to certain authorization scopes, or allow the tokens\\ncomplete access to everything your user can do. You may also choose the maximum time that\\ntokens created with a given key will last before expiration. If you do not specify a duration,\\nthe default expiration for user login sessions will be used.\\n</div><div class=\\\"g-api-keys-list-container\\\"></div></div></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"alert\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),type = locals_.type,icon = locals_.icon,text = locals_.text;\nbuf.push(\"<div\" + (jade.cls(['alert','alert-dismissable',\"alert-\" + (type) + \"\"], [null,null,true])) + \"><button type=\\\"button\\\" data-dismiss=\\\"alert\\\" aria-hidden=\\\"true\\\" class=\\\"close\\\">&times;</button>\");\nif ( icon)\n{\nbuf.push(\"<i\" + (jade.cls([\"icon-\" + (icon) + \"\"], [true])) + \"></i>\");\n}\nbuf.push(\" \" + (jade.escape((jade_interp = text) == null ? '' : jade_interp)) + \"</div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"layout\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<div id=\\\"g-app-header-container\\\"></div><div id=\\\"g-global-nav-container\\\"></div><div id=\\\"g-app-body-container\\\" class=\\\"g-default-layout\\\"></div><div id=\\\"g-app-footer-container\\\"></div><div id=\\\"g-app-progress-container\\\"></div><div id=\\\"g-dialog-container\\\" class=\\\"modal fade\\\"></div><div id=\\\"g-alerts-container\\\"></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"layoutFooter\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),apiRoot = locals_.apiRoot;\nbuf.push(\"<div class=\\\"g-footer-links\\\"><a id=\\\"g-about-link\\\" href=\\\"http://girder.readthedocs.org/en/latest/user-guide.html\\\">About</a><a id=\\\"g-contact-link\\\" href=\\\"mailto:kitware@kitware.com\\\">Contact</a><a\" + (jade.attr(\"href\", \"\" + (apiRoot) + \"\", true, true)) + \">Web API</a><a id=\\\"g-bug-link\\\" href=\\\"https://github.com/girder/girder/issues/new\\\">Report a bug</a></div><div class=\\\"g-footer-info\\\">&copy; Kitware, Inc.</div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"layoutGlobalNav\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),navItems = locals_.navItems;\nbuf.push(\"<div class=\\\"g-global-nav-main\\\"><ul class=\\\"g-global-nav\\\">\");\n// iterate navItems\n;(function(){\n  var $$obj = navItems;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var navItem = $$obj[$index];\n\nbuf.push(\"<li class=\\\"g-global-nav-li\\\"><a\" + (jade.attr(\"g-target\", \"\" + (navItem.target) + \"\", true, true)) + (jade.attr(\"g-name\", \"\" + (navItem.name) + \"\", true, true)) + (jade.attr(\"href\", \"#\" + (navItem.target) + \"\", true, true)) + \" class=\\\"g-nav-link\\\"><i\" + (jade.cls([\"\" + (navItem.icon) + \"\"], [true])) + \"></i><span>\" + (jade.escape((jade_interp = navItem.name) == null ? '' : jade_interp)) + \"</span></a></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var navItem = $$obj[$index];\n\nbuf.push(\"<li class=\\\"g-global-nav-li\\\"><a\" + (jade.attr(\"g-target\", \"\" + (navItem.target) + \"\", true, true)) + (jade.attr(\"g-name\", \"\" + (navItem.name) + \"\", true, true)) + (jade.attr(\"href\", \"#\" + (navItem.target) + \"\", true, true)) + \" class=\\\"g-nav-link\\\"><i\" + (jade.cls([\"\" + (navItem.icon) + \"\"], [true])) + \"></i><span>\" + (jade.escape((jade_interp = navItem.name) == null ? '' : jade_interp)) + \"</span></a></li>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</ul></div><div class=\\\"g-global-nav-fade\\\"></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"layoutHeader\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<div class=\\\"g-header-wrapper\\\"><div class=\\\"g-app-title\\\">Girder</div><form role=\\\"form\\\" class=\\\"g-quick-search-form\\\"><div class=\\\"form-group g-quick-search-container\\\"></div></form><div class=\\\"g-current-user-wrapper\\\"></div><div class=\\\"g-clear-both\\\"></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"layoutHeaderUser\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),user = locals_.user;\nbuf.push(\"<div class=\\\"g-user-text\\\">\");\nif ( user)\n{\nbuf.push(\"<a data-toggle=\\\"dropdown\\\" data-target=\\\"#g-user-action-menu\\\" class=\\\"g-user-dropdown-link\\\"><i class=\\\"icon-user\\\"></i> \" + (jade.escape((jade_interp = user.get('login')) == null ? '' : jade_interp)) + \"<i class=\\\"icon-down-open\\\"></i></a><div id=\\\"g-user-action-menu\\\" class=\\\"dropdown\\\"><ul role=\\\"menu\\\" class=\\\"dropdown-menu\\\"><li role=\\\"presentation\\\"><a class=\\\"g-my-folders\\\"><i class=\\\"icon-folder\\\"></i>My folders</a></li><li role=\\\"presentation\\\"><a class=\\\"g-my-settings\\\"><i class=\\\"icon-cog\\\"></i>My account</a></li><li role=\\\"presentation\\\" class=\\\"divider\\\"></li><li role=\\\"presentation\\\"><a class=\\\"g-logout\\\"><i class=\\\"icon-logout\\\"></i>Log out</a></li></ul></div>\");\n}\nelse\n{\nbuf.push(\"<a class=\\\"g-register\\\">Register</a><div class=\\\"g-or-text\\\">or</div><a class=\\\"g-login\\\">Log In<i class=\\\"icon-login\\\"></i></a>\");\n}\nbuf.push(\"</div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"layoutProgressArea\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<div class=\\\"g-progress-list-container\\\"></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"loginDialog\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><form id=\\\"g-login-form\\\" role=\\\"form\\\" class=\\\"modal-form\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" type=\\\"button\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">Log in</h4></div><div class=\\\"modal-body\\\"><div class=\\\"form-group\\\"><label for=\\\"g-login\\\" class=\\\"control-label\\\">Login or email</label><input id=\\\"g-login\\\" type=\\\"text\\\" placeholder=\\\"Enter login\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-password\\\" class=\\\"control-label\\\">Password</label><input id=\\\"g-password\\\" type=\\\"password\\\" placeholder=\\\"Enter password\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"g-validation-failed-message\\\"></div><div class=\\\"g-bottom-message\\\">Don't have an account yet?<a class=\\\"g-register-link\\\"> Register here.</a> |<a class=\\\"g-forgot-password\\\"> Forgot your password?</a></div></div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-default\\\">Close</a><button id=\\\"g-login-button\\\" type=\\\"submit\\\" class=\\\"btn btn-primary\\\"><i class=\\\"icon-login\\\"></i> Login</button></div></form></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"registerDialog\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),title = locals_.title,currentUser = locals_.currentUser;\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><form id=\\\"g-register-form\\\" role=\\\"form\\\" class=\\\"modal-form\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" type=\\\"button\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">\" + (jade.escape(null == (jade_interp = title) ? \"\" : jade_interp)) + \"</h4></div><div class=\\\"modal-body\\\"><div id=\\\"g-group-login\\\" class=\\\"form-group\\\"><label for=\\\"g-login\\\" class=\\\"control-label\\\">Choose a login name</label><input id=\\\"g-login\\\" type=\\\"text\\\" placeholder=\\\"Login\\\" class=\\\"input-sm form-control\\\"></div><div id=\\\"g-group-email\\\" class=\\\"form-group\\\"><label for=\\\"g-email\\\" class=\\\"control-label\\\">Enter email address</label><input id=\\\"g-email\\\" type=\\\"text\\\" placeholder=\\\"Email\\\" class=\\\"input-sm form-control\\\"></div><div id=\\\"g-group-firstName\\\" class=\\\"form-group\\\"><label for=\\\"g-firstName\\\" class=\\\"control-label\\\">Enter first name</label><input id=\\\"g-firstName\\\" type=\\\"text\\\" placeholder=\\\"First name\\\" class=\\\"input-sm form-control\\\"></div><div id=\\\"g-group-lastName\\\" class=\\\"form-group\\\"><label for=\\\"g-lastName\\\" class=\\\"control-label\\\">Enter last name</label><input id=\\\"g-lastName\\\" type=\\\"text\\\" placeholder=\\\"Last name\\\" class=\\\"input-sm form-control\\\"></div><div id=\\\"g-group-password\\\" class=\\\"form-group\\\"><label for=\\\"g-password\\\" class=\\\"control-label\\\">Choose a password</label><input id=\\\"g-password\\\" type=\\\"password\\\" placeholder=\\\"Password\\\" class=\\\"input-sm form-control\\\"></div><div id=\\\"g-group-password2\\\" class=\\\"form-group\\\"><label for=\\\"g-password2\\\" class=\\\"control-label\\\">Retype password</label><input id=\\\"g-password2\\\" type=\\\"password\\\" placeholder=\\\"Password\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"g-validation-failed-message\\\"></div>\");\nif ( !currentUser)\n{\nbuf.push(\"<div class=\\\"g-bottom-message\\\">Already have an account?<a class=\\\"g-login-link\\\"> Log in here.</a></div>\");\n}\nbuf.push(\"</div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-default\\\">Close</a><button id=\\\"g-register-button\\\" type=\\\"submit\\\" class=\\\"btn btn-primary\\\"><i class=\\\"icon-plus-circled\\\"></i> Register</button></div></form></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"resetPasswordDialog\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><form id=\\\"g-reset-password-form\\\" role=\\\"form\\\" class=\\\"modal-form\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" type=\\\"button\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">Forgotten password</h4></div><div class=\\\"modal-body\\\"><div class=\\\"g-password-reset-explanation\\\">If you have forgotten your password, enter your email address here.\\nYou will be sent an email with a temporary access link, from\\nwhich you can reset your password.</div><div class=\\\"form-group\\\"><label for=\\\"g-email\\\" class=\\\"control-label\\\">Email</label><input id=\\\"g-email\\\" type=\\\"text\\\" placeholder=\\\"Enter your email\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"g-validation-failed-message\\\"></div><div class=\\\"g-bottom-message\\\"><a class=\\\"g-register-link\\\"> Register</a> |<a class=\\\"g-login-link\\\"> Login</a></div></div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-default\\\">Close</a><button id=\\\"g-reset-password-button\\\" type=\\\"submit\\\" class=\\\"btn btn-primary\\\"><i class=\\\"icon-mail\\\"></i> Submit</button></div></form></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"accessEditor\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),public = locals_.public,undefined = locals_.undefined,modelType = locals_.modelType,model = locals_.model,hideRecurseOption = locals_.hideRecurseOption;\njade_mixins[\"privacyEditor\"] = function(typeName){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<div class=\\\"g-public-container\\\"><div class=\\\"radio\\\"><label><input id=\\\"g-access-private\\\" type=\\\"radio\\\" name=\\\"privacy\\\"\" + (jade.attr(\"checked\", (public ? undefined : \"checked\"), true, true)) + \"><i class=\\\"icon-lock\\\"></i><b>Private</b> &mdash; Access is required to view this \" + (jade.escape((jade_interp = typeName) == null ? '' : jade_interp)) + \"</label></div><div class=\\\"radio\\\"><label><input id=\\\"g-access-public\\\" type=\\\"radio\\\" name=\\\"privacy\\\"\" + (jade.attr(\"checked\", (public ? \"checked\" : undefined), true, true)) + \"><i class=\\\"icon-globe\\\"></i><b>Public</b> &mdash; Anyone can view this \" + (jade.escape((jade_interp = typeName) == null ? '' : jade_interp)) + \"</label></div></div>\");\n};\njade_mixins[\"permissionsEditor\"] = function(){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<div class=\\\"g-permissions-editor\\\"><div class=\\\"g-ac-list-title\\\"><i class=\\\"icon-key-1\\\"></i>  Permissions</div><div class=\\\"g-ac-list\\\"><div id=\\\"g-ac-list-groups\\\"></div><div id=\\\"g-ac-list-users\\\"></div></div><div class=\\\"g-grant-access-container\\\"><form role=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"addAccess\\\">Grant access to another group or user</label><div class=\\\"g-search-field-container\\\"></div></div></form></div></div>\");\n};\njade_mixins[\"recurseOption\"] = function(typeName){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<div class=\\\"g-recursive-container\\\"><div class=\\\"radio\\\"><label><input id=\\\"g-apply-nonrecursive\\\" type=\\\"radio\\\" name=\\\"recurse\\\" checked=\\\"checked\\\">Apply permissions only to this \" + (jade.escape((jade_interp = typeName) == null ? '' : jade_interp)) + \", not its subfolders</label></div><div class=\\\"radio\\\"><label><input id=\\\"g-apply-recursive\\\" type=\\\"radio\\\" name=\\\"recurse\\\">Also set permissions on all subfolders to match this \" + (jade.escape((jade_interp = typeName) == null ? '' : jade_interp)) + \"'s permissions</label></div></div>\");\n};\njade_mixins[\"saveAccessButton\"] = function(){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<button class=\\\"g-save-access-list btn btn-small btn-primary\\\"><i class=\\\"icon-ok\\\"></i>  Save</button>\");\n};\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" type=\\\"button\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">Access control</h4><div class=\\\"g-dialog-subtitle\\\">\");\nif ( (modelType === 'folder'))\n{\nbuf.push(\"<i class=\\\"icon-folder\\\"></i>\");\n}\nelse if ( (modelType === 'collection'))\n{\nbuf.push(\"<i class=\\\"icon-sitemap\\\"></i>\");\n}\nbuf.push(\"\" + (jade.escape((jade_interp = model.name()) == null ? '' : jade_interp)) + \"</div></div><div class=\\\"modal-body g-access-modal-body\\\">\");\njade_mixins[\"privacyEditor\"](modelType);\njade_mixins[\"permissionsEditor\"]();\nif ( !hideRecurseOption)\n{\njade_mixins[\"recurseOption\"](modelType);\n}\nbuf.push(\"</div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-small btn-default\\\">Close</a>\");\njade_mixins[\"saveAccessButton\"]();\nbuf.push(\"</div></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"accessEditorMixins\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"accessEditorNonModal\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),public = locals_.public,undefined = locals_.undefined,modelType = locals_.modelType,hideRecurseOption = locals_.hideRecurseOption,hideSaveButton = locals_.hideSaveButton;\njade_mixins[\"privacyEditor\"] = function(typeName){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<div class=\\\"g-public-container\\\"><div class=\\\"radio\\\"><label><input id=\\\"g-access-private\\\" type=\\\"radio\\\" name=\\\"privacy\\\"\" + (jade.attr(\"checked\", (public ? undefined : \"checked\"), true, true)) + \"><i class=\\\"icon-lock\\\"></i><b>Private</b> &mdash; Access is required to view this \" + (jade.escape((jade_interp = typeName) == null ? '' : jade_interp)) + \"</label></div><div class=\\\"radio\\\"><label><input id=\\\"g-access-public\\\" type=\\\"radio\\\" name=\\\"privacy\\\"\" + (jade.attr(\"checked\", (public ? \"checked\" : undefined), true, true)) + \"><i class=\\\"icon-globe\\\"></i><b>Public</b> &mdash; Anyone can view this \" + (jade.escape((jade_interp = typeName) == null ? '' : jade_interp)) + \"</label></div></div>\");\n};\njade_mixins[\"permissionsEditor\"] = function(){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<div class=\\\"g-permissions-editor\\\"><div class=\\\"g-ac-list-title\\\"><i class=\\\"icon-key-1\\\"></i>  Permissions</div><div class=\\\"g-ac-list\\\"><div id=\\\"g-ac-list-groups\\\"></div><div id=\\\"g-ac-list-users\\\"></div></div><div class=\\\"g-grant-access-container\\\"><form role=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"addAccess\\\">Grant access to another group or user</label><div class=\\\"g-search-field-container\\\"></div></div></form></div></div>\");\n};\njade_mixins[\"recurseOption\"] = function(typeName){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<div class=\\\"g-recursive-container\\\"><div class=\\\"radio\\\"><label><input id=\\\"g-apply-nonrecursive\\\" type=\\\"radio\\\" name=\\\"recurse\\\" checked=\\\"checked\\\">Apply permissions only to this \" + (jade.escape((jade_interp = typeName) == null ? '' : jade_interp)) + \", not its subfolders</label></div><div class=\\\"radio\\\"><label><input id=\\\"g-apply-recursive\\\" type=\\\"radio\\\" name=\\\"recurse\\\">Also set permissions on all subfolders to match this \" + (jade.escape((jade_interp = typeName) == null ? '' : jade_interp)) + \"'s permissions</label></div></div>\");\n};\njade_mixins[\"saveAccessButton\"] = function(){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<button class=\\\"g-save-access-list btn btn-small btn-primary\\\"><i class=\\\"icon-ok\\\"></i>  Save</button>\");\n};\njade_mixins[\"privacyEditor\"](modelType);\njade_mixins[\"permissionsEditor\"]();\nif ( !hideRecurseOption)\n{\njade_mixins[\"recurseOption\"](modelType);\n}\nif ( !hideSaveButton)\n{\njade_mixins[\"saveAccessButton\"]();\n};return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"accessEntry\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),entry = locals_.entry,type = locals_.type,accessTypes = locals_.accessTypes;\nbuf.push(\"<div\" + (jade.attr(\"resourceid\", \"\" + (entry.id) + \"\", true, true)) + (jade.cls([\"g-\" + (type) + \"-access-entry\"], [true])) + \"><div class=\\\"g-access-col-left\\\">\");\nvar icon = type === 'group' ? 'users' : 'user';\nbuf.push(\"<div class=\\\"g-access-icon\\\"><i\" + (jade.cls([\"icon-\" + (icon) + \"\"], [true])) + \"></i></div><div class=\\\"g-access-desc\\\"><div class=\\\"g-desc-title\\\">\" + (jade.escape((jade_interp = entry.title) == null ? '' : jade_interp)) + \"</div><div class=\\\"g-desc-subtitle\\\">\" + (jade.escape((jade_interp = entry.subtitle) == null ? '' : jade_interp)) + \"</div></div></div><div class=\\\"g-access-col-right\\\"><select class=\\\"form-control input-sm\\\">\");\nvar sel=null; if (entry.level === accessTypes.READ) sel='selected';\nbuf.push(\"<option\" + (jade.attr(\"value\", \"\" + (accessTypes.READ) + \"\", true, true)) + (jade.attr(\"selected\", sel, true, true)) + \">Can view</option>\");\nvar sel=null; if (entry.level === accessTypes.WRITE) sel='selected';\nbuf.push(\"<option\" + (jade.attr(\"value\", \"\" + (accessTypes.WRITE) + \"\", true, true)) + (jade.attr(\"selected\", sel, true, true)) + \">Can edit</option>\");\nvar sel=null; if (entry.level === accessTypes.ADMIN) sel='selected';\nbuf.push(\"<option\" + (jade.attr(\"value\", \"\" + (accessTypes.ADMIN) + \"\", true, true)) + (jade.attr(\"selected\", sel, true, true)) + \">Is owner</option></select><a title=\\\"Remove access\\\" class=\\\"g-action-remove-access\\\"><i class=\\\"icon-cancel\\\"></i></a></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"apiKeyList\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),apiKeys = locals_.apiKeys,moment = locals_.moment;\nif ( apiKeys.length === 0)\n{\nbuf.push(\"<div class=\\\"g-api-keys-empty-message\\\">You have no existing API keys. Click the button below to create one.</div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"g-api-key-list-header\\\">Your API keys</div><table class=\\\"g-api-key-table\\\"><thead><tr><th col=\\\"name\\\">Name</th><th col=\\\"key\\\">Key</th><th col=\\\"scope\\\">Scope</th><th col=\\\"active\\\">Active</th><th col=\\\"tokenDuration\\\">Token duration</th><th col=\\\"lastUse\\\">Last used</th><th col=\\\"actions\\\">Actions</th></tr></thead><tbody>\");\n// iterate apiKeys\n;(function(){\n  var $$obj = apiKeys;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var apiKey = $$obj[$index];\n\nbuf.push(\"<tr\" + (jade.attr(\"api-key-id\", apiKey.id, true, true)) + (jade.attr(\"cid\", apiKey.cid, true, true)) + \" class=\\\"g-api-key-container\\\"><td col=\\\"name\\\">\" + (jade.escape(null == (jade_interp = apiKey.get('name')) ? \"\" : jade_interp)) + \"</td><td col=\\\"key\\\"><a data-toggle=\\\"popover\\\"\" + (jade.attr(\"data-content\", apiKey.get('key'), true, true)) + \" class=\\\"g-show-api-key\\\">show</a></td><td col=\\\"scope\\\">\");\nif ( apiKey.get('scope'))\n{\nbuf.push(\"<span>Custom scopes</span>\");\n}\nelse\n{\nbuf.push(\"<span>Full access</span>\");\n}\nbuf.push(\"</td><td col=\\\"active\\\">\" + (jade.escape(null == (jade_interp = apiKey.get('active') ? 'Yes' : 'No') ? \"\" : jade_interp)) + \"</td><td col=\\\"tokenDuration\\\">\");\nif ( apiKey.get('tokenDuration'))\n{\nbuf.push(\"<span>\" + (jade.escape((jade_interp = apiKey.get('tokenDuration')) == null ? '' : jade_interp)) + \" days</span>\");\n}\nelse\n{\nbuf.push(\"<span>Default</span>\");\n}\nbuf.push(\"</td><td col=\\\"lastUse\\\">\");\nif ( apiKey.get('lastUse'))\n{\nvar lastUse = moment(apiKey.get('lastUse'))\nbuf.push(\"<span\" + (jade.attr(\"title\", lastUse, true, true)) + \">\" + (jade.escape(null == (jade_interp = lastUse.fromNow()) ? \"\" : jade_interp)) + \"</span>\");\n}\nelse\n{\nbuf.push(\"<span>Never</span>\");\n}\nbuf.push(\"</td><td col=\\\"actions\\\"><button title=\\\"Edit\\\" class=\\\"btn btn-sm btn-primary g-api-key-edit\\\"><i class=\\\"icon-edit\\\"></i></button>\");\nif ( apiKey.get('active'))\n{\nbuf.push(\"<button title=\\\"Deactivate\\\" class=\\\"btn btn-sm btn-warning g-api-key-toggle-active\\\"><i class=\\\"icon-minus-circled\\\"></i></button>\");\n}\nelse\n{\nbuf.push(\"<button title=\\\"Activate\\\" class=\\\"btn btn-sm btn-success g-api-key-toggle-active\\\"><i class=\\\"icon-plus-circled\\\"></i></button>\");\n}\nbuf.push(\"<button title=\\\"Delete key\\\" class=\\\"btn btn-sm btn-danger g-api-key-delete\\\"><i class=\\\"icon-cancel\\\"></i></button></td></tr>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var apiKey = $$obj[$index];\n\nbuf.push(\"<tr\" + (jade.attr(\"api-key-id\", apiKey.id, true, true)) + (jade.attr(\"cid\", apiKey.cid, true, true)) + \" class=\\\"g-api-key-container\\\"><td col=\\\"name\\\">\" + (jade.escape(null == (jade_interp = apiKey.get('name')) ? \"\" : jade_interp)) + \"</td><td col=\\\"key\\\"><a data-toggle=\\\"popover\\\"\" + (jade.attr(\"data-content\", apiKey.get('key'), true, true)) + \" class=\\\"g-show-api-key\\\">show</a></td><td col=\\\"scope\\\">\");\nif ( apiKey.get('scope'))\n{\nbuf.push(\"<span>Custom scopes</span>\");\n}\nelse\n{\nbuf.push(\"<span>Full access</span>\");\n}\nbuf.push(\"</td><td col=\\\"active\\\">\" + (jade.escape(null == (jade_interp = apiKey.get('active') ? 'Yes' : 'No') ? \"\" : jade_interp)) + \"</td><td col=\\\"tokenDuration\\\">\");\nif ( apiKey.get('tokenDuration'))\n{\nbuf.push(\"<span>\" + (jade.escape((jade_interp = apiKey.get('tokenDuration')) == null ? '' : jade_interp)) + \" days</span>\");\n}\nelse\n{\nbuf.push(\"<span>Default</span>\");\n}\nbuf.push(\"</td><td col=\\\"lastUse\\\">\");\nif ( apiKey.get('lastUse'))\n{\nvar lastUse = moment(apiKey.get('lastUse'))\nbuf.push(\"<span\" + (jade.attr(\"title\", lastUse, true, true)) + \">\" + (jade.escape(null == (jade_interp = lastUse.fromNow()) ? \"\" : jade_interp)) + \"</span>\");\n}\nelse\n{\nbuf.push(\"<span>Never</span>\");\n}\nbuf.push(\"</td><td col=\\\"actions\\\"><button title=\\\"Edit\\\" class=\\\"btn btn-sm btn-primary g-api-key-edit\\\"><i class=\\\"icon-edit\\\"></i></button>\");\nif ( apiKey.get('active'))\n{\nbuf.push(\"<button title=\\\"Deactivate\\\" class=\\\"btn btn-sm btn-warning g-api-key-toggle-active\\\"><i class=\\\"icon-minus-circled\\\"></i></button>\");\n}\nelse\n{\nbuf.push(\"<button title=\\\"Activate\\\" class=\\\"btn btn-sm btn-success g-api-key-toggle-active\\\"><i class=\\\"icon-plus-circled\\\"></i></button>\");\n}\nbuf.push(\"<button title=\\\"Delete key\\\" class=\\\"btn btn-sm btn-danger g-api-key-delete\\\"><i class=\\\"icon-cancel\\\"></i></button></td></tr>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</tbody></table>\");\n}\nbuf.push(\"<div class=\\\"g-paginate-container\\\"></div><div class=\\\"g-api-key-list-bottom-buttons\\\"><button class=\\\"btn btn-default g-api-key-new\\\">Create new key</button></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"browserWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),title = locals_.title,help = locals_.help,preview = locals_.preview,submit = locals_.submit;\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" type=\\\"button\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">\" + (jade.escape(null == (jade_interp = title) ? \"\" : jade_interp)) + \"</h4></div><div class=\\\"modal-body\\\"><div class=\\\"g-hierarchy-root-container form-group\\\"></div><div class=\\\"g-hierarchy-widget-container g-wait-for-root form-group hidden\\\"></div><div class=\\\"help-block g-wait-for-root hidden\\\">\" + (jade.escape(null == (jade_interp = help) ? \"\" : jade_interp)) + \"</div>\");\nif ( preview)\n{\nbuf.push(\"<div class=\\\"g-selected-model g-wait-for-root form-group hidden\\\"><label for=\\\"g-selected-model\\\" class=\\\"control-label\\\">Selected id</label><input id=\\\"g-selected-model\\\" type=\\\"text\\\" readonly class=\\\"form-control\\\"></div>\");\n}\nbuf.push(\"<div class=\\\"g-validation-failed-message hidden\\\"></div></div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-small btn-default\\\">Cancel</a><button type=\\\"submit\\\" class=\\\"g-submit-button btn btn-small btn-primary\\\"><i class=\\\"icon-edit\\\"></i>\" + (jade.escape(null == (jade_interp = submit) ? \"\" : jade_interp)) + \"</button></div></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"checkedActionsMenu\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),folderCount = locals_.folderCount,itemCount = locals_.itemCount,pickedCount = locals_.pickedCount,girder = locals_.girder,pickedMoveAllowed = locals_.pickedMoveAllowed,pickedCopyAllowed = locals_.pickedCopyAllowed,pickedDesc = locals_.pickedDesc,minFolderLevel = locals_.minFolderLevel,AccessType = locals_.AccessType,minItemLevel = locals_.minItemLevel;\nbuf.push(\"<li role=\\\"presentation\\\" class=\\\"g-checked-menu-header dropdown-header\\\">\");\nif ( folderCount)\n{\nbuf.push(\"<i class=\\\"icon-folder\\\"></i><span class=\\\"g-checked-folder-count\\\">\" + (jade.escape((jade_interp = folderCount) == null ? '' : jade_interp)) + \"</span>\");\n}\nif ( itemCount)\n{\nbuf.push(\"<i class=\\\"icon-doc-text-inv\\\"></i><span class=\\\"g-checked-item-count\\\">\" + (jade.escape((jade_interp = itemCount) == null ? '' : jade_interp)) + \"</span>\");\n}\nif ( pickedCount)\n{\nbuf.push(\"<i class=\\\"icon-plus-circled\\\"></i><span class=\\\"g-checked-picked-count\\\">\" + (jade.escape((jade_interp = pickedCount) == null ? '' : jade_interp)) + \"</span>\");\n}\nbuf.push(\"</li>\");\nif ( folderCount || itemCount)\n{\nbuf.push(\"<li><a class=\\\"g-download-checked\\\"><i class=\\\"icon-download\\\"></i>Download checked resources</a></li><li><a class=\\\"g-pick-checked\\\"><i class=\\\"icon-plus-circled\\\"></i>Pick checked resources for Move or Copy</a></li>\");\n}\nif ( girder.pickedResources)\n{\nbuf.push(\"<li class=\\\"g-admin divider\\\"></li>\");\nif ( pickedMoveAllowed)\n{\nbuf.push(\"<li><a class=\\\"g-move-picked\\\"><i class=\\\"icon-move\\\"></i>Move picked resources here</a></li>\");\n}\nif ( pickedCopyAllowed)\n{\nbuf.push(\"<li><a class=\\\"g-copy-picked\\\"><i class=\\\"icon-paste\\\"></i>Copy picked resources here</a></li>\");\n}\nbuf.push(\"<li><a class=\\\"g-clear-picked\\\"><i class=\\\"icon-minus-circled\\\"></i>Clear picked resources\");\nif ( pickedDesc)\n{\nbuf.push(\" (\" + (jade.escape((jade_interp = pickedDesc) == null ? '' : jade_interp)) + \")\");\n}\nbuf.push(\"</a></li>\");\n}\nif ( folderCount || itemCount)\n{\nif ( (minFolderLevel >= AccessType.ADMIN && minItemLevel >= AccessType.WRITE))\n{\nbuf.push(\"<li class=\\\"g-admin divider\\\"></li><li class=\\\"g-admin\\\"><a class=\\\"g-delete-checked\\\"><i class=\\\"icon-trash\\\"></i>Delete checked resources</a></li>\");\n}\n};return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"collectionInfoDialog\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),girder = locals_.girder,collection = locals_.collection;\njade_mixins[\"dateInfo\"] = function(intro, property){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<div\" + (jade.attr(\"property\", property, true, true)) + \" class=\\\"g-collection-info-line\\\"><i class=\\\"icon-clock\\\"></i><span>\" + (jade.escape(null == (jade_interp = intro) ? \"\" : jade_interp)) + \"</span><span class=\\\"g-bold-part\\\">\" + (jade.escape(null == (jade_interp = girder.formatDate(collection.get(property), girder.DATE_SECOND)) ? \"\" : jade_interp)) + \"</span></div>\");\n};\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">Collection information</h4><div class=\\\"g-dialog-subtitle\\\"><i class=\\\"icon-sitemap\\\"></i><span>\" + (jade.escape(null == (jade_interp = collection.name()) ? \"\" : jade_interp)) + \"</span></div></div><div class=\\\"modal-body\\\">\");\nif ( collection.get('description'))\n{\nbuf.push(\"<div class=\\\"g-info-dialog-description\\\">\" + (null == (jade_interp = girder.renderMarkdown(collection.get('description'))) ? \"\" : jade_interp) + \"</div>\");\n}\nbuf.push(\"<div class=\\\"g-collection-info-lines\\\">\");\njade_mixins[\"dateInfo\"]('Created ', 'created');\nif ( collection.get('created') !== collection.get('updated'))\n{\njade_mixins[\"dateInfo\"]('Last updated ', 'updated');\n}\nbuf.push(\"<div property=\\\"size\\\" class=\\\"g-collection-info-line\\\"><i class=\\\"icon-floppy\\\"></i>Total size: <span class=\\\"g-bold-part\\\">\" + (jade.escape(null == (jade_interp = girder.formatSize(collection.get('size'))) ? \"\" : jade_interp)) + \"</span></div><div property=\\\"nFolders\\\" class=\\\"g-collection-info-line\\\"><i class=\\\"icon-folder\\\"></i>Contains <span class=\\\"g-bold-part\\\">\" + (jade.escape(null == (jade_interp = collection.get('nFolders')) ? \"\" : jade_interp)) + \"</span> subfolders</div><div property=\\\"id\\\" class=\\\"g-collection-info-line\\\"><i class=\\\"icon-share\\\"></i>Unique ID: <span class=\\\"g-bold-part\\\">\" + (jade.escape(null == (jade_interp = collection.id) ? \"\" : jade_interp)) + \"</span></div></div></div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-small btn-default\\\">Close</a></div></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"confirmDialog\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),params = locals_.params;\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-body\\\"><p></p></div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-small btn-default\\\">\" + (jade.escape((jade_interp = params.noText) == null ? '' : jade_interp)) + \"</a><a id=\\\"g-confirm-button\\\"\" + (jade.cls(['btn','btn-small',\"\" + (params.yesClass) + \"\"], [null,null,true])) + \">\" + (jade.escape((jade_interp = params.yesText) == null ? '' : jade_interp)) + \"</a></div></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"dateTimeRangeWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),fromLabel = locals_.fromLabel,showIcon = locals_.showIcon,toLabel = locals_.toLabel;\nbuf.push(\"<div class=\\\"form-group\\\"><label class=\\\"control-label\\\">\" + (jade.escape(null == (jade_interp = fromLabel) ? \"\" : jade_interp)) + \"</label>\");\nif ( showIcon)\n{\nbuf.push(\"<div class=\\\"input-group date g-datetime-widget-from\\\"><input type=\\\"text\\\" class=\\\"input-sm form-control\\\"><div class=\\\"input-group-addon\\\"><span class=\\\"icon-calendar\\\"></span></div></div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"input-group date\\\"><input type=\\\"text\\\" class=\\\"input-sm form-control g-datetime-widget-from\\\"></div>\");\n}\nbuf.push(\"</div><div class=\\\"form-group\\\"><label class=\\\"control-label\\\">\" + (jade.escape(null == (jade_interp = toLabel) ? \"\" : jade_interp)) + \"</label>\");\nif ( showIcon)\n{\nbuf.push(\"<div class=\\\"input-group date g-datetime-widget-to\\\"><input type=\\\"text\\\" class=\\\"input-sm form-control\\\"><div class=\\\"input-group-addon\\\"><span class=\\\"icon-calendar\\\"></span></div></div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"input-group date\\\"><input type=\\\"text\\\" class=\\\"input-sm form-control g-datetime-widget-to\\\"></div>\");\n}\nbuf.push(\"</div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"dateTimeWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),showIcon = locals_.showIcon;\nif ( showIcon)\n{\nbuf.push(\"<div class=\\\"input-group date g-datetime-widget\\\"><input type=\\\"text\\\" class=\\\"input-sm form-control\\\"><span class=\\\"input-group-addon\\\"><span class=\\\"icon-calendar\\\"></span></span></div>\");\n}\nelse\n{\nbuf.push(\"<div class=\\\"input-group\\\"><input type=\\\"text\\\" class=\\\"input-sm form-control g-datetime-widget\\\"></div>\");\n};return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"editApiKeyWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),apiKey = locals_.apiKey,userTokenScopes = locals_.userTokenScopes,user = locals_.user,adminTokenScopes = locals_.adminTokenScopes;\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><form id=\\\"g-api-key-edit-form\\\" role=\\\"form\\\" class=\\\"modal-form\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" type=\\\"button\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">\");\nif ( apiKey)\n{\nbuf.push(\"Edit API key\");\n}\nelse\n{\nbuf.push(\"Create new API key\");\n}\nbuf.push(\"</h4></div><div class=\\\"modal-body\\\"><div class=\\\"form-group\\\"><label for=\\\"g-api-key-name\\\" class=\\\"control-label\\\">Name</label><input id=\\\"g-api-key-name\\\" type=\\\"text\\\" placeholder=\\\"Enter a name for this API key\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-api-key-token-duration\\\" class=\\\"control-label\\\">Token duration in days (optional)</label><input id=\\\"g-api-key-token-duration\\\" placeholder=\\\"Enter number of days\\\" class=\\\"input-sm form-control\\\"></div><label class=\\\"control-label\\\">Permission scope for this key</label><div class=\\\"g-scope-selection-container\\\"><div class=\\\"radio\\\"><label><input type=\\\"radio\\\" name=\\\"scopeType\\\" value=\\\"full\\\" id=\\\"g-scope-mode-full\\\" checked>Allow all actions on behalf of my user</label></div><div class=\\\"radio\\\"><label><input type=\\\"radio\\\" name=\\\"scopeType\\\" value=\\\"custom\\\" id=\\\"g-scope-mode-custom\\\">Only allow specific permissions for this key:</label></div>\");\n// iterate userTokenScopes\n;(function(){\n  var $$obj = userTokenScopes;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var tokenScope = $$obj[$index];\n\nbuf.push(\"<div class=\\\"checkbox disabled\\\"><label\" + (jade.attr(\"title\", tokenScope.description, true, true)) + \" class=\\\"g-custom-scope-description\\\"><input type=\\\"checkbox\\\"\" + (jade.attr(\"value\", tokenScope.id, true, true)) + \" disabled class=\\\"g-custom-scope-checkbox\\\"><span>\" + (jade.escape(null == (jade_interp = tokenScope.name) ? \"\" : jade_interp)) + \"</span></label></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var tokenScope = $$obj[$index];\n\nbuf.push(\"<div class=\\\"checkbox disabled\\\"><label\" + (jade.attr(\"title\", tokenScope.description, true, true)) + \" class=\\\"g-custom-scope-description\\\"><input type=\\\"checkbox\\\"\" + (jade.attr(\"value\", tokenScope.id, true, true)) + \" disabled class=\\\"g-custom-scope-checkbox\\\"><span>\" + (jade.escape(null == (jade_interp = tokenScope.name) ? \"\" : jade_interp)) + \"</span></label></div>\");\n    }\n\n  }\n}).call(this);\n\nif ( user.get('admin'))\n{\n// iterate adminTokenScopes\n;(function(){\n  var $$obj = adminTokenScopes;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var tokenScope = $$obj[$index];\n\nbuf.push(\"<div class=\\\"checkbox disabled\\\"><label\" + (jade.attr(\"title\", tokenScope.description, true, true)) + \" class=\\\"g-custom-scope-description\\\"><input type=\\\"checkbox\\\"\" + (jade.attr(\"value\", tokenScope.id, true, true)) + \" disabled class=\\\"g-custom-scope-checkbox\\\"><span>\" + (jade.escape(null == (jade_interp = tokenScope.name) ? \"\" : jade_interp)) + \"</span></label></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var tokenScope = $$obj[$index];\n\nbuf.push(\"<div class=\\\"checkbox disabled\\\"><label\" + (jade.attr(\"title\", tokenScope.description, true, true)) + \" class=\\\"g-custom-scope-description\\\"><input type=\\\"checkbox\\\"\" + (jade.attr(\"value\", tokenScope.id, true, true)) + \" disabled class=\\\"g-custom-scope-checkbox\\\"><span>\" + (jade.escape(null == (jade_interp = tokenScope.name) ? \"\" : jade_interp)) + \"</span></label></div>\");\n    }\n\n  }\n}).call(this);\n\n}\nbuf.push(\"</div><div class=\\\"g-validation-failed-message\\\"></div></div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-small btn-default\\\">Cancel</a><button type=\\\"submit\\\" class=\\\"g-save-api-key btn btn-small btn-primary\\\">\");\nif ( apiKey)\n{\nbuf.push(\"<i class=\\\"icon-edit\\\"></i> Save\");\n}\nelse\n{\nbuf.push(\"<i class=\\\"icon-plus-squared\\\"></i> Create\");\n}\nbuf.push(\"</button></div></form></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"editAssetstoreWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),assetstore = locals_.assetstore,types = locals_.types;\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><form id=\\\"g-assetstore-edit-form\\\" role=\\\"form\\\" class=\\\"modal-form\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" type=\\\"button\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">Edit assetstore</h4></div><div class=\\\"modal-body\\\"><div class=\\\"g-assetstore-form-fields\\\"><div class=\\\"form-group\\\"><label for=\\\"g-edit-name\\\" class=\\\"control-label\\\">Assetstore Name</label><input id=\\\"g-edit-name\\\" type=\\\"text\\\" placeholder=\\\"Name\\\" class=\\\"input-sm form-control\\\"></div>\");\nif ( assetstore.get('type') === types.FILESYSTEM)\n{\nbuf.push(\"<div class=\\\"form-group\\\"><label for=\\\"g-edit-fs-root\\\" class=\\\"control-label\\\">Root directory</label><input id=\\\"g-edit-fs-root\\\" type=\\\"text\\\" placeholder=\\\"Root directory\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-edit-fs-perms\\\" class=\\\"control-label\\\">File creation permissions (octal)</label><input id=\\\"g-edit-fs-perms\\\" type=\\\"text\\\" placeholder=\\\"600\\\" class=\\\"input-sm form-control\\\"></div>\");\n}\nif ( assetstore.get('type') === types.GRIDFS)\n{\nbuf.push(\"<div class=\\\"form-group\\\"><label for=\\\"g-edit-gridfs-db\\\" class=\\\"control-label\\\">Database name</label><input id=\\\"g-edit-gridfs-db\\\" type=\\\"text\\\" placeholder=\\\"Database name\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-edit-gridfs-mongohost\\\" class=\\\"control-label\\\">Mongo Host URI</label><input id=\\\"g-edit-gridfs-mongohost\\\" type=\\\"text\\\" placeholder=\\\"Mongo host uri (defaults to the main Girder database)\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-edit-gridfs-replicaset\\\" class=\\\"control-label\\\">Replica Set</label><input id=\\\"g-edit-gridfs-replicaset\\\" type=\\\"text\\\" placeholder=\\\"Replica set name (blank if not using a replica set)\\\" class=\\\"input-sm form-control\\\"></div>\");\n}\nif ( assetstore.get('type') === types.S3)\n{\nbuf.push(\"<div class=\\\"form-group\\\"><label for=\\\"g-edit-s3-bucket\\\" class=\\\"control-label\\\">S3 bucket name</label><input id=\\\"g-edit-s3-bucket\\\" type=\\\"text\\\" placeholder=\\\"Bucket\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-edit-s3-prefix\\\" class=\\\"control-label\\\">Path prefix (optional)</label><input id=\\\"g-edit-s3-prefix\\\" type=\\\"text\\\" placeholder=\\\"Prefix\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-edit-s3-access-key-id\\\" class=\\\"control-label\\\">Access key ID</label><input id=\\\"g-edit-s3-access-key-id\\\" type=\\\"text\\\" placeholder=\\\"Access key ID\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-edit-s3-secret\\\" class=\\\"control-label\\\">Secret access key</label><input id=\\\"g-edit-s3-secret\\\" type=\\\"text\\\" placeholder=\\\"Secret access key\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-edit-s3-service\\\" class=\\\"control-label\\\">Service</label><input id=\\\"g-edit-s3-service\\\" type=\\\"text\\\" placeholder=\\\"Service name\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"checkbox\\\"><label><input id=\\\"g-edit-s3-readonly\\\" type=\\\"checkbox\\\">Read only</label></div>\");\n}\nbuf.push(\"</div>\");\nif ( assetstore.get('hasFiles'))\n{\nbuf.push(\"<div><i class=\\\"icon-attention\\\"></i><b>Warning:</b> This assetstore contains files.  If you edit where the assetstore is located or how it is reached, those files may become unreachable.</div>\");\n}\nbuf.push(\"<div class=\\\"g-validation-failed-message\\\"></div></div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-small btn-default\\\">Cancel</a>\");\nif ( !assetstore.get('hasFiles'))\n{\nbuf.push(\"<button type=\\\"submit\\\" class=\\\"g-save-assetstore btn btn-small btn-primary\\\"><i class=\\\"icon-edit\\\"></i>Save</button>\");\n}\nelse\n{\nbuf.push(\"<button type=\\\"submit\\\" class=\\\"g-save-assetstore btn btn-small btn-primary btn-danger\\\"><i class=\\\"icon-edit\\\"></i>Save<i class=\\\"icon-attention\\\"></i></button>\");\n}\nbuf.push(\"</div></form></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"editCollectionWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),collection = locals_.collection;\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><form id=\\\"g-collection-edit-form\\\" role=\\\"form\\\" class=\\\"modal-form\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" type=\\\"button\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">\");\nif ( (collection))\n{\nbuf.push(\"Edit collection\");\n}\nelse\n{\nbuf.push(\"Create collection\");\n}\nbuf.push(\"</h4></div><div class=\\\"modal-body\\\"><div class=\\\"form-group\\\"><label for=\\\"g-name\\\" class=\\\"control-label\\\">Name</label><input id=\\\"g-name\\\" type=\\\"text\\\" placeholder=\\\"Enter collection name\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-description\\\" class=\\\"control-label\\\">Description (optional)</label><textarea id=\\\"g-description\\\" placeholder=\\\"Enter collection description\\\" class=\\\"input-sm form-control\\\"></textarea></div><div class=\\\"g-validation-failed-message\\\"></div></div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-small btn-default\\\">Cancel</a><button type=\\\"submit\\\" class=\\\"g-save-collection btn btn-small btn-primary\\\">\");\nif ( (collection))\n{\nbuf.push(\"<i class=\\\"icon-edit\\\"></i>Save\");\n}\nelse\n{\nbuf.push(\"<i class=\\\"icon-plus-squared\\\"></i>Create\");\n}\nbuf.push(\"</button></div></form></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"editFileWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),file = locals_.file;\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><form id=\\\"g-file-edit-form\\\" role=\\\"form\\\" class=\\\"modal-form\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" type=\\\"button\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">Edit file</h4></div><div class=\\\"modal-body\\\"><div class=\\\"form-group\\\"><label for=\\\"g-name\\\" class=\\\"control-label\\\">Name</label><input id=\\\"g-name\\\" type=\\\"text\\\" placeholder=\\\"Enter file name\\\"\" + (jade.attr(\"value\", \"\" + (file.get('name')) + \"\", true, true)) + \" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-mimetype\\\" class=\\\"control-label\\\">MIME type</label><input id=\\\"g-mimetype\\\" type=\\\"text\\\" placeholder=\\\"Enter MIME type\\\"\" + (jade.attr(\"value\", \"\" + (file.get('mimeType')) + \"\", true, true)) + \" class=\\\"input-sm form-control\\\"></div><div class=\\\"g-validation-failed-message\\\"></div></div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-small btn-default\\\">Cancel</a><button type=\\\"submit\\\" class=\\\"g-save-file btn btn-small btn-primary\\\"><i class=\\\"icon-edit\\\"></i>Save</button></div></form></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"editFolderWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),folder = locals_.folder;\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><form id=\\\"g-folder-edit-form\\\" role=\\\"form\\\" class=\\\"modal-form\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" type=\\\"button\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">\");\nif ( (folder))\n{\nbuf.push(\"Edit folder\");\n}\nelse\n{\nbuf.push(\"Create folder\");\n}\nbuf.push(\"</h4></div><div class=\\\"modal-body\\\"><div class=\\\"form-group\\\"><label for=\\\"g-name\\\" class=\\\"control-label\\\">Name</label><input id=\\\"g-name\\\" type=\\\"text\\\" placeholder=\\\"Enter folder name\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label class=\\\"control-label\\\">Description (optional)</label><div class=\\\"g-description-editor-container\\\"></div></div><div class=\\\"g-validation-failed-message\\\"></div></div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-small btn-default\\\">Cancel</a><button type=\\\"submit\\\" class=\\\"g-save-folder btn btn-small btn-primary\\\">\");\nif ( (folder))\n{\nbuf.push(\"<i class=\\\"icon-edit\\\"></i>Save\");\n}\nelse\n{\nbuf.push(\"<i class=\\\"icon-plus-squared\\\"></i>Create\");\n}\nbuf.push(\"</button></div></form></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"editGroupWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),group = locals_.group,public = locals_.public,undefined = locals_.undefined,groupAddAllowed = locals_.groupAddAllowed,addToGroupPolicy = locals_.addToGroupPolicy,addAllowed = locals_.addAllowed;\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><form id=\\\"g-group-edit-form\\\" role=\\\"form\\\" class=\\\"modal-form\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" type=\\\"button\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">\");\nif ( (group))\n{\nbuf.push(\"Edit group\");\n}\nelse\n{\nbuf.push(\"Create group\");\n}\nbuf.push(\"</h4></div><div class=\\\"modal-body\\\"><div class=\\\"g-public-container\\\"><div class=\\\"radio\\\"><label><input id=\\\"g-access-private\\\" type=\\\"radio\\\" name=\\\"privacy\\\"\" + (jade.attr(\"checked\", (public ? undefined : \"checked\"), true, true)) + \"><i class=\\\"icon-lock\\\"></i>Private &mdash; Only members can see this group</label></div><div class=\\\"radio\\\"><label><input id=\\\"g-access-public\\\" type=\\\"radio\\\" name=\\\"privacy\\\"\" + (jade.attr(\"checked\", (public ? \"checked\" : undefined), true, true)) + \"><i class=\\\"icon-globe\\\"></i>Public &mdash; Anyone can see this group</label></div></div><div class=\\\"form-group\\\"><label for=\\\"g-name\\\" class=\\\"control-label\\\">Name</label><input id=\\\"g-name\\\" type=\\\"text\\\" placeholder=\\\"Enter group name\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-description\\\" class=\\\"control-label\\\">Description (optional)</label><textarea id=\\\"g-description\\\" placeholder=\\\"Enter group description\\\" class=\\\"input-sm form-control\\\"></textarea></div>\");\nif ( groupAddAllowed)\n{\nbuf.push(\"<div class=\\\"form-group\\\"><label for=\\\"g-add-to-group\\\" class=\\\"control-label\\\">Allow members to be directly added to this group</label><select id=\\\"g-add-to-group\\\" class=\\\"form-control input-sm\\\">\");\nif ( addToGroupPolicy === 'yesadmin')\n{\nbuf.push(\"<option value=\\\"default\\\"\" + (jade.attr(\"selected\", (addAllowed === 'default'), true, true)) + \">Default - Yes, allow group administrators to add members</option>\");\n}\nelse if ( addToGroupPolicy === 'yesmod')\n{\nbuf.push(\"<option value=\\\"default\\\"\" + (jade.attr(\"selected\", (addAllowed === 'default'), true, true)) + \">Default - Yes, allow group administrators and moderators to add members</option>\");\n}\nelse\n{\nbuf.push(\"<option value=\\\"default\\\"\" + (jade.attr(\"selected\", (addAllowed === 'default'), true, true)) + \">Default - No</option>\");\n}\nbuf.push(\"<option value=\\\"no\\\"\" + (jade.attr(\"selected\", (addAllowed === 'no'), true, true)) + \">No - members must be invited and accept invitations</option>\");\nif ( groupAddAllowed === 'mod')\n{\nbuf.push(\"<option value=\\\"yesmod\\\"\" + (jade.attr(\"selected\", (addAllowed === 'yesmod'), true, true)) + \">Yes - allow group administrators and moderators to directly add members</option>\");\n}\nbuf.push(\"<option value=\\\"yesadmin\\\"\" + (jade.attr(\"selected\", (addAllowed === 'yesadmin'), true, true)) + \">Yes - allow group administrators to directly add members</option></select></div>\");\n}\nbuf.push(\"<div class=\\\"g-validation-failed-message\\\"></div></div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-small btn-default\\\">Cancel</a><button type=\\\"submit\\\" class=\\\"g-save-group btn btn-small btn-primary\\\">\");\nif ( (group))\n{\nbuf.push(\"<i class=\\\"icon-edit\\\"></i>Save\");\n}\nelse\n{\nbuf.push(\"<i class=\\\"icon-plus-squared\\\"></i>Create\");\n}\nbuf.push(\"</button></div></form></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"editItemWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),item = locals_.item;\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><form id=\\\"g-item-edit-form\\\" role=\\\"form\\\" class=\\\"modal-form\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" type=\\\"button\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">\");\nif ( (item))\n{\nbuf.push(\"Edit item\");\n}\nelse\n{\nbuf.push(\"Create item\");\n}\nbuf.push(\"</h4></div><div class=\\\"modal-body\\\"><div class=\\\"form-group\\\"><label for=\\\"g-name\\\" class=\\\"control-label\\\">Name</label><input id=\\\"g-name\\\" type=\\\"text\\\" placeholder=\\\"Enter item name\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-description\\\" class=\\\"control-label\\\">Description (optional)</label><textarea id=\\\"g-description\\\" placeholder=\\\"Enter item description\\\" class=\\\"input-sm form-control\\\"></textarea></div><div class=\\\"g-validation-failed-message\\\"></div></div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-small btn-default\\\">Cancel</a><button type=\\\"submit\\\" class=\\\"g-save-item btn btn-small btn-primary\\\">\");\nif ( (item))\n{\nbuf.push(\"<i class=\\\"icon-edit\\\"></i>Save\");\n}\nelse\n{\nbuf.push(\"<i class=\\\"icon-plus-squared\\\"></i>Create\");\n}\nbuf.push(\"</button></div></form></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"fileInfoDialog\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),file = locals_.file,girder = locals_.girder;\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">File information</h4><div class=\\\"g-dialog-subtitle\\\"><i class=\\\"icon-doc-inv\\\"></i><span>\" + (jade.escape(null == (jade_interp = file.name()) ? \"\" : jade_interp)) + \"</span></div></div><div class=\\\"modal-body\\\"><div class=\\\"g-file-info-lines\\\"><div property=\\\"created\\\" class=\\\"g-file-info-line\\\"><i class=\\\"icon-clock\\\"></i><span>Created </span><span class=\\\"g-bold-part\\\">\" + (jade.escape(null == (jade_interp = girder.formatDate(file.get('created'), girder.DATE_SECOND)) ? \"\" : jade_interp)) + \"</span></div><div property=\\\"mimeType\\\" class=\\\"g-file-info-line\\\"><i class=\\\"icon-info\\\"></i><span>MIME type:</span><span class=\\\"g-bold-part\\\"> \" + (jade.escape((jade_interp = file.get('mimeType') || 'unknown') == null ? '' : jade_interp)) + \"</span></div>\");\nif ( file.has('size'))\n{\nbuf.push(\"<div property=\\\"size\\\" class=\\\"g-file-info-line\\\"><i class=\\\"icon-hdd\\\"></i><span>Size:</span><span class=\\\"g-bold-part\\\"> \" + (jade.escape((jade_interp = file.get('size')) == null ? '' : jade_interp)) + \" bytes</span></div>\");\n}\nbuf.push(\"<div property=\\\"id\\\" class=\\\"g-file-info-line\\\"><i class=\\\"icon-share\\\"></i><span>Unique ID:</span><span class=\\\"g-bold-part\\\"> \" + (jade.escape((jade_interp = file.id) == null ? '' : jade_interp)) + \"</span></div></div></div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-small btn-default\\\">Close</a></div></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"fileList\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),files = locals_.files,girder = locals_.girder,parentItem = locals_.parentItem,hasMore = locals_.hasMore;\nbuf.push(\"<ul class=\\\"g-file-list\\\">\");\n// iterate files\n;(function(){\n  var $$obj = files;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var file = $$obj[$index];\n\nbuf.push(\"<li class=\\\"g-file-list-entry\\\"><a\" + (jade.attr(\"cid\", file.cid, true, true)) + \" title=\\\"Download file\\\"\" + (jade.attr(\"target\", file.get('linkUrl') ? '_blank' : '_self', true, true)) + (jade.attr(\"href\", file.downloadUrl(), true, true)) + \" rel=\\\"noopener noreferrer\\\" class=\\\"g-file-list-link\\\">\");\nif ( file.get('linkUrl'))\n{\nbuf.push(\"<i class=\\\"icon-link\\\"></i><span class=\\\"g-file-name\\\">\" + (jade.escape(null == (jade_interp = file.name()) ? \"\" : jade_interp)) + \"</span><i class=\\\"icon-link-ext\\\"></i>\");\n}\nelse\n{\nbuf.push(\"<i class=\\\"icon-doc-inv\\\"></i>\" + (jade.escape(null == (jade_interp = file.name()) ? \"\" : jade_interp)));\n}\nbuf.push(\"</a><a title=\\\"View in browser\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\"\" + (jade.attr(\"href\", file.downloadUrl({contentDisposition: 'inline'}), true, true)) + \" class=\\\"g-view-inline\\\"><i class=\\\"icon-eye\\\"></i></a><a\" + (jade.attr(\"file-cid\", file.cid, true, true)) + \" title=\\\"Show info\\\" class=\\\"g-show-info\\\"><i class=\\\"icon-info\\\"></i></a>\");\nif ( file.has('size'))\n{\nbuf.push(\"<div class=\\\"g-file-size\\\">\" + (jade.escape(null == (jade_interp = girder.formatSize(file.get('size'))) ? \"\" : jade_interp)) + \"</div>\");\n}\nbuf.push(\"<div\" + (jade.attr(\"file-cid\", file.cid, true, true)) + \" class=\\\"g-file-actions-container\\\">\");\nif ( parentItem && parentItem.get('_accessLevel') >= girder.AccessType.WRITE)\n{\nbuf.push(\"<a title=\\\"Edit file info\\\" class=\\\"g-update-info\\\"><i class=\\\"icon-edit\\\"></i></a><a title=\\\"Replace file contents\\\" class=\\\"g-update-contents\\\"><i class=\\\"icon-upload\\\"></i></a><a title=\\\"Delete file\\\" class=\\\"g-delete-file\\\"><i class=\\\"icon-cancel\\\"></i></a>\");\n}\nbuf.push(\"</div></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var file = $$obj[$index];\n\nbuf.push(\"<li class=\\\"g-file-list-entry\\\"><a\" + (jade.attr(\"cid\", file.cid, true, true)) + \" title=\\\"Download file\\\"\" + (jade.attr(\"target\", file.get('linkUrl') ? '_blank' : '_self', true, true)) + (jade.attr(\"href\", file.downloadUrl(), true, true)) + \" rel=\\\"noopener noreferrer\\\" class=\\\"g-file-list-link\\\">\");\nif ( file.get('linkUrl'))\n{\nbuf.push(\"<i class=\\\"icon-link\\\"></i><span class=\\\"g-file-name\\\">\" + (jade.escape(null == (jade_interp = file.name()) ? \"\" : jade_interp)) + \"</span><i class=\\\"icon-link-ext\\\"></i>\");\n}\nelse\n{\nbuf.push(\"<i class=\\\"icon-doc-inv\\\"></i>\" + (jade.escape(null == (jade_interp = file.name()) ? \"\" : jade_interp)));\n}\nbuf.push(\"</a><a title=\\\"View in browser\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\"\" + (jade.attr(\"href\", file.downloadUrl({contentDisposition: 'inline'}), true, true)) + \" class=\\\"g-view-inline\\\"><i class=\\\"icon-eye\\\"></i></a><a\" + (jade.attr(\"file-cid\", file.cid, true, true)) + \" title=\\\"Show info\\\" class=\\\"g-show-info\\\"><i class=\\\"icon-info\\\"></i></a>\");\nif ( file.has('size'))\n{\nbuf.push(\"<div class=\\\"g-file-size\\\">\" + (jade.escape(null == (jade_interp = girder.formatSize(file.get('size'))) ? \"\" : jade_interp)) + \"</div>\");\n}\nbuf.push(\"<div\" + (jade.attr(\"file-cid\", file.cid, true, true)) + \" class=\\\"g-file-actions-container\\\">\");\nif ( parentItem && parentItem.get('_accessLevel') >= girder.AccessType.WRITE)\n{\nbuf.push(\"<a title=\\\"Edit file info\\\" class=\\\"g-update-info\\\"><i class=\\\"icon-edit\\\"></i></a><a title=\\\"Replace file contents\\\" class=\\\"g-update-contents\\\"><i class=\\\"icon-upload\\\"></i></a><a title=\\\"Delete file\\\" class=\\\"g-delete-file\\\"><i class=\\\"icon-cancel\\\"></i></a>\");\n}\nbuf.push(\"</div></li>\");\n    }\n\n  }\n}).call(this);\n\nif ( hasMore)\n{\nbuf.push(\"<li class=\\\"g-show-more\\\"><a class=\\\"g-show-more-files\\\"><i class=\\\"icon-level-down\\\"></i>Show more files...</a></li>\");\n}\nbuf.push(\"</ul>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"folderInfoDialog\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),girder = locals_.girder,folder = locals_.folder;\njade_mixins[\"dateInfo\"] = function(intro, property){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<div\" + (jade.attr(\"property\", \"\" + (property) + \"\", true, true)) + \" class=\\\"g-folder-info-line\\\"><i class=\\\"icon-clock\\\"></i><span>\" + (jade.escape(null == (jade_interp = intro) ? \"\" : jade_interp)) + \"</span><span class=\\\"g-bold-part\\\">\" + (jade.escape(null == (jade_interp = girder.formatDate(folder.get(property), girder.DATE_SECOND)) ? \"\" : jade_interp)) + \"</span></div>\");\n};\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">Folder information</h4><div class=\\\"g-dialog-subtitle\\\"><i class=\\\"icon-folder\\\"></i><span>\" + (jade.escape(null == (jade_interp = folder.name()) ? \"\" : jade_interp)) + \"</span></div></div><div class=\\\"modal-body\\\">\");\nif ( folder.get('description'))\n{\nbuf.push(\"<div class=\\\"g-info-dialog-description g-folder-description\\\">\" + (null == (jade_interp = girder.renderMarkdown(folder.get('description'))) ? \"\" : jade_interp) + \"</div>\");\n}\nbuf.push(\"<div class=\\\"g-folder-info-lines\\\">\");\njade_mixins[\"dateInfo\"]('Created ', 'created');\nif ( folder.get('created') !== folder.get('updated'))\n{\njade_mixins[\"dateInfo\"]('Last updated ', 'updated');\n}\nbuf.push(\"<div property=\\\"nItems\\\" class=\\\"g-folder-info-line\\\"><i class=\\\"icon-doc-text-inv\\\"></i><span>Contains</span><span class=\\\"g-bold-part\\\"> \" + (jade.escape((jade_interp = folder.get('nItems')) == null ? '' : jade_interp)) + \" items</span><span> totaling</span><span class=\\\"g-bold-part\\\"> \" + (jade.escape((jade_interp = girder.formatSize(folder.get('size'))) == null ? '' : jade_interp)) + \"</span></div><div property=\\\"nFolders\\\" class=\\\"g-folder-info-line\\\"><i class=\\\"icon-folder\\\"></i><span>Contains</span><span class=\\\"g-bold-part\\\"> \" + (jade.escape((jade_interp = folder.get('nFolders')) == null ? '' : jade_interp)) + \" subfolders</span></div><div property=\\\"id\\\" class=\\\"g-folder-info-line\\\"><i class=\\\"icon-share\\\"></i><span>Unique ID:</span><span class=\\\"g-bold-part\\\"> \" + (jade.escape((jade_interp = folder.id) == null ? '' : jade_interp)) + \"</span></div></div></div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-small btn-default\\\">Close</a></div></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"folderList\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),folders = locals_.folders,checkboxes = locals_.checkboxes,hasMore = locals_.hasMore;\nbuf.push(\"<ul class=\\\"g-folder-list\\\">\");\n// iterate folders\n;(function(){\n  var $$obj = folders;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var folder = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attr(\"public\", (folder.get('public') ? 'true' : 'false'), true, true)) + \" class=\\\"g-folder-list-entry\\\">\");\nif ( checkboxes)\n{\nbuf.push(\"<input type=\\\"checkbox\\\"\" + (jade.attr(\"g-folder-cid\", folder.cid, true, true)) + \" class=\\\"g-list-checkbox\\\">\");\n}\nbuf.push(\"<a\" + (jade.attr(\"g-folder-cid\", folder.cid, true, true)) + \" class=\\\"g-folder-list-link\\\"><i class=\\\"icon-folder\\\"></i>\" + (jade.escape(null == (jade_interp = folder.get('name')) ? \"\" : jade_interp)) + \"<i class=\\\"icon-right-dir\\\"></i></a><div class=\\\"g-folder-privacy\\\">\");\nif ( folder.get('public'))\n{\nbuf.push(\"<i class=\\\"icon-globe\\\"></i>Public\");\n}\nelse\n{\nbuf.push(\"<i class=\\\"icon-lock\\\"></i>Private\");\n}\nbuf.push(\"</div></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var folder = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attr(\"public\", (folder.get('public') ? 'true' : 'false'), true, true)) + \" class=\\\"g-folder-list-entry\\\">\");\nif ( checkboxes)\n{\nbuf.push(\"<input type=\\\"checkbox\\\"\" + (jade.attr(\"g-folder-cid\", folder.cid, true, true)) + \" class=\\\"g-list-checkbox\\\">\");\n}\nbuf.push(\"<a\" + (jade.attr(\"g-folder-cid\", folder.cid, true, true)) + \" class=\\\"g-folder-list-link\\\"><i class=\\\"icon-folder\\\"></i>\" + (jade.escape(null == (jade_interp = folder.get('name')) ? \"\" : jade_interp)) + \"<i class=\\\"icon-right-dir\\\"></i></a><div class=\\\"g-folder-privacy\\\">\");\nif ( folder.get('public'))\n{\nbuf.push(\"<i class=\\\"icon-globe\\\"></i>Public\");\n}\nelse\n{\nbuf.push(\"<i class=\\\"icon-lock\\\"></i>Private\");\n}\nbuf.push(\"</div></li>\");\n    }\n\n  }\n}).call(this);\n\nif ( hasMore)\n{\nbuf.push(\"<li class=\\\"g-show-more\\\"><a class=\\\"g-show-more-folders\\\"><i class=\\\"icon-level-down\\\"></i>Show more folders...</a></li>\");\n}\nbuf.push(\"</ul>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"groupAdminList\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),admins = locals_.admins,level = locals_.level,accessType = locals_.accessType;\nbuf.push(\"<div title=\\\"Group administrators can edit group properties and can add, invite, and remove group members, moderators, and administrators.\\\" class=\\\"g-group-admins-header g-group-list-header\\\"><i class=\\\"icon-star\\\"></i><span>Administrators</span></div><div class=\\\"g-group-admins-body\\\"><ul class=\\\"g-group-admins\\\">\");\n// iterate admins\n;(function(){\n  var $$obj = admins;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var userAccess = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attr(\"userid\", \"\" + (userAccess.id) + \"\", true, true)) + (jade.attr(\"username\", \"\" + (userAccess.name) + \"\", true, true)) + \"><a class=\\\"g-member-name\\\"><i class=\\\"icon-user\\\"></i><span>\" + (jade.escape((jade_interp = userAccess.name) == null ? '' : jade_interp)) + \" (\" + (jade.escape((jade_interp = userAccess.login) == null ? '' : jade_interp)) + \")</span></a><div class=\\\"g-group-member-controls pull-right\\\">\");\nif ( level >= accessType.ADMIN)\n{\nbuf.push(\"<span class=\\\"dropdown\\\"><a title=\\\"Demote user\\\" data-toggle=\\\"dropdown\\\" class=\\\"g-group-admin-demote dropdown-toggle\\\"><i class=\\\"icon-down-big\\\"></i><i class=\\\"icon-down-dir\\\"></i></a><ul role=\\\"menu\\\" class=\\\"dropdown-menu pull-right\\\"><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-demote-moderator\\\"><i class=\\\"icon-minus\\\"></i><span>Demote to moderator</span></a></li><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-demote-member\\\"><i class=\\\"icon-minus\\\"></i><span>Demote to member</span></a></li></ul></span><a title=\\\"Remove user from the group\\\" class=\\\"g-group-admin-remove\\\"><i class=\\\"icon-block\\\"></i></a>\");\n}\nbuf.push(\"</div></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var userAccess = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attr(\"userid\", \"\" + (userAccess.id) + \"\", true, true)) + (jade.attr(\"username\", \"\" + (userAccess.name) + \"\", true, true)) + \"><a class=\\\"g-member-name\\\"><i class=\\\"icon-user\\\"></i><span>\" + (jade.escape((jade_interp = userAccess.name) == null ? '' : jade_interp)) + \" (\" + (jade.escape((jade_interp = userAccess.login) == null ? '' : jade_interp)) + \")</span></a><div class=\\\"g-group-member-controls pull-right\\\">\");\nif ( level >= accessType.ADMIN)\n{\nbuf.push(\"<span class=\\\"dropdown\\\"><a title=\\\"Demote user\\\" data-toggle=\\\"dropdown\\\" class=\\\"g-group-admin-demote dropdown-toggle\\\"><i class=\\\"icon-down-big\\\"></i><i class=\\\"icon-down-dir\\\"></i></a><ul role=\\\"menu\\\" class=\\\"dropdown-menu pull-right\\\"><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-demote-moderator\\\"><i class=\\\"icon-minus\\\"></i><span>Demote to moderator</span></a></li><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-demote-member\\\"><i class=\\\"icon-minus\\\"></i><span>Demote to member</span></a></li></ul></span><a title=\\\"Remove user from the group\\\" class=\\\"g-group-admin-remove\\\"><i class=\\\"icon-block\\\"></i></a>\");\n}\nbuf.push(\"</div></li>\");\n    }\n\n  }\n}).call(this);\n\nif ( (!admins.length))\n{\nbuf.push(\"<div class=\\\"g-member-list-empty\\\"><i class=\\\"icon-info-circled\\\"></i><span>There are no administrators in this group.</span></div>\");\n}\nbuf.push(\"</ul></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"groupInviteDialog\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),user = locals_.user,mayAdd = locals_.mayAdd,level = locals_.level,accessType = locals_.accessType;\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" type=\\\"button\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">Invite user to group</h4><div class=\\\"g-dialog-subtitle\\\"><i class=\\\"icon-user\\\"></i><span>\" + (jade.escape((jade_interp = user.text) == null ? '' : jade_interp)) + \"</span></div></div><div class=\\\"modal-body\\\"><label class=\\\"control-label\\\">Select a role for this user</label><div id=\\\"g-invite-role-container\\\" class=\\\"panel-group\\\"><div class=\\\"panel panel-default\\\"><div data-toggle=\\\"collapse\\\" data-parent=\\\"#g-invite-role-container\\\" data-target=\\\"#g-invite-role-member\\\" class=\\\"panel-heading\\\"><div class=\\\"panel-title\\\"><a>Invite as member</a></div></div><div id=\\\"g-invite-role-member\\\" class=\\\"panel-collapse collapse in\\\"><div class=\\\"panel-body\\\"><p>Group members are able to gain all privileges granted to\\nthe group itself on other resources. They are able to view the\\ngroup, but may not change properties of the group.</p><div class=\\\"g-invite-as-member btn btn-primary\\\"><i class=\\\"icon-mail\\\"></i><span>Invite as member</span></div>\");\nif ( mayAdd)\n{\nbuf.push(\"<div class=\\\"g-add-as-member btn btn-warning g-add-user-button\\\"><i class=\\\"icon-plus\\\"></i><span>Add as member</span></div>\");\n}\nbuf.push(\"</div></div></div>\");\nif ( (level >= accessType.ADMIN))\n{\nbuf.push(\"<div class=\\\"panel panel-default\\\"><div data-toggle=\\\"collapse\\\" data-parent=\\\"#g-invite-role-container\\\" data-target=\\\"#g-invite-role-moderator\\\" class=\\\"panel-heading\\\"><div class=\\\"panel-title\\\"><a>Invite as moderator</a></div></div><div id=\\\"g-invite-role-moderator\\\" class=\\\"panel-collapse collapse\\\"><div class=\\\"panel-body\\\"><p>Group moderators are members of the group who are also\\ngranted the power to add and remove users from the group.</p><div class=\\\"g-invite-as-moderator btn btn-primary\\\"><i class=\\\"icon-mail\\\"></i><span>Invite as moderator</span></div>\");\nif ( mayAdd)\n{\nbuf.push(\"<div class=\\\"g-add-as-moderator btn btn-warning g-add-user-button\\\"><i class=\\\"icon-plus\\\"></i><span>Add as moderator</span></div>\");\n}\nbuf.push(\"</div></div></div>\");\n}\nif ( (level >= accessType.ADMIN))\n{\nbuf.push(\"<div class=\\\"panel panel-default\\\"><div data-toggle=\\\"collapse\\\" data-parent=\\\"#g-invite-role-container\\\" data-target=\\\"#g-invite-role-admin\\\" class=\\\"panel-heading\\\"><div class=\\\"panel-title\\\"><a>Invite as administrator</a></div></div><div id=\\\"g-invite-role-admin\\\" class=\\\"panel-collapse collapse\\\"><div class=\\\"panel-body\\\"><p>Group administrators have all the power of group moderators,\\nand additionally can promote group members to moderators\\nor administrators. They also have the power to delete the\\ngroup entirely.</p><div class=\\\"g-invite-as-admin btn btn-primary\\\"><i class=\\\"icon-mail\\\"></i><span>Invite as administrator</span></div>\");\nif ( mayAdd)\n{\nbuf.push(\"<div class=\\\"g-add-as-admin btn btn-warning g-add-user-button\\\"><i class=\\\"icon-plus\\\"></i><span>Add as administrator</span></div>\");\n}\nbuf.push(\"</div></div></div>\");\n}\nbuf.push(\"</div><div class=\\\"g-validation-failed-message\\\"></div></div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-small btn-default\\\">Cancel</a></div></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"groupInviteList\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),invitees = locals_.invitees,level = locals_.level,accessType = locals_.accessType;\nbuf.push(\"<ul class=\\\"g-group-invites\\\">\");\n// iterate invitees\n;(function(){\n  var $$obj = invitees;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var user = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attr(\"cid\", \"\" + (user.cid) + \"\", true, true)) + (jade.attr(\"username\", \"\" + (user.name()) + \"\", true, true)) + \"><a class=\\\"g-member-name\\\"><i class=\\\"icon-user\\\"></i><span>\" + (jade.escape((jade_interp = user.name()) == null ? '' : jade_interp)) + \" (\" + (jade.escape((jade_interp = user.get('login')) == null ? '' : jade_interp)) + \")</span></a><div class=\\\"g-group-member-controls pull-right\\\">\");\nif ( level >= accessType.WRITE)\n{\nbuf.push(\"<a title=\\\"Uninvite this user\\\" class=\\\"g-group-uninvite\\\"><i class=\\\"icon-block\\\"></i></a>\");\n}\nbuf.push(\"</div></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var user = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attr(\"cid\", \"\" + (user.cid) + \"\", true, true)) + (jade.attr(\"username\", \"\" + (user.name()) + \"\", true, true)) + \"><a class=\\\"g-member-name\\\"><i class=\\\"icon-user\\\"></i><span>\" + (jade.escape((jade_interp = user.name()) == null ? '' : jade_interp)) + \" (\" + (jade.escape((jade_interp = user.get('login')) == null ? '' : jade_interp)) + \")</span></a><div class=\\\"g-group-member-controls pull-right\\\">\");\nif ( level >= accessType.WRITE)\n{\nbuf.push(\"<a title=\\\"Uninvite this user\\\" class=\\\"g-group-uninvite\\\"><i class=\\\"icon-block\\\"></i></a>\");\n}\nbuf.push(\"</div></li>\");\n    }\n\n  }\n}).call(this);\n\nif ( (!invitees.length))\n{\nbuf.push(\"<div class=\\\"g-member-list-empty\\\"><i class=\\\"icon-info-circled\\\"></i><span>There are no pending invitations to this group.</span></div>\");\n}\nbuf.push(\"</ul>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"groupMemberList\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),level = locals_.level,accessType = locals_.accessType,members = locals_.members;\nbuf.push(\"<div class=\\\"g-group-members-header g-group-list-header\\\"><i class=\\\"icon-users\\\"></i><span>Members</span>\");\nif ( level >= accessType.WRITE)\n{\nbuf.push(\"<form role=\\\"form\\\" class=\\\"g-group-invite-form form-inline\\\"><span><i class=\\\"icon-mail-alt\\\"></i></span><div class=\\\"form-group g-group-invite-container\\\"></div></form>\");\n}\nbuf.push(\"<div class=\\\"g-member-pagination\\\"></div></div><div class=\\\"g-group-members-body\\\"><ul class=\\\"g-group-members\\\">\");\n// iterate members\n;(function(){\n  var $$obj = members;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var member = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attr(\"cid\", \"\" + (member.cid) + \"\", true, true)) + \"><a class=\\\"g-member-name\\\"><i class=\\\"icon-user\\\"></i><span>\" + (jade.escape((jade_interp = member.name()) == null ? '' : jade_interp)) + \" (\" + (jade.escape((jade_interp = member.get('login')) == null ? '' : jade_interp)) + \")</span></a><div class=\\\"g-group-member-controls pull-right\\\">\");\nif ( level >= accessType.ADMIN)\n{\nbuf.push(\"<span class=\\\"dropdown\\\"><a title=\\\"Promote user\\\" data-toggle=\\\"dropdown\\\" class=\\\"g-group-member-promote dropdown-toggle\\\"><i class=\\\"icon-up-big\\\"></i><i class=\\\"icon-down-dir\\\"></i></a><ul role=\\\"menu\\\" class=\\\"dropdown-menu pull-right\\\"><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-promote-moderator\\\"><i class=\\\"icon-plus\\\"></i><span>Promote to moderator</span></a></li><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-promote-admin\\\"><i class=\\\"icon-plus\\\"></i><span>Promote to administrator</span></a></li></ul></span>\");\n}\nif ( level >= accessType.WRITE)\n{\nbuf.push(\"<a title=\\\"Remove user from the group\\\" class=\\\"g-group-member-remove\\\"><i class=\\\"icon-block\\\"></i></a>\");\n}\nbuf.push(\"</div></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var member = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attr(\"cid\", \"\" + (member.cid) + \"\", true, true)) + \"><a class=\\\"g-member-name\\\"><i class=\\\"icon-user\\\"></i><span>\" + (jade.escape((jade_interp = member.name()) == null ? '' : jade_interp)) + \" (\" + (jade.escape((jade_interp = member.get('login')) == null ? '' : jade_interp)) + \")</span></a><div class=\\\"g-group-member-controls pull-right\\\">\");\nif ( level >= accessType.ADMIN)\n{\nbuf.push(\"<span class=\\\"dropdown\\\"><a title=\\\"Promote user\\\" data-toggle=\\\"dropdown\\\" class=\\\"g-group-member-promote dropdown-toggle\\\"><i class=\\\"icon-up-big\\\"></i><i class=\\\"icon-down-dir\\\"></i></a><ul role=\\\"menu\\\" class=\\\"dropdown-menu pull-right\\\"><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-promote-moderator\\\"><i class=\\\"icon-plus\\\"></i><span>Promote to moderator</span></a></li><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-promote-admin\\\"><i class=\\\"icon-plus\\\"></i><span>Promote to administrator</span></a></li></ul></span>\");\n}\nif ( level >= accessType.WRITE)\n{\nbuf.push(\"<a title=\\\"Remove user from the group\\\" class=\\\"g-group-member-remove\\\"><i class=\\\"icon-block\\\"></i></a>\");\n}\nbuf.push(\"</div></li>\");\n    }\n\n  }\n}).call(this);\n\nif ( (!members.length))\n{\nbuf.push(\"<div class=\\\"g-member-list-empty\\\"><i class=\\\"icon-info-circled\\\"></i><span>There are no members in this group.</span></div>\");\n}\nbuf.push(\"</ul></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"groupModList\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),moderators = locals_.moderators,level = locals_.level,accessType = locals_.accessType;\nbuf.push(\"<div title=\\\"Group moderators can invite and approve group members.\\\" class=\\\"g-group-mods-header g-group-list-header\\\"><i class=\\\"icon-shield\\\"></i><span>Moderators</span></div><div class=\\\"g-group-mods-body\\\"><ul class=\\\"g-group-mods\\\">\");\n// iterate moderators\n;(function(){\n  var $$obj = moderators;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var userAccess = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attr(\"userid\", \"\" + (userAccess.id) + \"\", true, true)) + (jade.attr(\"username\", \"\" + (userAccess.name) + \"\", true, true)) + \"><a class=\\\"g-member-name\\\"><i class=\\\"icon-user\\\"></i><span>\" + (jade.escape((jade_interp = userAccess.name) == null ? '' : jade_interp)) + \" (\" + (jade.escape((jade_interp = userAccess.login) == null ? '' : jade_interp)) + \")</span></a><div class=\\\"g-group-member-controls pull-right\\\">\");\nif ( level >= accessType.ADMIN)\n{\nbuf.push(\"<a title=\\\"Promote to administrator\\\" class=\\\"g-group-mod-promote\\\"><i class=\\\"icon-up-big\\\"></i></a><a title=\\\"Demote to member\\\" class=\\\"g-group-mod-demote\\\"><i class=\\\"icon-down-big\\\"></i></a><a title=\\\"Remove user from the group\\\" class=\\\"g-group-mod-remove\\\"><i class=\\\"icon-block\\\"></i></a>\");\n}\nbuf.push(\"</div></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var userAccess = $$obj[$index];\n\nbuf.push(\"<li\" + (jade.attr(\"userid\", \"\" + (userAccess.id) + \"\", true, true)) + (jade.attr(\"username\", \"\" + (userAccess.name) + \"\", true, true)) + \"><a class=\\\"g-member-name\\\"><i class=\\\"icon-user\\\"></i><span>\" + (jade.escape((jade_interp = userAccess.name) == null ? '' : jade_interp)) + \" (\" + (jade.escape((jade_interp = userAccess.login) == null ? '' : jade_interp)) + \")</span></a><div class=\\\"g-group-member-controls pull-right\\\">\");\nif ( level >= accessType.ADMIN)\n{\nbuf.push(\"<a title=\\\"Promote to administrator\\\" class=\\\"g-group-mod-promote\\\"><i class=\\\"icon-up-big\\\"></i></a><a title=\\\"Demote to member\\\" class=\\\"g-group-mod-demote\\\"><i class=\\\"icon-down-big\\\"></i></a><a title=\\\"Remove user from the group\\\" class=\\\"g-group-mod-remove\\\"><i class=\\\"icon-block\\\"></i></a>\");\n}\nbuf.push(\"</div></li>\");\n    }\n\n  }\n}).call(this);\n\nif ( (!moderators.length))\n{\nbuf.push(\"<div class=\\\"g-member-list-empty\\\"><i class=\\\"icon-info-circled\\\"></i><span>There are no moderators in this group.</span></div>\");\n}\nbuf.push(\"</ul></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"hierarchyBreadcrumb\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),links = locals_.links,current = locals_.current,descriptionText = locals_.descriptionText;\nvar idx = 0\n// iterate links\n;(function(){\n  var $$obj = links;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var obj = $$obj[$index];\n\nbuf.push(\"<li><a\" + (jade.attr(\"g-index\", idx, true, true)) + \" class=\\\"g-breadcrumb-link\\\">\");\nif ( obj.resourceName === 'user')\n{\nbuf.push(\"<i class=\\\"icon-user\\\"></i>\");\n}\nelse if ( obj.resourceName === 'collection')\n{\nbuf.push(\"<i class=\\\"icon-sitemap\\\"></i>\");\n}\nbuf.push((jade.escape(null == (jade_interp = obj.name()) ? \"\" : jade_interp)) + \"</a></li>\");\nidx += 1\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var obj = $$obj[$index];\n\nbuf.push(\"<li><a\" + (jade.attr(\"g-index\", idx, true, true)) + \" class=\\\"g-breadcrumb-link\\\">\");\nif ( obj.resourceName === 'user')\n{\nbuf.push(\"<i class=\\\"icon-user\\\"></i>\");\n}\nelse if ( obj.resourceName === 'collection')\n{\nbuf.push(\"<i class=\\\"icon-sitemap\\\"></i>\");\n}\nbuf.push((jade.escape(null == (jade_interp = obj.name()) ? \"\" : jade_interp)) + \"</a></li>\");\nidx += 1\n    }\n\n  }\n}).call(this);\n\nif ( current)\n{\nbuf.push(\"<li class=\\\"active\\\">\");\nif ( current.resourceName === 'user')\n{\nbuf.push(\"<i class=\\\"icon-user\\\"></i>\");\n}\nelse if ( current.resourceName === 'collection')\n{\nbuf.push(\"<i class=\\\"icon-sitemap\\\"></i>\");\n}\nbuf.push((jade.escape(null == (jade_interp = current.name()) ? \"\" : jade_interp)) + \"</li>\");\n}\nif ( descriptionText)\n{\nbuf.push(\"<a class=\\\"g-description-preview\\\">\" + (jade.escape(null == (jade_interp = descriptionText) ? \"\" : jade_interp)) + \"</a>\");\n}\nbuf.push(\"<div class=\\\"pull-right\\\"><div class=\\\"g-child-count-container hide\\\"><div class=\\\"g-subfolder-count-container\\\"><i class=\\\"icon-folder\\\"></i><div class=\\\"g-subfolder-count\\\"></div></div>\");\nif ( idx > 0)\n{\nbuf.push(\"<div class=\\\"g-item-count-container\\\"><i class=\\\"icon-doc-text-inv\\\"></i><div class=\\\"g-item-count\\\"></div></div>\");\n}\nbuf.push(\"</div>\");\nif ( idx > 0)\n{\nbuf.push(\"<div class=\\\"g-level-up-button-container\\\"><a title=\\\"Go up one level\\\" placement=\\\"left\\\" class=\\\"g-hierarchy-level-up\\\"><i class=\\\"icon-level-up\\\"></i></a></div>\");\n}\nbuf.push(\"</div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"hierarchyWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),showActions = locals_.showActions,checkboxes = locals_.checkboxes,type = locals_.type,level = locals_.level,AccessType = locals_.AccessType,girder = locals_.girder,model = locals_.model;\nbuf.push(\"<div class=\\\"g-hierarchy-widget\\\"><div class=\\\"g-hierarchy-breadcrumb-bar\\\"><ol class=\\\"breadcrumb\\\"></ol></div>\");\nif ( showActions)\n{\nbuf.push(\"<div class=\\\"g-hierarchy-actions-header\\\">\");\nif ( checkboxes)\n{\nbuf.push(\"<input type=\\\"checkbox\\\" data-toggle=\\\"tooltip\\\" title=\\\"Select / Unselect all\\\" class=\\\"g-select-all\\\"><div class=\\\"btn-group\\\"><button data-toggle=\\\"dropdown\\\" disabled=\\\"disabled\\\" title=\\\"Checked actions\\\" class=\\\"g-checked-actions-button btn btn-sm btn-default dropdown-toggle\\\"><i class=\\\"icon-check\\\"></i><i class=\\\"icon-down-dir\\\"></i></button><ul role=\\\"menu\\\" class=\\\"g-checked-actions-menu dropdown-menu\\\"></ul></div>\");\n}\nbuf.push(\"<div class=\\\"g-folder-header-buttons\\\">\");\nif ( (type === 'folder'))\n{\nbuf.push(\"<button title=\\\"Show folder info\\\" class=\\\"g-folder-info-button btn btn-sm btn-info\\\"><i class=\\\"icon-info\\\"></i></button>\");\nif ( (level >= AccessType.WRITE))\n{\nbuf.push(\"<button title=\\\"Upload here\\\" class=\\\"g-upload-here-button btn btn-sm btn-success\\\"><i class=\\\"icon-upload\\\"></i></button>\");\n}\nif ( (level >= AccessType.ADMIN))\n{\nbuf.push(\"<button title=\\\"Access control\\\" class=\\\"g-folder-access-button g-edit-access btn btn-sm btn-warning\\\"><i class=\\\"icon-lock\\\"></i></button>\");\n}\n}\nelse if ( (type === 'collection'))\n{\nbuf.push(\"<button title=\\\"Show collection info\\\" class=\\\"g-collection-info-button btn btn-sm btn-info\\\"><i class=\\\"icon-info\\\"></i></button>\");\nif ( (level >= AccessType.ADMIN))\n{\nbuf.push(\"<button title=\\\"Access control\\\" class=\\\"g-edit-access btn btn-sm btn-warning\\\"><i class=\\\"icon-lock\\\"></i></button>\");\n}\n}\nbuf.push(\"<div class=\\\"btn-group\\\"><button data-toggle=\\\"dropdown\\\"\" + (jade.attr(\"title\", \"\" + (girder.capitalize(type)) + \" actions\", true, true)) + \" placement=\\\"left\\\" class=\\\"g-folder-actions-button btn btn-sm btn-default dropdown-toggle\\\">\");\nif ( type === 'collection')\n{\nbuf.push(\"<i class=\\\"icon-sitemap\\\"></i>\");\n}\nelse if ( type === 'user')\n{\nbuf.push(\"<i class=\\\"icon-user\\\"></i>\");\n}\nelse if ( type === 'folder')\n{\nbuf.push(\"<i class=\\\"icon-folder-open\\\"></i>\");\n}\nbuf.push(\"<i class=\\\"icon-down-dir\\\"></i></button><ul role=\\\"menu\\\" class=\\\"g-folder-actions-menu dropdown-menu pull-right\\\"><li role=\\\"presentation\\\" class=\\\"dropdown-header\\\">\");\nif ( type === 'collection')\n{\nbuf.push(\"<i class=\\\"icon-sitemap\\\"></i>\");\n}\nelse if ( type === 'user')\n{\nbuf.push(\"<i class=\\\"icon-user\\\"></i>\");\n}\nelse if ( type === 'folder')\n{\nbuf.push(\"<i class=\\\"icon-folder-open\\\"></i>\");\n}\nbuf.push(\" \" + (jade.escape((jade_interp = model.name()) == null ? '' : jade_interp)) + \"</li>\");\nif ( type === 'folder' || type === 'collection')\n{\nbuf.push(\"<li role=\\\"presentation\\\"><a role=\\\"menuitem\\\"\" + (jade.attr(\"href\", model.downloadUrl(), true, true)) + \" class=\\\"g-download-folder\\\"><i class=\\\"icon-download\\\"></i>Download \" + (jade.escape((jade_interp = type) == null ? '' : jade_interp)) + \"</a></li>\");\n}\nif ( level >= AccessType.WRITE)\n{\nbuf.push(\"<li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-create-subfolder\\\"><i class=\\\"icon-folder\\\"></i>Create folder here</a></li>\");\nif ( type === 'folder' || type === 'collection')\n{\nif ( type === 'folder')\n{\nbuf.push(\"<li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-create-item\\\"><i class=\\\"icon-doc\\\"></i>Create item here</a></li>\");\n}\nbuf.push(\"<li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-edit-folder\\\"><i class=\\\"icon-edit\\\"></i>Edit \" + (jade.escape((jade_interp = type) == null ? '' : jade_interp)) + \"</a></li>\");\n}\n}\nif ( level >= AccessType.ADMIN && (type === 'folder' || type === 'collection'))\n{\nbuf.push(\"<li role=\\\"presentation\\\" class=\\\"divider\\\"></li><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-delete-folder\\\"><i class=\\\"icon-trash\\\"></i>Delete this \" + (jade.escape((jade_interp = type) == null ? '' : jade_interp)) + \"</a></li>\");\n}\nbuf.push(\"</ul></div></div><div class=\\\"g-clear-right\\\"></div></div>\");\n}\nbuf.push(\"<div class=\\\"g-folder-list-container\\\"></div><div class=\\\"g-item-list-container\\\"></div><div class=\\\"g-empty-parent-message g-info-message-container hide\\\"><i class=\\\"icon-info-circled\\\"></i> This folder is empty.</div></div><div class=\\\"g-folder-metadata\\\"></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"itemBreadcrumb\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),parentChain = locals_.parentChain;\nbuf.push(\"<ol class=\\\"breadcrumb\\\">\");\n// iterate parentChain\n;(function(){\n  var $$obj = parentChain;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var parent = $$obj[$index];\n\nbuf.push(\"<li><a\" + (jade.attr(\"data-id\", \"\" + (parent.object._id) + \"\", true, true)) + (jade.attr(\"data-type\", \"\" + (parent.type) + \"\", true, true)) + \" class=\\\"g-item-breadcrumb-link\\\">\");\nif ( (parent.type === \"user\"))\n{\nbuf.push(\"<i class=\\\"icon-user\\\"></i>\" + (jade.escape((jade_interp = parent.object.login) == null ? '' : jade_interp)) + \"\");\n}\nelse if ( (parent.type === \"collection\"))\n{\nbuf.push(\"<i class=\\\"icon-sitemap\\\"></i>\" + (jade.escape((jade_interp = parent.object.name) == null ? '' : jade_interp)) + \"\");\n}\nelse\n{\nbuf.push(\"\" + (jade.escape((jade_interp = parent.object.name) == null ? '' : jade_interp)) + \"\");\n}\nbuf.push(\"</a></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var parent = $$obj[$index];\n\nbuf.push(\"<li><a\" + (jade.attr(\"data-id\", \"\" + (parent.object._id) + \"\", true, true)) + (jade.attr(\"data-type\", \"\" + (parent.type) + \"\", true, true)) + \" class=\\\"g-item-breadcrumb-link\\\">\");\nif ( (parent.type === \"user\"))\n{\nbuf.push(\"<i class=\\\"icon-user\\\"></i>\" + (jade.escape((jade_interp = parent.object.login) == null ? '' : jade_interp)) + \"\");\n}\nelse if ( (parent.type === \"collection\"))\n{\nbuf.push(\"<i class=\\\"icon-sitemap\\\"></i>\" + (jade.escape((jade_interp = parent.object.name) == null ? '' : jade_interp)) + \"\");\n}\nelse\n{\nbuf.push(\"\" + (jade.escape((jade_interp = parent.object.name) == null ? '' : jade_interp)) + \"\");\n}\nbuf.push(\"</a></li>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"<div class=\\\"pull-right\\\"><a title=\\\"Go to parent folder\\\" class=\\\"g-hierarchy-level-up\\\"><i class=\\\"icon-level-up\\\"></i></a></div></ol>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"itemList\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),items = locals_.items,checkboxes = locals_.checkboxes,girder = locals_.girder,hasMore = locals_.hasMore;\nbuf.push(\"<ul class=\\\"g-item-list\\\">\");\n// iterate items\n;(function(){\n  var $$obj = items;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var item = $$obj[$index];\n\nbuf.push(\"<li class=\\\"g-item-list-entry\\\">\");\nif ( checkboxes)\n{\nbuf.push(\"<input type=\\\"checkbox\\\"\" + (jade.attr(\"g-item-cid\", \"\" + (item.cid) + \"\", true, true)) + \" class=\\\"g-list-checkbox\\\">\");\n}\nbuf.push(\"<a\" + (jade.attr(\"g-item-cid\", \"\" + (item.cid) + \"\", true, true)) + \" class=\\\"g-item-list-link g-right-border\\\"><i class=\\\"icon-doc-text-inv\\\"></i>\" + (jade.escape((jade_interp = item.get('name')) == null ? '' : jade_interp)) + \"</a><a title=\\\"Download item\\\"\" + (jade.attr(\"href\", item.downloadUrl(), true, true)) + \"><i class=\\\"icon-download\\\"></i></a><a title=\\\"View in browser\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\"\" + (jade.attr(\"href\", item.downloadUrl({contentDisposition: 'inline'}), true, true)) + \" class=\\\"g-view-inline\\\"><i class=\\\"icon-eye\\\"></i></a><div class=\\\"g-item-size\\\">\" + (jade.escape((jade_interp = girder.formatSize(item.get('size'))) == null ? '' : jade_interp)) + \"</div></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var item = $$obj[$index];\n\nbuf.push(\"<li class=\\\"g-item-list-entry\\\">\");\nif ( checkboxes)\n{\nbuf.push(\"<input type=\\\"checkbox\\\"\" + (jade.attr(\"g-item-cid\", \"\" + (item.cid) + \"\", true, true)) + \" class=\\\"g-list-checkbox\\\">\");\n}\nbuf.push(\"<a\" + (jade.attr(\"g-item-cid\", \"\" + (item.cid) + \"\", true, true)) + \" class=\\\"g-item-list-link g-right-border\\\"><i class=\\\"icon-doc-text-inv\\\"></i>\" + (jade.escape((jade_interp = item.get('name')) == null ? '' : jade_interp)) + \"</a><a title=\\\"Download item\\\"\" + (jade.attr(\"href\", item.downloadUrl(), true, true)) + \"><i class=\\\"icon-download\\\"></i></a><a title=\\\"View in browser\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\"\" + (jade.attr(\"href\", item.downloadUrl({contentDisposition: 'inline'}), true, true)) + \" class=\\\"g-view-inline\\\"><i class=\\\"icon-eye\\\"></i></a><div class=\\\"g-item-size\\\">\" + (jade.escape((jade_interp = girder.formatSize(item.get('size'))) == null ? '' : jade_interp)) + \"</div></li>\");\n    }\n\n  }\n}).call(this);\n\nif ( (hasMore))\n{\nbuf.push(\"<li class=\\\"g-show-more\\\"><a class=\\\"g-show-more-items\\\"><i class=\\\"icon-level-down\\\"></i>Show more items...</a></li>\");\n}\nbuf.push(\"</ul>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"jsonMetadatumEditWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),key = locals_.key,newDatum = locals_.newDatum;\nbuf.push(\"<input type=\\\"text\\\"\" + (jade.attr(\"value\", key, true, true)) + \" placeholder=\\\"Key\\\" class=\\\"input-sm form-control g-widget-metadata-key-input\\\"><div class=\\\"g-json-editor\\\"></div><button title=\\\"Cancel\\\" class=\\\"btn btn-sm btn-warning g-widget-metadata-cancel-button\\\"><i class=\\\"icon-cancel\\\"></i></button><button title=\\\"Accept\\\" class=\\\"btn btn-sm btn-primary g-widget-metadata-save-button\\\"><i class=\\\"icon-ok\\\"></i></button>\");\nif ( !newDatum)\n{\nbuf.push(\"<button title=\\\"Convert to Simple\\\" class=\\\"btn btn-sm btn-primary g-widget-metadata-toggle-button\\\"><i class=\\\"icon-cog\\\"></i></button><button title=\\\"Delete\\\" class=\\\"btn btn-sm btn-danger g-widget-metadata-delete-button\\\"><i class=\\\"icon-trash\\\"></i></button>\");\n};return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"jsonMetadatumView\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),accessLevel = locals_.accessLevel,girder = locals_.girder,key = locals_.key,value = locals_.value;\nif ( (accessLevel >= girder.AccessType.WRITE))\n{\nbuf.push(\"<button class=\\\"btn btn-sm btn-default g-widget-metadata-edit-button\\\"><i class=\\\"icon-pencil\\\"></i></button>\");\n}\nbuf.push(\"<span class=\\\"g-widget-metadata-key\\\">\" + (jade.escape((jade_interp = key) == null ? '' : jade_interp)) + \"</span><span class=\\\"g-widget-metadata-value\\\"><pre>\" + (jade.escape((jade_interp = value) == null ? '' : jade_interp)) + \"</pre></span>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"loadingAnimation\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<div id=\\\"g-loading-animation\\\"><div id=\\\"g-loading-block-1\\\" class=\\\"g-loading-block\\\"></div><div id=\\\"g-loading-block-2\\\" class=\\\"g-loading-block\\\"></div><div id=\\\"g-loading-block-3\\\" class=\\\"g-loading-block\\\"></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"markdownWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),prefix = locals_.prefix,enableUploads = locals_.enableUploads,placeholder = locals_.placeholder,text = locals_.text;\nbuf.push(\"<div class=\\\"g-markdown-widget\\\"><div class=\\\"g-tabs-container\\\"><div class=\\\"g-markdown-tabs-top\\\"><ul class=\\\"nav nav-tabs\\\"><li role=\\\"presentation\\\" class=\\\"first active\\\"><a\" + (jade.attr(\"data-target\", \"#\" + (prefix) + \"-write\", true, true)) + \" aria-controls=\\\"home\\\" role=\\\"tab\\\" data-toggle=\\\"tab\\\" class=\\\"g-write-link\\\">Write</a></li><li role=\\\"presentation\\\"><a\" + (jade.attr(\"data-target\", \"#\" + (prefix) + \"-preview\", true, true)) + \" aria-controls=\\\"preview\\\" role=\\\"tab\\\" data-toggle=\\\"tab\\\" class=\\\"g-preview-link\\\">Preview</a></li><div class=\\\"g-markdown-explanation\\\">Supports<a href=\\\"https://daringfireball.net/projects/markdown/syntax\\\" tabindex=\\\"-1\\\" target=\\\"_blank\\\"> Markdown</a></div></ul></div><div class=\\\"tab-content\\\"><div role=\\\"tabpanel\\\"\" + (jade.attr(\"id\", \"\" + (prefix) + \"-write\", true, true)) + \" class=\\\"tab-pane active\\\"><div class=\\\"g-markdown-drop-zone\\\"><textarea\" + (jade.attr(\"upload-enabled\", enableUploads ? \"true\" : null, true, true)) + (jade.attr(\"placeholder\", placeholder, true, true)) + \" class=\\\"form-control g-markdown-text\\\">\" + (jade.escape(null == (jade_interp = text) ? \"\" : jade_interp)) + \"</textarea>\");\nif ( enableUploads)\n{\nbuf.push(\"<div class=\\\"g-upload-overlay hide\\\"><div class=\\\"g-upload-progress-container\\\"><div class=\\\"g-markdown-upload-progress progress progress-striped\\\"><div role=\\\"progressbar\\\" class=\\\"progress-bar progress-bar-info\\\"></div></div><div class=\\\"g-markdown-upload-progress-message\\\">Starting upload...</div></div></div><div class=\\\"g-upload-footer\\\"><i class=\\\"icon-picture\\\"></i> Add an image by <a class=\\\"g-browse\\\">clicking here</a>, or drag\\nand drop one into the editor.</div><div class=\\\"hide\\\"><input type=\\\"file\\\" class=\\\"g-file-input\\\"></div>\");\n}\nbuf.push(\"</div></div><div role=\\\"tabpanel\\\"\" + (jade.attr(\"id\", \"\" + (prefix) + \"-preview\", true, true)) + \" class=\\\"tab-pane\\\"><div class=\\\"g-markdown-preview\\\"></div></div></div></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"metadataWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),accessLevel = locals_.accessLevel,girder = locals_.girder,title = locals_.title;\nif ( (accessLevel >= girder.AccessType.WRITE))\n{\nbuf.push(\"<div class=\\\"btn-group pull-right\\\"><button data-toggle=\\\"dropdown\\\" title=\\\"Add Metadata\\\" class=\\\"g-widget-metadata-add-button btn btn-sm btn-primary btn-default dropdown-toggle\\\"><i class=\\\"icon-plus\\\"></i></button><ul role=\\\"menu\\\" class=\\\"dropdown-menu pull-right\\\"><li role=\\\"presentation\\\"><a role=\\\"menuitem\\\" class=\\\"g-add-simple-metadata\\\">Simple</a></li><li role=\\\"presentation\\\"><a class=\\\"g-add-json-metadata\\\">JSON</a></li></ul></div>\");\n}\nbuf.push(\"<div class=\\\"g-widget-metadata-header\\\"><i class=\\\"icon-tags\\\"></i> \" + (jade.escape((jade_interp = title) == null ? '' : jade_interp)) + \"</div><div class=\\\"g-widget-metadata-container\\\"></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"metadatumEditWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),key = locals_.key,value = locals_.value,newDatum = locals_.newDatum;\nbuf.push(\"<input type=\\\"text\\\"\" + (jade.attr(\"value\", key, true, true)) + \" placeholder=\\\"Key\\\" class=\\\"input-sm form-control g-widget-metadata-key-input\\\">\");\nvar rows = value.length <= 40 ? 1 : (value.length <= 100 ? 3 : 5)\nbuf.push(\"<textarea placeholder=\\\"Value\\\"\" + (jade.attr(\"rows\", rows, true, true)) + \" class=\\\"input-sm form-control g-widget-metadata-value-input\\\">\" + (jade.escape(null == (jade_interp = value) ? \"\" : jade_interp)) + \"</textarea><button title=\\\"Cancel\\\" class=\\\"btn btn-sm btn-warning g-widget-metadata-cancel-button\\\"><i class=\\\"icon-cancel\\\"></i></button><button title=\\\"Accept\\\" class=\\\"btn btn-sm btn-primary g-widget-metadata-save-button\\\"><i class=\\\"icon-ok\\\"></i></button>\");\nif ( !newDatum)\n{\nbuf.push(\"<button title=\\\"Convert to JSON\\\" class=\\\"btn btn-sm btn-primary g-widget-metadata-toggle-button\\\"><i class=\\\"icon-cog\\\"></i></button><button title=\\\"Delete\\\" class=\\\"btn btn-sm btn-danger g-widget-metadata-delete-button\\\"><i class=\\\"icon-trash\\\"></i></button>\");\n};return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"metadatumView\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),accessLevel = locals_.accessLevel,girder = locals_.girder,key = locals_.key,value = locals_.value;\nif ( (accessLevel >= girder.AccessType.WRITE))\n{\nbuf.push(\"<button class=\\\"btn btn-sm btn-default g-widget-metadata-edit-button\\\"><i class=\\\"icon-pencil\\\"></i></button>\");\n}\nbuf.push(\"<span class=\\\"g-widget-metadata-key\\\">\" + (jade.escape((jade_interp = key) == null ? '' : jade_interp)) + \"</span><span class=\\\"g-widget-metadata-value\\\">\" + (jade.escape((jade_interp = value) == null ? '' : jade_interp)) + \"</span>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"newAssetstore\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\nbuf.push(\"<div id=\\\"g-assetstore-accordion\\\" class=\\\"panel-group\\\"><div class=\\\"panel panel-default\\\"><div data-toggle=\\\"collapse\\\" data-parent=\\\"#g-assetstore-accordion\\\" data-target=\\\"#g-create-fs-tab\\\" class=\\\"panel-heading\\\"><div class=\\\"panel-title\\\"><a><i class=\\\"icon-hdd\\\"></i><span>Create new <b>Filesystem</b> assetstore</span></a></div></div><div id=\\\"g-create-fs-tab\\\" class=\\\"panel-collapse collapse\\\"><div class=\\\"panel-body\\\"><p>This type of assetstore will store files in a directory on the\\nlocal filesystem, using content-addressed storage to ensure that\\ndata is never duplicated on disk. Just specify the root directory\\nthat files will be stored under.</p><p>If the specified root directory does not already exist, the server\\nwill attempt to create it.</p><form id=\\\"g-new-fs-form\\\" role=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"g-new-fs-name\\\" class=\\\"control-label\\\">Assetstore name</label><input id=\\\"g-new-fs-name\\\" type=\\\"text\\\" placeholder=\\\"Name\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-new-fs-root\\\" class=\\\"control-label\\\">Root directory</label><input id=\\\"g-new-fs-root\\\" type=\\\"text\\\" placeholder=\\\"Root directory\\\" class=\\\"input-sm form-control\\\"></div><p id=\\\"g-new-fs-error\\\" class=\\\"g-validation-failed-message\\\"></p><input type=\\\"submit\\\" value=\\\"Create\\\" class=\\\"g-new-assetstore-submit btn btn-sm btn-primary\\\"></form></div></div></div><div class=\\\"panel panel-default\\\"><div data-toggle=\\\"collapse\\\" data-parent=\\\"#g-assetstore-accordion\\\" data-target=\\\"#g-create-gridfs-tab\\\" class=\\\"panel-heading\\\"><div class=\\\"panel-title\\\"><a><i class=\\\"icon-leaf\\\"></i><span>Create new <b>GridFS</b> assetstore</span></a></div></div><div id=\\\"g-create-gridfs-tab\\\" class=\\\"panel-collapse collapse\\\"><div class=\\\"panel-body\\\"><p>This type of assetstore uses\\nMongoDB's <a target=\\\"_blank\\\" href=\\\"http://docs.mongodb.org/manual/core/gridfs/\\\">GridFS</a>\\nstorage engine. The files should be stored in a separate database\\nfrom the rest of the server's information to avoid locking issues.</p><form id=\\\"g-new-gridfs-form\\\" role=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"g-new-gridfs-name\\\" class=\\\"control-label\\\">Assetstore name</label><input id=\\\"g-new-gridfs-name\\\" type=\\\"text\\\" placeholder=\\\"Name\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-new-gridfs-db\\\" class=\\\"control-label\\\">Database name</label><input id=\\\"g-new-gridfs-db\\\" type=\\\"text\\\" placeholder=\\\"Database name\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-new-gridfs-mongohost\\\" class=\\\"control-label\\\">Mongo Host URI</label><input id=\\\"g-new-gridfs-mongohost\\\" type=\\\"text\\\" placeholder=\\\"Mongo host uri (defaults to the main Girder database)\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-new-gridfs-replicaset\\\" class=\\\"control-label\\\">Replica Set</label><input id=\\\"g-new-gridfs-replicaset\\\" type=\\\"text\\\" placeholder=\\\"Replica set name (blank if not using a replica set)\\\" class=\\\"input-sm form-control\\\"></div><p id=\\\"g-new-gridfs-error\\\" class=\\\"g-validation-failed-message\\\"></p><input type=\\\"submit\\\" value=\\\"Create\\\" class=\\\"g-new-assetstore-submit btn btn-sm btn-primary\\\"></form></div></div></div><div class=\\\"panel panel-default\\\"><div data-toggle=\\\"collapse\\\" data-parent=\\\"#g-assetstore-accordion\\\" data-target=\\\"#g-create-s3-tab\\\" class=\\\"panel-heading\\\"><div class=\\\"panel-title\\\"><a><i class=\\\"icon-upload-cloud\\\"></i><span>Create new <b>Amazon S3</b> assetstore</span></a></div></div><div id=\\\"g-create-s3-tab\\\" class=\\\"panel-collapse collapse\\\"><div class=\\\"panel-body\\\"><p>This type of assetstore keeps files in\\nan <a target=\\\"_blank\\\" href=\\\"http://aws.amazon.com/s3/\\\">Amazon S3</a>\\nbucket. The service defaults to s3.amazonaws.com. You can specify an\\nalternate service, including an optional protocol and port using the\\nform [http[s]://](service domain)[:(port)].</p><form id=\\\"g-new-s3-form\\\" role=\\\"form\\\"><div class=\\\"form-group\\\"><label for=\\\"g-new-s3-name\\\" class=\\\"control-label\\\">Assetstore name</label><input id=\\\"g-new-s3-name\\\" type=\\\"text\\\" placeholder=\\\"Name\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-new-s3-bucket\\\" class=\\\"control-label\\\">S3 bucket name</label><input id=\\\"g-new-s3-bucket\\\" type=\\\"text\\\" placeholder=\\\"Bucket\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-new-s3-prefix\\\" class=\\\"control-label\\\">Path prefix (optional)</label><input id=\\\"g-new-s3-prefix\\\" type=\\\"text\\\" placeholder=\\\"Prefix\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-new-s3-access-key-id\\\" class=\\\"control-label\\\">Access key ID</label><input id=\\\"g-new-s3-access-key-id\\\" type=\\\"text\\\" placeholder=\\\"Access key ID\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-new-s3-secret\\\" class=\\\"control-label\\\">Secret access key</label><input id=\\\"g-new-s3-secret\\\" type=\\\"text\\\" placeholder=\\\"Secret access key\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"form-group\\\"><label for=\\\"g-new-s3-service\\\" class=\\\"control-label\\\">Service</label><input id=\\\"g-new-s3-service\\\" type=\\\"text\\\" placeholder=\\\"Service name\\\" class=\\\"input-sm form-control\\\"></div><div class=\\\"checkbox\\\"><label><input id=\\\"g-new-s3-readonly\\\" type=\\\"checkbox\\\">Read only</label></div><p id=\\\"g-new-s3-error\\\" class=\\\"g-validation-failed-message\\\"></p><input type=\\\"submit\\\" value=\\\"Create\\\" class=\\\"g-new-assetstore-submit btn btn-sm btn-primary\\\"></form></div></div></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"paginateWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),collection = locals_.collection;\nbuf.push(\"<ul class=\\\"pagination pagination-sm\\\"><li class=\\\"g-page-prev disabled\\\"><a>&laquo; Prev</a></li><li class=\\\"active\\\"><a class=\\\"g-page-number\\\">Page \" + (jade.escape((jade_interp = collection.pageNum() + 1) == null ? '' : jade_interp)) + \"</a></li><li class=\\\"g-page-next disabled\\\"><a>Next &raquo;</a></li></ul>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"pluginConfigBreadcrumb\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),pluginName = locals_.pluginName;\nbuf.push(\"<div class=\\\"g-plugin-config-breadcrumbs\\\"><ol class=\\\"breadcrumb\\\"><li><a class=\\\"g-admin-console-link\\\"><i class=\\\"icon-wrench\\\"></i>Admin console</a></li><li><a class=\\\"g-plugins-link\\\"><i class=\\\"icon-puzzle\\\"></i>Plugins</a></li><li class=\\\"active\\\"><i class=\\\"icon-cog\\\"></i>\" + (jade.escape((jade_interp = pluginName) == null ? '' : jade_interp)) + \"</li></ol></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"rootSelectorWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),selected = locals_.selected,display = locals_.display,home = locals_.home,groups = locals_.groups,format = locals_.format;\nselected = selected || {id: ''};\nbuf.push(\"<select id=\\\"g-root-selector\\\" required class=\\\"form-control\\\">\");\nif ( !selected.id)\n{\nbuf.push(\"<option value=\\\"\\\" disabled selected hidden>Select a root...</option>\");\n}\n// iterate display\n;(function(){\n  var $$obj = display;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var groupName = $$obj[$index];\n\nif ( groupName === 'Home' && home)\n{\nbuf.push(\"<option\" + (jade.attr(\"value\", home.id, true, true)) + (jade.attr(\"selected\", selected.id === home.id, true, true)) + \">Home</option>\");\n}\nelse if ( groupName in groups)\n{\nvar group = groups[groupName];\nbuf.push(\"<optgroup\" + (jade.attr(\"label\", groupName, true, true)) + \">\");\n// iterate group.models\n;(function(){\n  var $$obj = group.models;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var model = $$obj[$index];\n\nif ( !home || model.id !== home.id)\n{\nbuf.push(\"<option\" + (jade.attr(\"value\", model.id, true, true)) + (jade.attr(\"data-group\", groupName, true, true)) + (jade.attr(\"selected\", model.id === selected.id, true, true)) + \">\" + (jade.escape((jade_interp = format(model)) == null ? '' : jade_interp)) + \"</option>\");\n}\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var model = $$obj[$index];\n\nif ( !home || model.id !== home.id)\n{\nbuf.push(\"<option\" + (jade.attr(\"value\", model.id, true, true)) + (jade.attr(\"data-group\", groupName, true, true)) + (jade.attr(\"selected\", model.id === selected.id, true, true)) + \">\" + (jade.escape((jade_interp = format(model)) == null ? '' : jade_interp)) + \"</option>\");\n}\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</optgroup>\");\n}\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var groupName = $$obj[$index];\n\nif ( groupName === 'Home' && home)\n{\nbuf.push(\"<option\" + (jade.attr(\"value\", home.id, true, true)) + (jade.attr(\"selected\", selected.id === home.id, true, true)) + \">Home</option>\");\n}\nelse if ( groupName in groups)\n{\nvar group = groups[groupName];\nbuf.push(\"<optgroup\" + (jade.attr(\"label\", groupName, true, true)) + \">\");\n// iterate group.models\n;(function(){\n  var $$obj = group.models;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var model = $$obj[$index];\n\nif ( !home || model.id !== home.id)\n{\nbuf.push(\"<option\" + (jade.attr(\"value\", model.id, true, true)) + (jade.attr(\"data-group\", groupName, true, true)) + (jade.attr(\"selected\", model.id === selected.id, true, true)) + \">\" + (jade.escape((jade_interp = format(model)) == null ? '' : jade_interp)) + \"</option>\");\n}\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var model = $$obj[$index];\n\nif ( !home || model.id !== home.id)\n{\nbuf.push(\"<option\" + (jade.attr(\"value\", model.id, true, true)) + (jade.attr(\"data-group\", groupName, true, true)) + (jade.attr(\"selected\", model.id === selected.id, true, true)) + \">\" + (jade.escape((jade_interp = format(model)) == null ? '' : jade_interp)) + \"</option>\");\n}\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</optgroup>\");\n}\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</select>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"searchField\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),placeholder = locals_.placeholder,modes = locals_.modes;\nbuf.push(\"<div class=\\\"g-search-wrapper\\\"><a title=\\\"Show search help\\\" class=\\\"g-search-options-button btn btn-sm\\\"><i class=\\\"icon-search\\\"></i></a><input type=\\\"text\\\"\" + (jade.attr(\"placeholder\", placeholder, true, true)) + (jade.attr(\"mode-select\", (modes.length > 1 ? \"on\" : \"off\"), true, true)) + \" class=\\\"g-search-field form-control input-sm\\\"><div class=\\\"g-search-results dropdown\\\"><ul role=\\\"menu\\\" class=\\\"dropdown-menu\\\"></ul></div>\");\nif ( modes.length > 1)\n{\nbuf.push(\"<a title=\\\"Search mode\\\" class=\\\"g-search-mode-choose btn btn-sm\\\"><i class=\\\"icon-down-dir\\\"></i></a>\");\n}\nbuf.push(\"</div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"searchHelp\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),mode = locals_.mode;\nif ( mode === 'prefix')\n{\nbuf.push(\"<div class=\\\"g-search-help-text\\\">You are searching by prefix. Start typing the first letters of whatever you\\nare searching for.</div>\");\n}\nelse if ( mode === 'text')\n{\nbuf.push(\"<p class=\\\"g-search-help-text\\\">By default, search results will be returned if they contain any of the terms\\nof the search. If you wish to search for documents containing all of the\\nterms, place them in quotes. Examples:\\n</p><ul class=\\\"g-search-examples-list\\\"><li><code>cat dog</code> returns documents containing either \\\"cat\\\" or \\\"dog\\\".</li><li><code>\\\"cat\\\" \\\"dog\\\"</code> returns documents containing both \\\"cat\\\" and \\\"dog\\\".</li><li><code>\\\"cat dog\\\"</code> returns documents containing the phrase \\\"cat dog\\\".</li></ul>\");\n};return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"searchModeSelect\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),modes = locals_.modes,currentMode = locals_.currentMode,undefined = locals_.undefined;\nbuf.push(\"<p>Choose search mode:</p>\");\n// iterate modes\n;(function(){\n  var $$obj = modes;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var mode = $$obj[$index];\n\nbuf.push(\"<div class=\\\"radio\\\"><label><input type=\\\"radio\\\" name=\\\"search-mode\\\"\" + (jade.attr(\"value\", mode, true, true)) + (jade.attr(\"checked\", (mode === currentMode ? 'checked' : undefined), true, true)) + \" class=\\\"g-search-mode-radio\\\">\");\nif ( mode === 'prefix')\n{\nbuf.push(\" Search by prefix\");\n}\nelse if ( mode === 'text')\n{\nbuf.push(\" Full text search\");\n}\nbuf.push(\"</label></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var mode = $$obj[$index];\n\nbuf.push(\"<div class=\\\"radio\\\"><label><input type=\\\"radio\\\" name=\\\"search-mode\\\"\" + (jade.attr(\"value\", mode, true, true)) + (jade.attr(\"checked\", (mode === currentMode ? 'checked' : undefined), true, true)) + \" class=\\\"g-search-mode-radio\\\">\");\nif ( mode === 'prefix')\n{\nbuf.push(\" Search by prefix\");\n}\nelse if ( mode === 'text')\n{\nbuf.push(\" Full text search\");\n}\nbuf.push(\"</label></div>\");\n    }\n\n  }\n}).call(this);\n;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"searchResults\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),results = locals_.results;\n// iterate results\n;(function(){\n  var $$obj = results;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var result = $$obj[$index];\n\nbuf.push(\"<li role=\\\"presentation\\\" class=\\\"g-search-result\\\"><a\" + (jade.attr(\"resourceid\", \"\" + (result.id) + \"\", true, true)) + (jade.attr(\"resourcetype\", \"\" + (result.type) + \"\", true, true)) + (jade.attr(\"g-icon\", \"\" + (result.icon) + \"\", true, true)) + \" role=\\\"menuitem\\\" tabindex=\\\"-1\\\"><i\" + (jade.cls([\"icon-\" + (result.icon) + \"\"], [true])) + \"></i> \" + (jade.escape((jade_interp = result.text) == null ? '' : jade_interp)) + \"</a></li>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var result = $$obj[$index];\n\nbuf.push(\"<li role=\\\"presentation\\\" class=\\\"g-search-result\\\"><a\" + (jade.attr(\"resourceid\", \"\" + (result.id) + \"\", true, true)) + (jade.attr(\"resourcetype\", \"\" + (result.type) + \"\", true, true)) + (jade.attr(\"g-icon\", \"\" + (result.icon) + \"\", true, true)) + \" role=\\\"menuitem\\\" tabindex=\\\"-1\\\"><i\" + (jade.cls([\"icon-\" + (result.icon) + \"\"], [true])) + \"></i> \" + (jade.escape((jade_interp = result.text) == null ? '' : jade_interp)) + \"</a></li>\");\n    }\n\n  }\n}).call(this);\n\nif ( results.length === 0)\n{\nbuf.push(\"<li role=\\\"presentation\\\" class=\\\"g-no-search-results disabled\\\"><a role=\\\"menuitem\\\" tabindex=\\\"-1\\\"><i class=\\\"icon-block\\\"></i> No results found</a></li>\");\n};return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"taskProgress\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),progressClass = locals_.progressClass,width = locals_.width,barClass = locals_.barClass,percentText = locals_.percentText,timeLeftText = locals_.timeLeftText,progress = locals_.progress;\nbuf.push(\"<div class=\\\"g-task-progress-top\\\"><div\" + (jade.cls(['g-task-progress-bar','progress',\"\" + (progressClass) + \"\"], [null,null,true])) + \"><div\" + (jade.attr(\"style\", \"width: \" + (width) + \";\", true, true)) + (jade.cls(['progress-bar',\"\" + (barClass) + \"\"], [null,true])) + \"><div class=\\\"progress-status\\\"><div class=\\\"progress-percent\\\">\" + (jade.escape((jade_interp = percentText) == null ? '' : jade_interp)) + \"</div><div class=\\\"progress-left\\\">\" + (jade.escape((jade_interp = timeLeftText) == null ? '' : jade_interp)) + \"</div></div></div></div><div\" + (jade.attr(\"title\", \"\" + (progress.data.title) + \"\", true, true)) + \" class=\\\"g-task-progress-title\\\">\" + (jade.escape(null == (jade_interp = progress.data.title) ? \"\" : jade_interp)) + \"</div></div><div class=\\\"g-task-progress-bottom\\\"><div class=\\\"g-task-progress-message\\\">\" + (jade.escape(null == (jade_interp = progress.data.message) ? \"\" : jade_interp)) + \"</div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"timeline\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),segments = locals_.segments,points = locals_.points,startLabel = locals_.startLabel,undefined = locals_.undefined,endLabel = locals_.endLabel;\nbuf.push(\"<div class=\\\"g-timeline-widget-wrapper\\\"><div class=\\\"g-timeline-container\\\">\");\n// iterate segments\n;(function(){\n  var $$obj = segments;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var segment = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attr(\"title\", segment.tooltip, true, true)) + (jade.attr(\"style\", \"left: \" + (segment.left) + \"; width: \" + (segment.width) + \";\", true, true)) + (jade.cls(['g-timeline-segment',segment.class], [null,true])) + \"></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var segment = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attr(\"title\", segment.tooltip, true, true)) + (jade.attr(\"style\", \"left: \" + (segment.left) + \"; width: \" + (segment.width) + \";\", true, true)) + (jade.cls(['g-timeline-segment',segment.class], [null,true])) + \"></div>\");\n    }\n\n  }\n}).call(this);\n\n// iterate points\n;(function(){\n  var $$obj = points;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attr(\"title\", point.tooltip, true, true)) + (jade.attr(\"style\", \"left: calc(\" + (point.left) + \" - 10px);\", true, true)) + (jade.cls(['g-timeline-point',point.class], [null,true])) + \"></div>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var point = $$obj[$index];\n\nbuf.push(\"<div\" + (jade.attr(\"title\", point.tooltip, true, true)) + (jade.attr(\"style\", \"left: calc(\" + (point.left) + \" - 10px);\", true, true)) + (jade.cls(['g-timeline-point',point.class], [null,true])) + \"></div>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div>\");\nif ( startLabel !== undefined || endLabel !== undefined)\n{\nbuf.push(\"<div class=\\\"g-timeline-labels-container\\\">\");\nif ( startLabel !== undefined)\n{\nbuf.push(\"<div class=\\\"g-timeline-start-label\\\">\" + (jade.escape(null == (jade_interp = startLabel) ? \"\" : jade_interp)) + \"</div>\");\n}\nif ( endLabel !== undefined)\n{\nbuf.push(\"<div class=\\\"g-timeline-end-label\\\">\" + (jade.escape(null == (jade_interp = endLabel) ? \"\" : jade_interp)) + \"</div>\");\n}\nbuf.push(\"</div>\");\n}\nbuf.push(\"</div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"uploadWidget\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),parent = locals_.parent,parentType = locals_.parentType,title = locals_.title;\njade_mixins[\"g-upload-widget-subtitle\"] = function(){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nif ( parent && parentType)\n{\nbuf.push(\"<div class=\\\"g-dialog-subtitle\\\">\");\nif ( (parentType === 'folder'))\n{\nbuf.push(\"<i class=\\\"icon-folder-open\\\"></i>\");\n}\nelse if ( (parentType === 'item'))\n{\nbuf.push(\"<i class=\\\"icon-doc-text-inv\\\"></i>\");\n}\nelse if ( (parentType === 'file'))\n{\nbuf.push(\"<i class=\\\"icon-doc-inv\\\"></i>\");\n}\nbuf.push(\"\" + (jade.escape((jade_interp = parent.name()) == null ? '' : jade_interp)) + \"</div>\");\n}\n};\njade_mixins[\"g-upload-widget-browse-or-drop\"] = function(){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<div class=\\\"g-drop-zone\\\"><i class=\\\"icon-docs\\\"></i>\");\nif ( (parentType === 'file'))\n{\nbuf.push(\" Browse or drop a file here\");\n}\nelse\n{\nbuf.push(\" Browse or drop files here\");\n}\nbuf.push(\"</div><div class=\\\"form-group hide\\\">\");\nif ( (parentType === 'file'))\n{\nbuf.push(\"<input id=\\\"g-files\\\" type=\\\"file\\\">\");\n}\nelse\n{\nbuf.push(\"<input id=\\\"g-files\\\" type=\\\"file\\\" multiple>\");\n}\nbuf.push(\"</div>\");\n};\njade_mixins[\"g-upload-widget-progress\"] = function(){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<div class=\\\"g-current-progress-message\\\"></div><div class=\\\"g-progress-current progress progress-striped hide\\\"><div role=\\\"progressbar\\\" class=\\\"progress-bar progress-bar-info\\\"></div></div><div class=\\\"g-overall-progress-message\\\">No files selected</div><div class=\\\"g-progress-overall progress progress-striped hide\\\"><div role=\\\"progressbar\\\" class=\\\"progress-bar progress-bar-info\\\"></div></div><div class=\\\"g-upload-error-message g-validation-failed-message\\\"></div>\");\n};\njade_mixins[\"g-upload-widget-start-button\"] = function(){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<button type=\\\"submit\\\" class=\\\"g-start-upload btn btn-small btn-primary disabled\\\"><i class=\\\"icon-upload\\\"></i> Start Upload</button>\");\n};\nbuf.push(\"<div class=\\\"modal-dialog\\\"><div class=\\\"modal-content\\\"><form id=\\\"g-upload-form\\\" role=\\\"form\\\" class=\\\"modal-form\\\"><div class=\\\"modal-header\\\"><button data-dismiss=\\\"modal\\\" aria-hidden=\\\"true\\\" type=\\\"button\\\" class=\\\"close\\\">&times;</button><h4 class=\\\"modal-title\\\">\" + (jade.escape(null == (jade_interp = title) ? \"\" : jade_interp)) + \"</h4>\");\njade_mixins[\"g-upload-widget-subtitle\"]();\nbuf.push(\"</div><div class=\\\"modal-body\\\">\");\njade_mixins[\"g-upload-widget-browse-or-drop\"]();\njade_mixins[\"g-upload-widget-progress\"]();\nbuf.push(\"</div><div class=\\\"modal-footer\\\"><a data-dismiss=\\\"modal\\\" class=\\\"btn btn-small btn-default\\\">Close</a>\");\njade_mixins[\"g-upload-widget-start-button\"]();\nbuf.push(\"</div></form></div></div>\");;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"uploadWidgetMixins\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n;return buf.join(\"\");\n};\n\nthis[\"girder\"][\"templates\"][\"uploadWidgetNonModal\"] = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar jade_interp;\nvar locals_ = (locals || {}),parent = locals_.parent,parentType = locals_.parentType,title = locals_.title;\njade_mixins[\"g-upload-widget-subtitle\"] = function(){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nif ( parent && parentType)\n{\nbuf.push(\"<div class=\\\"g-dialog-subtitle\\\">\");\nif ( (parentType === 'folder'))\n{\nbuf.push(\"<i class=\\\"icon-folder-open\\\"></i>\");\n}\nelse if ( (parentType === 'item'))\n{\nbuf.push(\"<i class=\\\"icon-doc-text-inv\\\"></i>\");\n}\nelse if ( (parentType === 'file'))\n{\nbuf.push(\"<i class=\\\"icon-doc-inv\\\"></i>\");\n}\nbuf.push(\"\" + (jade.escape((jade_interp = parent.name()) == null ? '' : jade_interp)) + \"</div>\");\n}\n};\njade_mixins[\"g-upload-widget-browse-or-drop\"] = function(){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<div class=\\\"g-drop-zone\\\"><i class=\\\"icon-docs\\\"></i>\");\nif ( (parentType === 'file'))\n{\nbuf.push(\" Browse or drop a file here\");\n}\nelse\n{\nbuf.push(\" Browse or drop files here\");\n}\nbuf.push(\"</div><div class=\\\"form-group hide\\\">\");\nif ( (parentType === 'file'))\n{\nbuf.push(\"<input id=\\\"g-files\\\" type=\\\"file\\\">\");\n}\nelse\n{\nbuf.push(\"<input id=\\\"g-files\\\" type=\\\"file\\\" multiple>\");\n}\nbuf.push(\"</div>\");\n};\njade_mixins[\"g-upload-widget-progress\"] = function(){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<div class=\\\"g-current-progress-message\\\"></div><div class=\\\"g-progress-current progress progress-striped hide\\\"><div role=\\\"progressbar\\\" class=\\\"progress-bar progress-bar-info\\\"></div></div><div class=\\\"g-overall-progress-message\\\">No files selected</div><div class=\\\"g-progress-overall progress progress-striped hide\\\"><div role=\\\"progressbar\\\" class=\\\"progress-bar progress-bar-info\\\"></div></div><div class=\\\"g-upload-error-message g-validation-failed-message\\\"></div>\");\n};\njade_mixins[\"g-upload-widget-start-button\"] = function(){\nvar block = (this && this.block), attributes = (this && this.attributes) || {};\nbuf.push(\"<button type=\\\"submit\\\" class=\\\"g-start-upload btn btn-small btn-primary disabled\\\"><i class=\\\"icon-upload\\\"></i> Start Upload</button>\");\n};\nbuf.push(\"<form id=\\\"g-upload-form\\\">\");\nif ( title)\n{\nbuf.push(\"<h4>\" + (jade.escape(null == (jade_interp = title) ? \"\" : jade_interp)) + \"</h4>\");\n}\njade_mixins[\"g-upload-widget-subtitle\"]();\njade_mixins[\"g-upload-widget-browse-or-drop\"]();\njade_mixins[\"g-upload-widget-progress\"]();\nbuf.push(\"<div class=\\\"g-nonmodal-upload-buttons-container\\\">\");\njade_mixins[\"g-upload-widget-start-button\"]();\nbuf.push(\"</div></form>\");;return buf.join(\"\");\n};","/*eslint-disable */\ngirder.versionInfo = \n{\n  \"git\": true,\n  \"SHA\": \"9e5c9358120ed38273783d35669851b21fa29b92\",\n  \"shortSHA\": \"9e5c935\",\n  \"date\": \"2017-09-07T17:01:26\",\n  \"apiVersion\": \"1.7.0\"\n}\n;\n/*eslint-enable */\n","girder.View = Backbone.View.extend({\n    constructor: function (opts) { // eslint-disable-line backbone/no-constructor\n        if (opts && _.has(opts, 'parentView')) {\n            if (opts.parentView) {\n                opts.parentView.registerChildView(this);\n                this.parentView = opts.parentView;\n            }\n        } else {\n            console.error('View created with no parentView property set. ' +\n                          'This view may not be garbage collected.');\n        }\n        Backbone.View.prototype.constructor.apply(this, arguments);\n    },\n\n    /**\n     * Remove a view, unbinding its events and removing its listeners on\n     * girder.events so that it can be garbage collected.\n     */\n    destroy: function () {\n        _.each(this._childViews, function (child) {\n            child.destroy();\n        });\n        this._childViews = null;\n\n        this.undelegateEvents();\n        this.stopListening();\n        this.off();\n        girder.events.off(null, null, this);\n        girder.eventStream.off(null, null, this);\n\n        if (this.parentView) {\n            this.parentView.unregisterChildView(this);\n        }\n\n        // Modal views need special cleanup.\n        if (this.$el.is('.modal')) {\n            var el = this.$el;\n            if (el.data('bs.modal') && el.data('bs.modal').isShown) {\n                el.on('hidden.bs.modal', function () {\n                    el.empty().off().removeData();\n                }).modal('hide');\n                el.modal('removeBackdrop');\n            } else {\n                el.modal('hideModal');\n                el.modal('removeBackdrop');\n                el.empty().off().removeData();\n            }\n        } else {\n            this.$el.empty().off().removeData();\n        }\n    },\n\n    /**\n     * It's typically not necessary to call this directly. Instead, instantiate\n     * child views with the \"parentView\" field.\n     */\n    registerChildView: function (child) {\n        this._childViews = this._childViews || [];\n        this._childViews.push(child);\n    },\n\n    /**\n     * Typically, you will not need to call this method directly. Calling\n     * destroy on a child element will automatically unregister it from its\n     * parent view if the parent view was specified.\n     */\n    unregisterChildView: function (child) {\n        this._childViews = _.without(this._childViews, child);\n    }\n});\n","girder.App = girder.View.extend({\n    /**\n     * @param {object} [settings]\n     * @param {bool} [settings.start=true] Run start after initialization\n     */\n    initialize: function (settings) {\n        this._started = false;\n        settings = settings || {};\n        if (settings.start === undefined || settings.start) {\n            this.start();\n        }\n    },\n\n    /**\n     * Start the application with optional components.\n     * @param {object} [settings]\n     * @param {bool} [settings.fetch=true] Fetch the current user modal\n     * @param {bool} [settings.render=true] Render the layout after starting\n     * @param {bool} [settings.history=true] Start backbone's history api\n     * @returns {$.Deferred} A promise-like object that resolves when the app is ready\n     */\n    start: function (settings) {\n        // start is a noop if the app is already running\n        var promise = new $.Deferred().resolve(null).promise();\n        if (this._started) {\n            return promise;\n        }\n        this._started = true;\n\n        // set defaults\n        settings = _.defaults(settings || {}, {\n            fetch: true,\n            render: true,\n            history: true\n        });\n\n        // define a function to be run after fetching the user model\n        var afterFetch = _.bind(function (user) {\n            girder.eventStream = new girder.EventStream({\n                timeout: girder.sseTimeout || null\n            });\n\n            this._createLayout();\n\n            if (user) {\n                girder.currentUser = new girder.models.UserModel(user);\n                girder.eventStream.open();\n            }\n\n            if (settings.render) {\n                this.render();\n            }\n\n            if (settings.history) {\n                Backbone.history.start({\n                    pushState: false\n                });\n            }\n        }, this);\n\n        // If fetching the user from the server then we return the jqxhr object\n        // from the request, otherwise just call the callback.\n        if (settings.fetch) {\n            promise = girder.fetchCurrentUser()\n                .done(afterFetch);\n        } else {\n            afterFetch(null);\n        }\n\n        this.bindGirderEvents();\n        return promise;\n    },\n\n    /**\n     * Bind the application to the global event object.\n     */\n    bindGirderEvents: function () {\n        // Unbind any current handlers in case this happens to be called twice.\n        girder.events.off(null, null, this);\n\n        girder.events.on('g:navigateTo', this.navigateTo, this);\n        girder.events.on('g:loginUi', this.loginDialog, this);\n        girder.events.on('g:registerUi', this.registerDialog, this);\n        girder.events.on('g:resetPasswordUi', this.resetPasswordDialog, this);\n        girder.events.on('g:alert', this.alert, this);\n        girder.events.on('g:login', this.login, this);\n    },\n\n    /**\n     * Create the main layout views.\n     * @private\n     */\n    _createLayout: function () {\n        this.headerView = new girder.views.LayoutHeaderView({\n            parentView: this\n        });\n\n        this.globalNavView = new girder.views.LayoutGlobalNavView({\n            parentView: this\n        });\n\n        this.footerView = new girder.views.LayoutFooterView({\n            parentView: this\n        });\n\n        this.progressListView = new girder.views.ProgressListView({\n            eventStream: girder.eventStream,\n            parentView: this\n        });\n\n        this.layoutRenderMap = {};\n        this.layoutRenderMap[girder.Layout.DEFAULT] = this._defaultLayout;\n        this.layoutRenderMap[girder.Layout.EMPTY] = this._emptyLayout;\n    },\n\n    _defaultLayout: {\n        show: function () {\n            this.$('#g-app-header-container,#g-global-nav-container,#g-app-footer-container').show();\n            this.$('#g-app-body-container').addClass('g-default-layout');\n        },\n\n        hide: function () {\n            this.$('#g-app-header-container,#g-global-nav-container,#g-app-footer-container').hide();\n            this.$('#g-app-body-container').removeClass('g-default-layout');\n        }\n    },\n\n    _emptyLayout: {\n        show: function () {\n            this.$('#g-app-body-container').addClass('g-empty-layout');\n        },\n\n        hide: function () {\n            this.$('#g-app-body-container').removeClass('g-empty-layout');\n        }\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.layout());\n\n        this.globalNavView.setElement(this.$('#g-global-nav-container')).render();\n        this.headerView.setElement(this.$('#g-app-header-container')).render();\n        this.footerView.setElement(this.$('#g-app-footer-container')).render();\n        this.progressListView.setElement(this.$('#g-app-progress-container')).render();\n\n        return this;\n    },\n\n    /**\n     * Changes the current body view to the view class specified by view.\n     * @param view The view to display in the body.\n     * @param [settings={}] Settings to pass to the view initialize() method.\n     * @param opts Additional options for navigateTo, if any.\n     */\n    navigateTo: function (view, settings, opts) {\n        this.globalNavView.deactivateAll();\n\n        settings = settings || {};\n        opts = opts || {};\n\n        if (opts.layout) {\n            if (girder.layout !== opts.layout) {\n                if (_.has(this.layoutRenderMap, opts.layout)) {\n                    // set a layout if opts specifies one different from current\n                    this.layoutRenderMap[girder.layout].hide.call(this, opts);\n                    girder.layout = opts.layout;\n                    this.layoutRenderMap[girder.layout].show.call(this, opts);\n                } else {\n                    console.error('Attempting to set unknown layout type: ' + opts.layout);\n                }\n            }\n        } else if (girder.layout !== girder.Layout.DEFAULT) {\n            // reset to default as needed when nothing specified in opts\n            this.layoutRenderMap[girder.layout].hide.call(this, opts);\n            girder.layout = girder.Layout.DEFAULT;\n            this.layoutRenderMap[girder.layout].show.call(this, opts);\n        }\n\n        if (view) {\n            if (this.bodyView) {\n                this.bodyView.destroy();\n            }\n\n            settings = _.extend(settings, {\n                el: this.$('#g-app-body-container'),\n                parentView: this\n            });\n\n            /* We let the view be created in this way even though it is\n             * normally against convention.\n             */\n            this.bodyView = new view(settings); // eslint-disable-line new-cap\n        } else {\n            console.error('Undefined page.');\n        }\n        return this;\n    },\n\n    /**\n     * Close any open dialog if we are already logged in.\n     * :returns: true if we have a current user.\n     */\n    closeDialogIfUser: function () {\n        if (girder.currentUser) {\n            $('.modal').girderModal('close');\n            return true;\n        }\n        return false;\n    },\n\n    /**\n     * Show a dialog allowing a user to login or register.\n     */\n    loginDialog: function () {\n        if (this.closeDialogIfUser()) {\n            return;\n        }\n        if (!this.loginView) {\n            this.loginView = new girder.views.LoginView({\n                el: this.$('#g-dialog-container'),\n                parentView: this\n            });\n        }\n        this.loginView.render();\n    },\n\n    registerDialog: function () {\n        if (this.closeDialogIfUser()) {\n            return;\n        }\n        if (!this.registerView) {\n            this.registerView = new girder.views.RegisterView({\n                el: this.$('#g-dialog-container'),\n                parentView: this\n            });\n        }\n        this.registerView.render();\n    },\n\n    resetPasswordDialog: function () {\n        if (this.closeDialogIfUser()) {\n            return;\n        }\n        if (!this.resetPasswordView) {\n            this.resetPasswordView = new girder.views.ResetPasswordView({\n                el: this.$('#g-dialog-container'),\n                parentView: this\n            });\n        }\n        this.resetPasswordView.render();\n    },\n\n    /**\n     * Display a brief alert on the screen with the following options:\n     *   - text: The text to be displayed\n     *   - [type]: The alert class ('info', 'warning', 'success', 'danger').\n     *             Default is 'info'.\n     *   - [icon]: An optional icon to display in the alert.\n     *   - [timeout]: How long before the alert should automatically disappear.\n     *                Default is 6000ms. Set to <= 0 to have no timeout.\n     */\n    alert: function (options) {\n        var el = $(girder.templates.alert({\n            text: options.text,\n            type: options.type || 'info',\n            icon: options.icon\n        }));\n        $('#g-alerts-container').append(el);\n        el.fadeIn(500);\n\n        if (options.timeout === undefined) {\n            options.timeout = 6000;\n        }\n        if (options.timeout > 0) {\n            window.setTimeout(function () {\n                el.fadeOut(750, function () {\n                    $(this).remove();\n                });\n            }, options.timeout);\n        }\n    },\n\n    /**\n     * On login we re-render the current body view; whereas on\n     * logout, we redirect to the front page.\n     */\n    login: function () {\n        var route = girder.dialogs.splitRoute(Backbone.history.fragment).base;\n        Backbone.history.fragment = null;\n        girder.eventStream.close();\n\n        if (girder.currentUser) {\n            girder.eventStream.open();\n            girder.router.navigate(route, {trigger: true});\n        } else {\n            girder.router.navigate('/', {trigger: true});\n        }\n    }\n});\n","girder.Router = Backbone.Router.extend({\n    initialize: function () {\n        this._enabled = true;\n    },\n\n    execute: function (callback, args) {\n        args.push(girder.parseQueryString(args.pop()));\n        var queryString = args[args.length - 1];\n        if (callback) {\n            callback.apply(this, args);\n        }\n\n        // handle \"top level\" dialogs\n        if (queryString.dialog === 'login') {\n            girder.events.trigger('g:loginUi');\n        } else if (queryString.dialog === 'register') {\n            girder.events.trigger('g:registerUi');\n        } else if (queryString.dialog === 'resetpassword') {\n            girder.events.trigger('g:resetPasswordUi');\n        }\n    },\n\n    /**\n     * Set or get the enabled state of the router. Call with a boolean argument\n     * to set the enabled state, or with no arguments to get the state.\n     */\n    enabled: function () {\n        if (arguments.length) {\n            this._enabled = !!arguments[0];\n        }\n        return this._enabled;\n    },\n\n    navigate: function () {\n        if (this._enabled) {\n            Backbone.Router.prototype.navigate.apply(this, arguments);\n        }\n    }\n});\n\ngirder.router = new girder.Router();\n\n// When the back button is pressed, we want to close open modals.\ngirder.router.on('route', function (route, params) {\n    if (!params.slice(-1)[0].dialog) {\n        $('.modal').girderModal('close');\n    }\n    // get rid of tooltips\n    $('.tooltip').remove();\n});\n","\ngirder.dialogs = {\n\n    splitRoute: function (route) {\n        if (!route) {\n            return {base: '', name: ''};\n        }\n        var firstIndex = route.indexOf('?'),\n            lastIndex = route.lastIndexOf('?'),\n            dialogName,\n            baseRoute;\n\n        if (firstIndex === -1) {\n            baseRoute = route;\n        } else {\n            baseRoute = route.slice(0, firstIndex);\n        }\n\n        if (lastIndex === -1) {\n            dialogName = '';\n        } else {\n            dialogName = route.slice(lastIndex + 1);\n        }\n\n        return {name: dialogName, base: baseRoute};\n    },\n\n    handleClose: function (name, options, nameId) {\n        if (!girder.router.enabled()) {\n            return;\n        }\n        var curRoute = Backbone.history.fragment,\n            routeParts = this.splitRoute(curRoute),\n            queryString = girder.parseQueryString(routeParts.name),\n            dialogName = queryString.dialog,\n            dialogId = queryString.dialogid;\n        delete queryString.dialog;\n        delete queryString.dialogid;\n        var unparsedQueryString = $.param(queryString);\n        if (unparsedQueryString.length > 0) {\n            unparsedQueryString = '?' + unparsedQueryString;\n        }\n        if (dialogName === name && dialogId === nameId) {\n            girder.router.navigate(routeParts.base + unparsedQueryString, options);\n        }\n    },\n\n    handleOpen: function (name, options, nameId) {\n        if (!girder.router.enabled()) {\n            return;\n        }\n        var curRoute = Backbone.history.fragment,\n            routeParts = this.splitRoute(curRoute),\n            queryString = girder.parseQueryString(routeParts.name),\n            dialogName = queryString.dialog,\n            dialogId = queryString.dialogid;\n\n        if (dialogName !== name || nameId !== dialogId) {\n            queryString.dialog = name;\n            if (nameId) {\n                queryString.dialogid = nameId;\n            }\n            var unparsedQueryString = $.param(queryString);\n            if (unparsedQueryString.length > 0) {\n                unparsedQueryString = '?' + unparsedQueryString;\n            }\n            girder.router.navigate(routeParts.base + unparsedQueryString, options);\n        }\n    }\n\n};\n","(function () {\n    /**\n     * The EventStream type wraps window.EventSource to listen to the unified\n     * per-user event channel endpoint using the SSE protocol. When events are\n     * received on the SSE channel, this triggers a Backbone event of the form\n     * 'g:event.<type>' where <type> is the value of the event type field.\n     * Listeners can bind to specific event types on the channel.\n     */\n    girder.EventStream = function (settings) {\n        var defaults = {\n            timeout: null,\n            streamPath: '/notification/stream'\n        };\n\n        this.settings = _.extend(defaults, settings);\n\n        return _.extend(this, Backbone.Events);\n    };\n\n    var prototype = girder.EventStream.prototype;\n\n    prototype.open = function () {\n        if (window.EventSource) {\n            var stream = this,\n                url = girder.apiRoot + this.settings.streamPath;\n\n            if (this.settings.timeout) {\n                url += '?timeout=' + this.settings.timeout;\n            }\n\n            this._eventSource = new window.EventSource(url);\n\n            this._eventSource.onmessage = function (e) {\n                var obj;\n                try {\n                    obj = window.JSON.parse(e.data);\n                } catch (err) {\n                    console.error('Invalid JSON from SSE stream: ' + e.data + ',' + err);\n                    stream.trigger('g:error', e);\n                    return;\n                }\n                stream.trigger('g:event.' + obj.type, obj);\n            };\n        } else {\n            console.error('EventSource is not supported on this platform.');\n        }\n    };\n\n    prototype.close = function () {\n        if (this._eventSource) {\n            this._eventSource.close();\n            this._eventSource = null;\n        }\n    };\n}());\n","/**\n * Define jQuery plugins within this scope.\n */\n(function ($) {\n    /**\n     * This should be used instead of calling bootstrap's modal() jQuery\n     * method directly. This unbinds all previous events from the dialog,\n     * then calls modal on it and binds the bootstrap close events.\n     * @param view The view object. Pass \"false\" for special cases where the\n     *             dialog does not correspond to a View object.  Pass 'close'\n     *             to just close an open modal dialog.\n     */\n    $.fn.girderModal = function (view) {\n        var that = this;\n        /* If we have a modal dialog open, or one is in the process of closing,\n         * close that dialog before opening the new one.  This prevents\n         * layering modal dialogs, but also makes sure that we don't have a\n         * problem switching from one modal dialog to another. */\n        if ($(this).is('.modal')) {\n            /* We have to reach into the backbone modal object a little to see\n             * if we need to do anything.  By turning off the fade as we\n             * remove the old dialog, the removal is synchronous and we are\n             * sure it is gone before we add the new dialog. */\n            if ($(this).data('bs.modal') && $(this).data('bs.modal').isShown) {\n                var elem = $($(this).data('bs.modal').$element);\n                var hasFade = elem.hasClass('fade');\n                elem.removeClass('fade');\n                $(this).modal('hide');\n                elem.toggleClass('fade', hasFade);\n            }\n        }\n        if (view !== 'close') {\n            this.off().modal().find('[data-dismiss=\"modal\"]')\n                .unbind('click').click(function () {\n                    that.modal('hide');\n                });\n            if (view !== false) {\n                view.delegateEvents();\n            }\n        }\n        return this;\n    };\n}(jQuery));\n","/**\n * This file contains utility functions for general use in the application\n */\ngirder.DATE_MONTH = 0;\ngirder.DATE_DAY = 1;\ngirder.DATE_MINUTE = 2;\ngirder.DATE_SECOND = 3;\n\n/**\n * Format a date string to the given resolution.\n * @param datestr The date string to format.\n * @param resolution The resolution, defaults to 'day'. Minimum is month.\n */\ngirder.formatDate = function (datestr, resolution) {\n    datestr = datestr.replace(' ', 'T'); // Cross-browser accepted date format\n    var date = new Date(datestr);\n    var output = girder.MONTHS[date.getMonth()];\n\n    resolution = resolution || girder.DATE_MONTH;\n\n    if (resolution >= girder.DATE_DAY) {\n        output += ' ' + date.getDate() + ',';\n    }\n\n    output += ' ' + date.getFullYear();\n\n    if (resolution >= girder.DATE_MINUTE) {\n        output += ' at ' + date.getHours() + ':' +\n            ('0' + date.getMinutes()).slice(-2);\n    }\n    if (resolution >= girder.DATE_SECOND) {\n        output += ':' + ('0' + date.getSeconds()).slice(-2);\n    }\n\n    return output;\n};\n\n/**\n * Format a size in bytes into a human-readable string with metric unit\n * prefixes.\n */\ngirder.formatSize = function (sizeBytes) {\n    if (sizeBytes < 1024) {\n        return sizeBytes + ' B';\n    }\n    var i, sizeVal = sizeBytes, precision = 1;\n    for (i = 0; sizeVal >= 1024; i += 1) {\n        sizeVal /= 1024;\n    }\n    // If we are just reporting a low number, no need for decimal places.\n    if (sizeVal < 10) {\n        precision = 3;\n    } else if (sizeVal < 100) {\n        precision = 2;\n    }\n    return sizeVal.toFixed(precision) + ' ' +\n        ['B', 'kB', 'MB', 'GB', 'TB'][Math.min(i, 4)];\n};\n\n/**\n * Like girder.formatSize, but more generic. Returns a human-readable format\n * of an integer using metric prefixes. The caller is expected to append any\n * unit string if necessary.\n *\n * @param {integer} n The number to format.\n * @param {Object} [opts={}] Formatting options. These include:\n *   - {integer} [maxLen] Max number of digits in the output.\n *   - {integer} [base=1000] Base for the prefixes (usually 1000 or 1024).\n *   - {string} [sep=''] Separator between numeric value and metric prefix.\n */\ngirder.formatCount = function (n, opts) {\n    n = n || 0;\n    opts = opts || {};\n\n    var i = 0,\n        base = opts.base || 1000,\n        sep = opts.sep || '',\n        maxLen = opts.maxLen || 3,\n        precision = maxLen - 1;\n\n    for (; n > base; i += 1) {\n        n /= base;\n    }\n\n    if (!i) {\n        precision = 0;\n    } else if (n > 100) {\n        precision -= 2;\n    } else if (n > 10) {\n        precision -= 1;\n    }\n\n    return n.toFixed(Math.max(0, precision)) + sep +\n        ['', 'k', 'M', 'G', 'T'][Math.min(i, 4)];\n};\n\n/**\n * Prompt the user to confirm an action.\n * @param [text] The text to prompt the user with.\n * @param [yesText] The text for the confirm button.\n * @param [yesClass] Class string to apply to the confirm button.\n * @param [noText] The text for the no/cancel button.\n * @param [escapedHtml] If you want to render the text as HTML rather than\n *        plain text, set this to true to acknowledge that you have escaped any\n *        user-created data within the text to prevent XSS exploits.\n * @param confirmCallback Callback function when the user confirms the action.\n */\ngirder.confirm = function (params) {\n    params = _.extend({\n        text: 'Are you sure?',\n        yesText: 'Yes',\n        yesClass: 'btn-danger',\n        noText: 'Cancel',\n        escapedHtml: false\n    }, params);\n    $('#g-dialog-container').html(girder.templates.confirmDialog({\n        params: params\n    })).girderModal(false);\n\n    var el = $('#g-dialog-container').find('.modal-body>p');\n    if (params.escapedHtml) {\n        el.html(params.text);\n    } else {\n        el.text(params.text);\n    }\n\n    $('#g-confirm-button').unbind('click').click(function () {\n        $('#g-dialog-container').modal('hide');\n        params.confirmCallback();\n    });\n};\n\n/**\n * This comparator can be used by collections that wish to support locale-based\n * sorting.  The locale specifies how upper and lower case are compared.\n */\ngirder.localeComparator = function (model1, model2) {\n    var a1 = model1.get(this.sortField),\n        a2 = model2.get(this.sortField);\n\n    if (a1 !== undefined && a1.localeCompare) {\n        var result = a1.localeCompare(a2) * this.sortDir;\n        if (result || !this.secondarySortField) {\n            return result;\n        }\n        a1 = model1.get(this.secondarySortField);\n        a2 = model2.get(this.secondarySortField);\n        return a1.localeCompare(a2) * this.sortDir;\n    }\n\n    return a1 > a2 ? this.sortDir : (a1 < a2 ? -this.sortDir : 0);\n};\n\n/**\n * This comparator can be passed to the sort function on javascript arrays.\n */\ngirder.localeSort = function (a1, a2) {\n    if (a1 !== undefined && a1.localeCompare) {\n        return a1.localeCompare(a2);\n    }\n    return a1 > a2 ? 1 : (a1 < a2 ? -1 : 0);\n};\n\n/**\n * Return the model class name given its collection name.\n * @param name Collection name, e.g. 'user'\n */\ngirder.getModelClassByName = function (name) {\n    var className = name.charAt(0).toUpperCase();\n    return className + name.substr(1) + 'Model';\n};\n\ngirder.parseQueryString = function (queryString) {\n    var params = {};\n    if (queryString) {\n        _.each(queryString.replace(/\\+/g, ' ').split(/&/g), function (el) {\n            var aux = el.split('='), val;\n            if (aux.length > 1) {\n                val = decodeURIComponent(el.substr(aux[0].length + 1));\n            }\n            params[decodeURIComponent(aux[0])] = val;\n        });\n    }\n    return params;\n};\n\ngirder.cookie = {\n    findAll: function () {\n        var cookies = {};\n        _(document.cookie.split(';'))\n            .chain()\n            .map(function (m) {\n                return m.replace(/^\\s+/, '').replace(/\\s+$/, '');\n            })\n            .each(function (c) {\n                var arr = c.split('='),\n                    key = arr[0],\n                    value = null,\n                    size = _.size(arr);\n                if (size > 1) {\n                    value = arr.slice(1).join('');\n                }\n                cookies[key] = value;\n            });\n        return cookies;\n    },\n\n    find: function (name) {\n        var cookie = null,\n            list = this.findAll();\n\n        _.each(list, function (value, key) {\n            if (key === name) {\n                cookie = value;\n            }\n        });\n        return cookie;\n    }\n};\n\n// Make sure girder.currentToken is set on startup if a cookie exists.\ngirder.currentToken = girder.cookie.find('girderToken');\n\n/**\n * Restart the server, wait until it has restarted, then reload the current\n * page.\n */\ngirder.restartServer = function () {\n    function waitForServer() {\n        girder.restRequest({\n            type: 'GET',\n            path: 'system/version',\n            error: null\n        }).done(_.bind(function (resp) {\n            if (resp.serverStartDate !== girder.restartServer._lastStartDate) {\n                girder.restartServer._reloadWindow();\n            } else {\n                window.setTimeout(waitForServer, 1000);\n            }\n        })).error(_.bind(function () {\n            window.setTimeout(waitForServer, 1000);\n        }));\n    }\n\n    girder.restRequest({\n        type: 'GET',\n        path: 'system/version'\n    }).done(_.bind(function (resp) {\n        girder.restartServer._lastStartDate = resp.serverStartDate;\n        girder.restartServer._callSystemRestart();\n        girder.events.trigger('g:alert', {\n            icon: 'cw',\n            text: 'Restarting server',\n            type: 'warning',\n            timeout: 60000\n        });\n        waitForServer();\n    }));\n};\n/* Having these as object properties facilitates testing */\ngirder.restartServer._callSystemRestart = function () {\n    girder.restRequest({type: 'PUT', path: 'system/restart'});\n};\ngirder.restartServer._reloadWindow = function () {\n    window.location.reload();\n};\n\n/**\n * Create a set of flags that can be OR'd (|) together to define a set of\n * options.\n *\n * @param {Array} options An array of strings defining the option names.\n * @param {string} allOption If you want an option that enables all options,\n *                 pass its name as this parameter.\n * @return {Object} An object mapping the names of options to values.\n */\ngirder.defineFlags = function (options, allOption) {\n    var i = 0,\n        obj = {};\n\n    if (allOption) {\n        obj[allOption] = 1;\n    }\n    _.each(options, function (opt) {\n        obj[opt] = 1 << i;\n\n        if (allOption) {\n            obj[allOption] |= obj[opt];\n        }\n\n        i += 1;\n    });\n\n    return obj;\n};\n\n/**\n * Transform markdown into HTML and render it into the given element. If no\n * element is provided, simply returns the HTML.\n *\n * @param val The markdown text input.\n * @param el The element to render the output HTML into, or falsy to simply\n *        return the HTML value.\n */\ngirder.renderMarkdown = (function () {\n    if (window.Remarkable) {\n        var md = new Remarkable({\n            linkify: true\n        });\n        return function (val, el) {\n            if (el) {\n                $(el).html(md.render(val));\n            } else {\n                return md.render(val);\n            }\n        };\n    } else {\n        return function () {\n            throw new Error(\n                'You must include the remarkable library to call this function');\n        };\n    }\n}());\n\n/**\n * Capitalize the first character of a string.\n */\ngirder.capitalize = function (str) {\n    return str.charAt(0).toUpperCase() + str.substring(1);\n};\n\n(function () {\n    var _pluginConfigRoutes = {};\n\n    /**\n     * Expose a plugin configuration page via the admin plugins page.\n     * @param pluginName The canonical plugin name, i.e. its directory name\n     * @param route The route to trigger that will render the plugin config.\n     */\n    girder.exposePluginConfig = function (pluginName, route) {\n        _pluginConfigRoutes[pluginName] = route;\n    };\n\n    girder.getPluginConfigRoute = function (pluginName) {\n        return _pluginConfigRoutes[pluginName];\n    };\n}());\n\n/* Pending rest requests are listed in this pool so that they can be aborted or\n * checked if still processing. */\n(function () {\n    var restXhrPool = {};\n    var restXhrCount = 0;\n    $(document).ajaxSend(function (event, xhr) {\n        restXhrCount += 1;\n        xhr.girderXhrNumber = restXhrCount;\n        restXhrPool[restXhrCount] = xhr;\n    });\n    $(document).ajaxComplete(function (event, xhr) {\n        var num = xhr.girderXhrNumber;\n        if (num && restXhrPool[num]) {\n            delete restXhrPool[num];\n        }\n    });\n    /* Get the number of outstanding rest requests.\n     * :param category: if specified, only count those requests that have\n     *                  xhr.girder.(category) set to a truthy value.\n     * :returns: the number of outstanding requests.\n     */\n    girder.numberOutstandingRestRequests = function (category) {\n        if (category) {\n            return _.filter(restXhrPool, function (xhr) {\n                return xhr.girder && xhr.girder[category];\n            }).length;\n        }\n        return _.size(restXhrPool);\n    };\n    /* Cancel outstanding rest requests.\n     * :param category: if specified, only abort those requests that have\n     *                  xhr.girder.(category) set to a truthy value.\n     */\n    girder.cancelRestRequests = function (category) {\n        _.each(restXhrPool, function (xhr) {\n            if (category && (!xhr.girder || !xhr.girder[category])) {\n                return;\n            }\n            if (xhr.abort) {\n                xhr.abort();\n            }\n        });\n    };\n}());\n","/**\n * This is the upload handler for the \"s3\" behavior, which is responsible for\n * uploading data to an s3 assetstore type directly from the user agent, using\n * either the single-request or multi-chunk protocol depending on the size of\n * the file.\n *\n * The flow here is to make requests to Girder for each required chunk of\n * the upload, which Girder authorizes and signs using HMAC. Those signatures\n * are sent, along with the bytes, to the appropriate S3 bucket. For multi-\n * chunk uploads, one final request is required after all chunks have been\n * sent in order to create the final unified record in S3.\n */\n(function () {\n    // Constructor\n    girder.uploadHandlers.s3 = function (params) {\n        this.params = params;\n        this.startByte = 0;\n        return _.extend(this, Backbone.Events);\n    };\n\n    var prototype = girder.uploadHandlers.s3.prototype;\n\n    prototype._xhrProgress = function (event) {\n        if (!event.lengthComputable) {\n            return;\n        }\n\n        // We only want to count bytes of the actual file, not the bytes of\n        // the request body corresponding to the other form parameters model\n        // we are also sending.\n        var loaded = this.payloadLength + event.loaded - event.total;\n\n        if (loaded >= 0) {\n            this.trigger('g:upload.progress', {\n                startByte: this.startByte,\n                loaded: loaded,\n                total: this.params.file.size,\n                file: this.params.file\n            });\n        }\n    };\n\n    prototype.execute = function () {\n        var s3Info = this.params.upload.s3;\n        var handler = this;\n\n        var xhr = new XMLHttpRequest();\n        xhr.open(s3Info.request.method, s3Info.request.url);\n        _.each(s3Info.request.headers, function (v, k) {\n            xhr.setRequestHeader(k, v);\n        });\n\n        if (s3Info.chunked) {\n            this._multiChunkUpload(xhr);\n        } else {\n            this.payloadLength = this.params.file.size;\n            xhr.onload = function () {\n                if (xhr.status === 200) {\n                    handler.trigger('g:upload.chunkSent', {\n                        bytes: handler.payloadLength\n                    });\n\n                    girder.restRequest({\n                        path: 'file/completion',\n                        type: 'POST',\n                        data: {\n                            uploadId: handler.params.upload._id\n                        },\n                        error: null\n                    }).done(_.bind(function (resp) {\n                        this.trigger('g:upload.complete', resp);\n                    }, handler)).error(_.bind(function (resp) {\n                        var msg;\n\n                        if (resp.status === 0) {\n                            msg = 'Could not connect to the server.';\n                        } else {\n                            msg = 'An error occurred when resuming upload, check console.';\n                        }\n                        this.trigger('g:upload.error', {\n                            message: msg\n                        });\n                    }, handler));\n                } else {\n                    handler.trigger('g:upload.error', {\n                        message: 'Error occurred uploading to S3 (' +\n                            xhr.status + ').'\n                    });\n                }\n            };\n\n            xhr.upload.addEventListener('progress', function (event) {\n                handler._xhrProgress(event);\n            });\n\n            xhr.addEventListener('error', function (event) {\n                handler.trigger('g:upload.error', {\n                    message: 'Error occurred uploading to S3.',\n                    event: event\n                });\n            });\n\n            xhr.send(this.params.file);\n        }\n    };\n\n    prototype.resume = function () {\n        if (this.params.upload.s3.chunked) {\n            return this._sendNextChunk();\n        }\n\n        // If this is a single-chunk upload, we have to use the offset method\n        // to re-generate the initial request with a new timestamp.\n        girder.restRequest({\n            path: 'file/offset',\n            type: 'GET',\n            data: {\n                uploadId: this.params.upload._id\n            },\n            error: null\n        }).done(_.bind(function (resp) {\n            this.params.upload.s3.request = resp;\n            this.execute();\n        }, this)).error(_.bind(function (resp) {\n            var msg;\n\n            if (resp.status === 0) {\n                msg = 'Could not connect to the Girder server.';\n            } else {\n                msg = 'An error occurred when resuming upload, check console.';\n            }\n            this.trigger('g:upload.error', {\n                message: msg\n            });\n        }, this));\n    };\n\n    /**\n     * If the file being uploaded is larger than a single chunk length, it\n     * should be uploaded using the S3 multipart protocol.\n     */\n    prototype._multiChunkUpload = function (xhr) {\n        var handler = this;\n        this.eTagList = {};\n        this.startByte = 0;\n        this.chunkN = 1;\n\n        xhr.onload = function () {\n            if (xhr.status === 200) {\n                handler.s3UploadId =\n                    xhr.responseText.match(/<UploadId>(.*)<\\/UploadId>/).pop();\n                handler._sendNextChunk();\n            } else {\n                handler.trigger('g:upload.error', {\n                    message: 'Error while initializing multichunk S3 upload.',\n                    event: event\n                });\n            }\n        };\n\n        xhr.addEventListener('error', function (event) {\n            handler.trigger('g:upload.error', {\n                message: 'Error occurred uploading to S3.',\n                event: event\n            });\n        });\n\n        xhr.send();\n    };\n\n    /**\n     * Internal helper method used during multichunk upload protocol. This\n     * requests a signed chunk upload request from Girder, then uses that\n     * authorized request to send the chunk to S3.\n     */\n    prototype._sendNextChunk = function () {\n        var sliceFn = this.params.file.webkitSlice ? 'webkitSlice' : 'slice';\n        var data = this.params.file[sliceFn](this.startByte,\n            this.startByte + this.params.upload.s3.chunkLength);\n        this.payloadLength = data.size;\n\n        // Get the authorized request from Girder\n        girder.restRequest({\n            path: 'file/chunk',\n            type: 'POST',\n            data: {\n                offset: 0,\n                chunk: JSON.stringify({\n                    s3UploadId: this.s3UploadId,\n                    partNumber: this.chunkN,\n                    contentLength: this.payloadLength\n                }),\n                uploadId: this.params.upload._id\n            },\n            error: null\n        }).done(_.bind(function (resp) {\n            // Send the chunk to S3\n            var handler = this;\n            var xhr = new XMLHttpRequest();\n            xhr.open(resp.s3.request.method, resp.s3.request.url);\n\n            xhr.onload = function () {\n                if (xhr.status === 200) {\n                    handler.trigger('g:upload.chunkSent', {\n                        bytes: handler.payloadLength\n                    });\n                    // ETag gets sent wrapped in quotes, we must strip them\n                    handler.eTagList[handler.chunkN] =\n                        xhr.getResponseHeader('ETag').replace(/\"/g, '');\n                    handler.startByte += handler.payloadLength;\n                    handler.chunkN += 1;\n\n                    if (handler.startByte < handler.params.file.size) {\n                        handler._sendNextChunk();\n                    } else {\n                        handler._finalizeMultiChunkUpload();\n                    }\n                } else {\n                    handler.trigger('g:upload.error', {\n                        message: 'Error occurred uploading to S3 (' +\n                            xhr.status + ').'\n                    });\n                }\n            };\n\n            xhr.upload.addEventListener('progress', function (event) {\n                handler._xhrProgress(event);\n            });\n\n            xhr.addEventListener('error', function (event) {\n                handler.trigger('g:upload.error', {\n                    message: 'Error occurred uploading to S3.',\n                    event: event\n                });\n            });\n\n            xhr.send(data);\n        }, this)).error(_.bind(function () {\n            this.trigger('g:upload.error', {\n                message: 'Error getting signed chunk request from Girder.'\n            });\n        }, this));\n    };\n\n    /**\n     * When all chunks of a multichunk upload have been sent, this must be\n     * called in order to finalize the upload.\n     */\n    prototype._finalizeMultiChunkUpload = function () {\n        girder.restRequest({\n            path: 'file/completion',\n            type: 'POST',\n            data: {\n                uploadId: this.params.upload._id\n            },\n            error: null\n        }).done(_.bind(function (resp) {\n            // Create the XML document that will be the request body to S3\n            var handler = this;\n            var doc = document.implementation.createDocument(null, null, null);\n            var root = doc.createElement('CompleteMultipartUpload');\n\n            _.each(this.eTagList, function (etag, partNumber) {\n                var partEl = doc.createElement('Part');\n                var partNumberEl = doc.createElement('PartNumber');\n                var etagEl = doc.createElement('ETag');\n\n                partNumberEl.appendChild(doc.createTextNode(partNumber));\n                etagEl.appendChild(doc.createTextNode(etag));\n                partEl.appendChild(partNumberEl);\n                partEl.appendChild(etagEl);\n                root.appendChild(partEl);\n            });\n\n            var req = resp.s3FinalizeRequest;\n            var xhr = new XMLHttpRequest();\n\n            xhr.open(req.method, req.url);\n\n            _.each(req.headers, function (v, k) {\n                xhr.setRequestHeader(k, v);\n            });\n\n            xhr.onload = function () {\n                if (xhr.status === 200) {\n                    delete resp.s3FinalizeRequest;\n                    handler.trigger('g:upload.complete', resp);\n                } else {\n                    handler.trigger('g:upload.error', {\n                        message: 'Error occurred uploading to S3 (' +\n                            xhr.status + ').'\n                    });\n                }\n            };\n\n            xhr.send(new window.XMLSerializer().serializeToString(root));\n        }, this)).error(_.bind(function (resp) {\n            var msg;\n\n            if (resp.status === 0) {\n                msg = 'Could not connect to the server.';\n            } else {\n                msg = 'Upload error during finalize, check console.';\n            }\n            this.trigger('g:upload.error', {\n                message: msg\n            });\n        }, this));\n    };\n}());\n","/**\n * Wrap the prototype method of a given object.\n *\n * @param obj The object whose prototype to extend, e.g. girder.views.MyView\n * @param funcName The name of the function to wrap, e.g. \"render\"\n * @param wrapper The wrapper function, which should be a function taking the\n *     underlying wrapped function as its first argument. The wrapped function\n *     should be called with .call(this[, arguments]) inside of the wrapper in\n *     order to preserve \"this\" semantics.\n */\ngirder.wrap = function (obj, funcName, wrapper) {\n    obj.prototype[funcName] = _.wrap(obj.prototype[funcName], wrapper);\n};\n","/**\n * All collections should descend from this collection base class, which\n * provides nice utilities for pagination and sorting.\n */\ngirder.Collection = Backbone.Collection.extend({\n    model: girder.Model,\n    resourceName: null,\n\n    sortField: 'name',\n    sortDir: girder.SORT_ASC,\n    comparator: girder.localeComparator,\n\n    // Number of records to fetch per page\n    pageLimit: 25,\n    offset: 0,\n\n    // Alternative fetch URL\n    altUrl: null,\n\n    /**\n     * Append mode can be used to append pages to the collection rather than\n     * simply replacing its contents when a new page is fetched. For the sake\n     * of least surprise, this property should not be changed in the definition\n     * of collections, but after they are instantiated.\n     */\n    append: false,\n\n    /**\n     * Returns a boolean of whether or not this collection has previous pages,\n     * i.e. if the offset of the current page start is > 0\n     */\n    hasPreviousPage: function () {\n        return this.offset - this.length > 0;\n    },\n\n    /**\n     * After you have called fetch() on a collection, this method will tell\n     * you whether there are more pages remaining to be fetched, or if you\n     * have hit the end.\n     */\n    hasNextPage: function () {\n        return this._hasMorePages;\n    },\n\n    /**\n     * Fetch the previous page of this collection, emitting g:changed when done.\n     */\n    fetchPreviousPage: function (params) {\n        this.offset = Math.max(0, this.offset - this.length - this.pageLimit);\n        this.fetch(_.extend({}, this.params, params || {}));\n    },\n\n    /**\n     * Fetch the previous page of this collection, emitting g:changed when done.\n     */\n    fetchNextPage: function (params) {\n        this.fetch(_.extend({}, this.params, params || {}));\n    },\n\n    /**\n     * Return the 0-indexed page number of the current page. Add 1 to this\n     * result when displaying it to the user.\n     */\n    pageNum: function () {\n        return Math.ceil((this.offset - this.length) / this.pageLimit);\n    },\n\n    /**\n     * Fetches the next page of this collection, replacing the existing models\n     * of this collection with the requested page. If the next page contains\n     * any records (i.e. it was not already on the last page), this will\n     * trigger g:changed.\n     * @param params Any additional parameters to be passed with the request.\n     * @param reset Set this to true to re-fetch the current page.\n     */\n    fetch: function (params, reset) {\n        if (this.altUrl === null && this.resourceName === null) {\n            alert('Error: You must set an altUrl or resourceName on your collection.');\n            return;\n        }\n\n        if (reset) {\n            this.offset = 0;\n        } else {\n            this.params = params || {};\n        }\n\n        var limit = this.pageLimit > 0 ? this.pageLimit + 1 : 0;\n\n        var xhr = girder.restRequest({\n            path: this.altUrl || this.resourceName,\n            data: _.extend({\n                limit: limit,\n                offset: this.offset,\n                sort: this.sortField,\n                sortdir: this.sortDir\n            }, this.params)\n        }).done(_.bind(function (list) {\n            if (this.pageLimit > 0 && list.length > this.pageLimit) {\n                // This means we have more pages to display still. Pop off\n                // the extra that we fetched.\n                list.pop();\n                this._hasMorePages = true;\n            } else {\n                this._hasMorePages = false;\n            }\n\n            this.offset += list.length;\n\n            if (list.length > 0 || reset) {\n                if (this.append && !reset) {\n                    this.add(list);\n                } else {\n                    this.reset(list);\n                }\n            }\n\n            this.trigger('g:changed');\n        }, this));\n        xhr.girder = {fetch: true};\n    }\n});\n","/**\n * All models should descend from this base model, which provides a number\n * of utilities for synchronization.\n */\ngirder.Model = Backbone.Model.extend({\n    resourceName: null,\n    altUrl: null,\n    idAttribute: '_id',\n\n    /**\n     * Convenience method for incrementing numeric properties.\n     * @param {string} attr The attribute to increment.\n     * @param {number} [amount] The amount to increment by. Defaults to 1.\n     */\n    increment: function (attr, amount) {\n        if (amount === undefined) {\n            amount = 1;\n        }\n        if (!amount) {\n            return;\n        }\n        return this.set(attr, this.get(attr) + amount);\n    },\n\n    /**\n     * Get the name for this resource. By default, just the name attribute.\n     */\n    name: function () {\n        return this.get('name');\n    },\n\n    /**\n     * Save this model to the server. If this is a new model, meaning it has no\n     * _id attribute, this will create it. If the _id is set, we update the\n     * existing model. Triggers g:saved on success, and g:error on error.\n     */\n    save: function () {\n        if (this.altUrl === null && this.resourceName === null) {\n            alert('Error: You must set an altUrl or resourceName on your model.');\n            return;\n        }\n\n        var path, type;\n        if (this.has('_id')) {\n            path = (this.altUrl || this.resourceName) + '/' + this.get('_id');\n            type = 'PUT';\n        } else {\n            path = (this.altUrl || this.resourceName);\n            type = 'POST';\n        }\n        /* Don't save attributes which are objects using this call.  For\n         * instance, if the metadata of an item has keys that contain non-ascii\n         * values, they won't get handled the the rest call. */\n        var data = {};\n        _.each(this.keys(), function (key) {\n            var value = this.get(key);\n            if (!_.isObject(value)) {\n                data[key] = value;\n            }\n        }, this);\n\n        girder.restRequest({\n            path: path,\n            type: type,\n            data: data,\n            error: null // don't do default error behavior (validation may fail)\n        }).done(_.bind(function (resp) {\n            this.set(resp);\n            this.trigger('g:saved');\n        }, this)).error(_.bind(function (err) {\n            this.trigger('g:error', err);\n        }, this));\n\n        return this;\n    },\n\n    /**\n     * Fetch a single resource from the server. Triggers g:fetched on success,\n     * or g:error on error.\n     * To ignore the default error handler, pass\n     *     ignoreError: true\n     * in your opts object.\n     */\n    fetch: function (opts) {\n        if (this.altUrl === null && this.resourceName === null) {\n            alert('Error: You must set an altUrl or a resourceName on your model.');\n            return;\n        }\n\n        opts = opts || {};\n        var restOpts = {\n            path: (this.altUrl || this.resourceName) + '/' + this.get('_id')\n        };\n        if (opts.extraPath) {\n            restOpts.path += '/' + opts.extraPath;\n        }\n        if (opts.ignoreError) {\n            restOpts.error = null;\n        }\n        girder.restRequest(restOpts).done(_.bind(function (resp) {\n            this.set(resp);\n            if (opts.extraPath) {\n                this.trigger('g:fetched.' + opts.extraPath);\n            } else {\n                this.trigger('g:fetched');\n            }\n        }, this)).error(_.bind(function (err) {\n            this.trigger('g:error', err);\n        }, this));\n\n        return this;\n    },\n\n    /**\n     * Get the path for downloading this resource via the API. Can be used\n     * as the href property of a direct download link.\n     * @param params {Object} list of key-value parameters to include in the\n     *    query string.\n     */\n    downloadUrl: function (params) {\n        var url = girder.apiRoot + '/' + (this.altUrl || this.resourceName) + '/' +\n            this.get('_id') + '/download';\n\n        if (params) {\n            url += '?' + $.param(params);\n        }\n\n        return url;\n    },\n\n    /**\n     * For models that can be downloaded, this method can be used to\n     * initiate the download in the browser.\n     */\n    download: function () {\n        window.location.assign(this.downloadUrl());\n    },\n\n    /**\n     * Delete the model on the server.\n     * @param opts Options, may contain:\n     *   throwError Whether to throw an error (bool, default=true)\n     *   progress Whether to record progress (bool, default=false)\n     */\n    destroy: function (opts) {\n        if (this.altUrl === null && this.resourceName === null) {\n            alert('Error: You must set an altUrl or a resourceName on your model.');\n            return;\n        }\n\n        var args = {\n            path: (this.altUrl || this.resourceName) + '/' + this.get('_id'),\n            type: 'DELETE'\n        };\n\n        opts = opts || {};\n        if (opts.progress === true) {\n            args.path += '?progress=true';\n        }\n\n        if (opts.throwError !== false) {\n            args.error = null;\n        }\n\n        girder.restRequest(args).done(_.bind(function () {\n            if (this.collection) {\n                this.collection.remove(this);\n            }\n            this.trigger('g:deleted');\n        }, this)).error(_.bind(function (err) {\n            this.trigger('g:error', err);\n        }, this));\n\n        return this;\n    },\n\n    /**\n     * Return the access level with respect to the current user\n     */\n    getAccessLevel: function () {\n        return this.get('_accessLevel');\n    }\n\n});\n\n/**\n * Models corresponding to AccessControlledModels on the server should extend\n * from this object. It provides utilities for managing and storing the\n * access control list on\n */\ngirder.AccessControlledModel = girder.Model.extend({\n    /**\n     * Saves the access control list on this model to the server. Saves the\n     * state of whatever this model's \"access\" parameter is set to, which\n     * should be an object of the form:\n     *    {groups: [{id: <groupId>, level: <accessLevel>}, ...],\n     *     users: [{id: <userId>, level: <accessLevel>}, ...]}\n     * The \"public\" attribute of this model should also be set as a boolean.\n     * When done, triggers the 'g:accessListSaved' event on the model.\n     */\n    updateAccess: function (params) {\n        if (this.altUrl === null && this.resourceName === null) {\n            alert('Error: You must set an altUrl or a resourceName on your model.');\n            return;\n        }\n\n        girder.restRequest({\n            path: (this.altUrl || this.resourceName) + '/' + this.get('_id') + '/access',\n            type: 'PUT',\n            data: _.extend({\n                access: JSON.stringify(this.get('access')),\n                public: this.get('public')\n            }, params || {})\n        }).done(_.bind(function () {\n            this.trigger('g:accessListSaved');\n        }, this)).error(_.bind(function (err) {\n            this.trigger('g:error', err);\n        }, this));\n\n        return this;\n    },\n\n    /**\n     * Fetches the access control list from the server, and sets it as the\n     * access property.\n     * @param force By default, this only fetches access if it hasn't already\n     *              been set on the model. If you want to force a refresh\n     *              anyway, set this param to true.\n     */\n    fetchAccess: function (force) {\n        if (this.altUrl === null && this.resourceName === null) {\n            alert('Error: You must set an altUrl or a resourceName on your model.');\n            return;\n        }\n\n        if (!this.get('access') || force) {\n            girder.restRequest({\n                path: (this.altUrl || this.resourceName) + '/' + this.get('_id') + '/access',\n                type: 'GET'\n            }).done(_.bind(function (resp) {\n                if (resp.access) {\n                    this.set(resp);\n                } else {\n                    this.set('access', resp);\n                }\n                this.trigger('g:accessFetched');\n            }, this)).error(_.bind(function (err) {\n                this.trigger('g:error', err);\n            }, this));\n        } else {\n            this.trigger('g:accessFetched');\n        }\n\n        return this;\n    }\n});\n\ngirder.models.MetadataMixin = {\n    _sendMetadata: function (metadata, successCallback, errorCallback, opts) {\n        opts = opts || {};\n        girder.restRequest({\n            path: opts.path ||\n                ((this.altUrl || this.resourceName) + '/' + this.get('_id') + '/metadata'),\n            contentType: 'application/json',\n            data: JSON.stringify(metadata),\n            type: 'PUT',\n            error: null\n        }).done(_.bind(function (resp) {\n            this.set(opts.field || 'meta', resp.meta);\n            if (_.isFunction(successCallback)) {\n                successCallback();\n            }\n        }, this)).error(_.bind(function (err) {\n            err.message = err.responseJSON.message;\n            if (_.isFunction(errorCallback)) {\n                errorCallback(err);\n            }\n        }, this));\n    },\n\n    addMetadata: function (key, value, successCallback, errorCallback, opts) {\n        opts = opts || {};\n        var datum = {};\n        datum[key] = value;\n        var meta = this.get(opts.field || 'meta');\n        if (meta && _.has(meta, key)) {\n            if (_.isFunction(errorCallback)) {\n                errorCallback({message: key + ' is already a metadata key'});\n            }\n        } else {\n            this._sendMetadata(datum, successCallback, errorCallback, opts);\n        }\n    },\n\n    removeMetadata: function (key, successCallback, errorCallback, opts) {\n        var datum = {};\n        datum[key] = null;\n        this._sendMetadata(datum, successCallback, errorCallback, opts);\n    },\n\n    editMetadata: function (newKey, oldKey, value, successCallback, errorCallback, opts) {\n        opts = opts || {};\n\n        if (newKey === oldKey) {\n            var datum = {};\n            datum[newKey] = value;\n            this._sendMetadata(datum, successCallback, errorCallback, opts);\n        } else {\n            if (_.has(this.get(opts.field || 'meta'), newKey)) {\n                if (_.isFunction(errorCallback)) {\n                    errorCallback({message: newKey + ' is already a metadata key'});\n                }\n            } else {\n                var metas = {};\n                metas[oldKey] = null;\n                metas[newKey] = value;\n                this._sendMetadata(metas, successCallback, errorCallback, opts);\n            }\n        }\n    }\n};\n","girder.models.ApiKeyModel = girder.AccessControlledModel.extend({\n    resourceName: 'api_key',\n\n    setActive: function (active) {\n        girder.restRequest({\n            path: 'api_key/' + this.id,\n            method: 'PUT',\n            data: {\n                active: active\n            }\n        }).done(_.bind(function () {\n            this.set({active: active});\n            this.trigger('g:setActive');\n        }, this));\n\n        return this;\n    },\n\n    save: function () {\n        // Scope needs to be sent to the server as JSON\n        var scope = this.get('scope');\n        this.attributes.scope = JSON.stringify(scope);\n        girder.AccessControlledModel.prototype.save.call(this, arguments);\n        // Restore scope to its original state\n        this.attributes.scope = scope;\n    }\n});\n","girder.models.AssetstoreModel = girder.Model.extend({\n    resourceName: 'assetstore',\n\n    capacityKnown: function () {\n        var cap = this.get('capacity');\n        return cap && cap.free !== null && cap.total !== null;\n    },\n\n    capacityString: function () {\n        var cap = this.get('capacity');\n        return girder.formatSize(cap.free) + ' free of ' +\n            girder.formatSize(cap.total) + ' total';\n    },\n\n    import: function (params) {\n        girder.restRequest({\n            path: 'assetstore/' + this.get('_id') + '/import',\n            type: 'POST',\n            data: params,\n            error: null\n        }).done(_.bind(function (resp) {\n            this.trigger('g:imported', resp);\n        }, this)).error(_.bind(function (resp) {\n            this.trigger('g:error', resp);\n        }, this));\n\n        return this;\n    },\n\n    save: function () {\n        if (_.isNumber(this.get('perms'))) {\n            // Coerce to an octal string to disambiguate\n            this.set('perms', this.get('perms').toString(8));\n        }\n        girder.Model.prototype.save.call(this, arguments);\n    }\n});\n","girder.models.CollectionModel = girder.AccessControlledModel.extend({\n    resourceName: 'collection'\n});\n","girder.models.FileModel = girder.Model.extend({\n    resourceName: 'file',\n    resumeInfo: null,\n\n    _wrapData: function (data, type) {\n        var wrapped = data;\n\n        if (!(data instanceof Blob)) {\n            if (!_.isArray(data)) {\n                wrapped = [data];\n            }\n            wrapped = new Blob(wrapped, {\n                type: type\n            });\n        }\n\n        return wrapped;\n    },\n\n    /**\n     * Upload into an existing file object (i.e. this model) to change its\n     * contents. This does not change the name or MIME type of the existing\n     * file.\n     * @param data A browser File object, browser Blob object, or raw data to be uploaded.\n     */\n    updateContents: function (data) {\n        data = this._wrapData(data);\n\n        this.upload(null, data, {\n            path: 'file/' + this.get('_id') + '/contents',\n            type: 'PUT',\n            data: {\n                size: data.size\n            }\n        });\n    },\n\n    /**\n     * Upload data to a new file in a given container\n     * @param Model A constructor for the parent model (either FolderModel or ItemModel).\n     * @param model The parent model to upload to, or a string containing the id thereof.\n     * @param data The data to upload - either a string, File object, or Blob object.\n     * @param name The name of the file to create (optional if data is a File).\n     * @param type The mime type of the file (optional).\n     */\n    _uploadToContainer: function (Model, model, data, name, type) {\n        if (_.isString(model)) {\n            model = new Model({\n                _id: model\n            });\n        }\n\n        data = this._wrapData(data, type);\n        data.name = name;\n\n        this.upload(model, data);\n    },\n\n    /**\n     * Upload data to a new file in a given folder\n     * @param parentFolder The parent folder to upload to, or a string containing the id thereof.\n     * @param data The data to upload - either a string, File object, or Blob object.\n     * @param name The name of the file to create (optional if data is a File).\n     * @param type The mime type of the file (optional).\n     */\n    uploadToFolder: function (parentFolder, data, name, type) {\n        this._uploadToContainer(girder.models.FolderModel, parentFolder, data, name, type);\n    },\n\n    /**\n     * Upload data to a new file in a given folder\n     * @param parentItem The parent item to upload to, or a string containing the id thereof.\n     * @param data The data to upload - either a string, File object, or Blob object.\n     * @param name The name of the file to create (optional if data is a File).\n     * @param type The mime type of the file (optional).\n     */\n    uploadToItem: function (parentItem, data, name, type) {\n        this._uploadToContainer(girder.models.ItemModel, parentItem, data, name, type);\n    },\n\n    /**\n     * Upload a file. Handles uploading into all of the core assetstore types.\n     * @param parentModel The parent folder or item to upload into.\n     * @param file The browser File object to be uploaded.\n     * @param [_restParams] Override the rest request parameters. This is meant\n     * for internal use; do not pass this parameter.\n     */\n    upload: function (parentModel, file, _restParams) {\n        this.startByte = 0;\n        this.resumeInfo = null;\n        this.uploadHandler = null;\n        _restParams = _restParams || {\n            path: 'file',\n            type: 'POST',\n            data: {\n                parentType: parentModel.resourceName,\n                parentId: parentModel.get('_id'),\n                name: file.name,\n                size: file.size,\n                mimeType: file.type\n            }\n        };\n\n        // Authenticate and generate the upload token for this file\n        girder.restRequest(_restParams).done(_.bind(function (upload) {\n            var behavior = upload.behavior;\n            if (behavior && girder.uploadHandlers[behavior]) {\n                this.uploadHandler = new girder.uploadHandlers[behavior]({\n                    upload: upload,\n                    parentModel: parentModel,\n                    file: file\n                });\n                this.uploadHandler.on({\n                    'g:upload.complete': function (params) {\n                        this.set(params);\n                        this.trigger('g:upload.complete', params);\n                        this.uploadHandler = null;\n                    },\n                    'g:upload.chunkSent': function (params) {\n                        this.trigger('g:upload.chunkSent', params);\n                    },\n                    'g:upload.error': function (params) {\n                        this.trigger('g:upload.error', params);\n                    },\n                    'g:upload.errorStarting': function (params) {\n                        this.trigger('g:upload.errorStarting', params);\n                    },\n                    'g:upload.progress': function (params) {\n                        this.trigger('g:upload.progress', {\n                            startByte: params.startByte,\n                            loaded: params.loaded,\n                            total: params.file.size,\n                            file: params.file\n                        });\n                    }\n                }, this);\n                return this.uploadHandler.execute();\n            }\n\n            if (file.size > 0) {\n                // Begin uploading chunks of this file\n                this._uploadChunk(file, upload._id);\n            } else {\n                // Empty file, so we are done\n                this.set(upload);\n                this.trigger('g:upload.complete');\n            }\n        }, this)).error(_.bind(function (resp) {\n            var text = 'Error: ', identifier;\n\n            if (resp.status === 0) {\n                text += 'Connection to the server interrupted.';\n            } else {\n                text += resp.responseJSON.message;\n                identifier = resp.responseJSON.identifier;\n            }\n            this.trigger('g:upload.errorStarting', {\n                message: text,\n                identifier: identifier,\n                response: resp\n            });\n        }, this));\n    },\n\n    /**\n     * If an error was triggered during the upload of this file, call this\n     * in order to attempt to resume it.\n     */\n    resumeUpload: function () {\n        if (this.uploadHandler !== null && this.uploadHandler.resume) {\n            return this.uploadHandler.resume();\n        }\n\n        // Request the actual offset we need to resume at\n        girder.restRequest({\n            path: 'file/offset',\n            type: 'GET',\n            data: {\n                uploadId: this.resumeInfo.uploadId\n            },\n            error: null\n        }).done(_.bind(function (resp) {\n            this.startByte = resp.offset;\n            this._uploadChunk(this.resumeInfo.file, this.resumeInfo.uploadId);\n        }, this)).error(_.bind(function (resp) {\n            var msg;\n\n            if (resp.status === 0) {\n                msg = 'Could not connect to the server.';\n            } else {\n                msg = 'An error occurred when resuming upload, check console.';\n            }\n            this.trigger('g:upload.error', {\n                message: msg,\n                response: resp\n            });\n        }, this));\n    },\n\n    abortUpload: function () {\n        if (!this.resumeInfo || !this.resumeInfo.uploadId) {\n            return;\n        }\n        girder.restRequest({\n            path: 'system/uploads',\n            type: 'DELETE',\n            data: {\n                uploadId: this.resumeInfo.uploadId\n            },\n            error: null,\n            done: null\n        });\n    },\n\n    _uploadChunk: function (file, uploadId) {\n        var endByte = Math.min(this.startByte + girder.UPLOAD_CHUNK_SIZE,\n                               file.size);\n\n        this.chunkLength = endByte - this.startByte;\n        var sliceFn = file.webkitSlice ? 'webkitSlice' : 'slice';\n        var blob = file[sliceFn](this.startByte, endByte);\n        var model = this;\n\n        var fd = new FormData();\n        fd.append('offset', this.startByte);\n        fd.append('uploadId', uploadId);\n        fd.append('chunk', blob);\n\n        girder._uploadId = uploadId;\n\n        girder.restRequest({\n            path: 'file/chunk',\n            type: 'POST',\n            dataType: 'json',\n            data: fd,\n            contentType: false,\n            processData: false,\n            success: function (resp) {\n                model.trigger('g:upload.chunkSent', {\n                    bytes: endByte - model.startByte\n                });\n\n                if (endByte === file.size) {\n                    model.startByte = 0;\n                    model.resumeInfo = null;\n                    model.set(resp);\n                    model.trigger('g:upload.complete');\n                } else {\n                    model.startByte = endByte;\n                    model._uploadChunk(file, uploadId);\n                }\n            },\n            error: function (resp) {\n                var text = 'Error: ', identifier;\n\n                if (resp.status === 0) {\n                    text += 'Connection to the server interrupted.';\n                } else {\n                    text += resp.responseJSON.message;\n                    identifier = resp.responseJSON.identifier;\n                }\n\n                model.resumeInfo = {\n                    uploadId: uploadId,\n                    file: file\n                };\n\n                model.trigger('g:upload.error', {\n                    message: text,\n                    identifier: identifier,\n                    response: resp\n                });\n            },\n            xhr: function () {\n                // Custom XHR so we can register a progress handler\n                var xhr = new window.XMLHttpRequest();\n                xhr.upload.addEventListener('progress', function (e) {\n                    model._uploadProgress(file, e);\n                });\n                return xhr;\n            }\n        });\n    },\n\n    /**\n     * Progress callback from XHR during upload. This will trigger useful\n     * progress events under the 'upload.progress' tag.\n     */\n    _uploadProgress: function (file, event) {\n        if (!event.lengthComputable) {\n            return;\n        }\n\n        // We only want to count bytes of the actual file, not the bytes of\n        // the request body corresponding to the other form parameters model\n        // we are also sending.\n        var loaded = this.chunkLength + event.loaded - event.total;\n\n        if (loaded >= 0) {\n            this.trigger('g:upload.progress', {\n                startByte: this.startByte,\n                loaded: loaded,\n                total: file.size,\n                file: file\n            });\n        }\n    }\n});\n","girder.models.FolderModel = girder.AccessControlledModel.extend({\n    resourceName: 'folder'\n});\n\n_.extend(girder.models.FolderModel.prototype, girder.models.MetadataMixin);\n","girder.models.GroupModel = girder.AccessControlledModel.extend({\n    resourceName: 'group',\n\n    /**\n     * Send an invitation to this group to the user identified by userId.\n     * Requires moderator (write) access on the group.\n     * @param userId The ID of the user to invite.\n     * @param accessType The access level to invite them as.\n     * @param request Set to true if this is accepting a user's request to join.\n     * @param [params] Additional parameters to pass with the request.\n     */\n    sendInvitation: function (userId, accessType, request, params) {\n        params = params || {};\n        girder.restRequest({\n            path: this.resourceName + '/' + this.get('_id') + '/invitation',\n            data: _.extend({\n                userId: userId,\n                level: accessType\n            }, params),\n            type: 'POST',\n            error: null\n        }).done(_.bind(function (resp) {\n            this.set(resp);\n\n            if (!request && userId === girder.currentUser.get('_id')) {\n                if (params.force) {\n                    girder.currentUser.addToGroup(this.get('_id'));\n                } else {\n                    girder.currentUser.addInvitation(this.get('_id'), accessType);\n                }\n            }\n            this.trigger('g:invited');\n        }, this)).error(_.bind(function (err) {\n            this.trigger('g:error', err);\n        }, this));\n    },\n\n    /**\n     * Accept an invitation to join a group. Only call this if the user has\n     * already been invited to the group.\n     */\n    joinGroup: function () {\n        girder.restRequest({\n            path: this.resourceName + '/' + this.get('_id') + '/member',\n            type: 'POST'\n        }).done(_.bind(function (resp) {\n            girder.currentUser.addToGroup(this.get('_id'));\n            girder.currentUser.removeInvitation(this.get('_id'));\n\n            this.set(resp);\n\n            this.trigger('g:joined');\n        }, this)).error(_.bind(function (err) {\n            this.trigger('g:error', err);\n        }, this));\n    },\n\n    /**\n     * This will create an invitation request on this group for the current\n     * user. Requires read access on the group. If the user already has an\n     * outstanding invitation to this group, call joinGroup instead.\n     */\n    requestInvitation: function () {\n        girder.restRequest({\n            path: this.resourceName + '/' + this.get('_id') + '/member',\n            type: 'POST'\n        }).done(_.bind(function (resp) {\n            this.set(resp);\n\n            this.trigger('g:inviteRequested');\n        }, this)).error(_.bind(function (err) {\n            this.trigger('g:error', err);\n        }, this));\n    },\n\n    /**\n     * Promote a user to moderator or administrator. Requires admin access\n     * on the group.\n     * @param user The user model of the user being promoted\n     * @param level The AccessLevel (WRITE or ADMIN) to promote to\n     */\n    promoteUser: function (user, level) {\n        var role;\n        if (level === girder.AccessType.WRITE) {\n            role = 'moderator';\n        } else if (level === girder.AccessType.ADMIN) {\n            role = 'admin';\n        }\n        girder.restRequest({\n            path: this.resourceName + '/' + this.get('_id') + '/' + role,\n            data: {\n                userId: user.get('_id')\n            },\n            type: 'POST'\n        }).done(_.bind(function (resp) {\n            this.set(resp);\n\n            this.trigger('g:promoted');\n        }, this)).error(_.bind(function (err) {\n            this.trigger('g:error', err);\n        }, this));\n    },\n\n    /**\n     * Demote a user to ordinary member status. Requires admin access on the\n     * group.\n     * @param userId The id of the user to demote.\n     * @param level The current access level of the user.\n     */\n    demoteUser: function (userId, level) {\n        var role;\n        if (level === girder.AccessType.WRITE) {\n            role = 'moderator';\n        } else if (level === girder.AccessType.ADMIN) {\n            role = 'admin';\n        }\n        girder.restRequest({\n            path: this.resourceName + '/' + this.get('_id') + '/' + role +\n                '?userId=' + userId,\n            type: 'DELETE'\n        }).done(_.bind(function (resp) {\n            this.set(resp);\n\n            this.trigger('g:demoted');\n        }, this)).error(_.bind(function (err) {\n            this.trigger('g:error', err);\n        }, this));\n    },\n\n    /**\n     * Remove a member of a group, or if the user is not already a member,\n     * this will simply delete any outstanding membership request or\n     * invitation for this user.\n     * @param userId The ID of the user to remove.\n     */\n    removeMember: function (userId) {\n        girder.restRequest({\n            path: this.resourceName + '/' + this.get('_id') +\n                  '/member?userId=' + userId,\n            type: 'DELETE'\n        }).done(_.bind(function (resp) {\n            if (userId === girder.currentUser.get('_id')) {\n                girder.currentUser.removeFromGroup(this.get('_id'));\n            }\n\n            this.set(resp);\n\n            this.trigger('g:removed');\n        }, this)).error(_.bind(function (err) {\n            this.trigger('g:error', err);\n        }, this));\n    },\n\n    /* Check if the current user has the authority in this group to directly\n     * add members.\n     *\n     * @returns: true if adding members is allowed.\n     */\n    mayAddMembers: function () {\n        if (girder.currentUser.get('admin')) {\n            return true;\n        }\n        var groupAddAllowed;\n        var addToGroupPolicy = this.get('_addToGroupPolicy');\n        if (addToGroupPolicy === 'nomod' || addToGroupPolicy === 'yesmod') {\n            groupAddAllowed = 'mod';\n        } else if (addToGroupPolicy === 'noadmin' || addToGroupPolicy === 'yesadmin') {\n            groupAddAllowed = 'admin';\n        } else {\n            return false;\n        }\n        var addAllowed = this.get('addAllowed') || '';\n        if (addAllowed === 'no' || (addToGroupPolicy.substr(0, 3) !== 'yes' &&\n                addAllowed.substr(0, 3) !== 'yes')) {\n            return false;\n        }\n        if (addAllowed === 'yesadmin') {\n            groupAddAllowed = 'admin';\n        }\n        if (groupAddAllowed === 'admin' &&\n                this.get('_accessLevel') >= girder.AccessType.ADMIN) {\n            return true;\n        }\n        if (groupAddAllowed === 'mod' &&\n                this.get('_accessLevel') >= girder.AccessType.WRITE) {\n            return true;\n        }\n        return false;\n    }\n});\n","girder.models.ItemModel = girder.Model.extend({\n    resourceName: 'item',\n\n    /**\n     * Get the access level of the item if it is set. Takes an optional callback\n     * to be called once the access level is fetched (or immediately if it has\n     * already been fetched).\n     */\n    getAccessLevel: function (callback) {\n        callback = callback || $.noop;\n\n        if (this.has('_accessLevel')) {\n            callback(this.get('_accessLevel'));\n            return this.get('_accessLevel');\n        }\n        if (this.parent && this.parent.getAccessLevel()) {\n            this.set('_accessLevel', this.parent.getAccessLevel());\n            callback(this.get('_accessLevel'));\n            return this.get('_accessLevel');\n        } else {\n            this.parent = new girder.models.FolderModel();\n            this.parent.set({\n                _id: this.get('folderId')\n            }).once('g:fetched', function () {\n                this.set('_accessLevel', this.parent.getAccessLevel());\n                callback(this.get('_accessLevel'));\n            }, this).fetch();\n        }\n    },\n\n    /**\n     * Get the path to the root of the hierarchy\n     */\n    getRootPath: function (callback) {\n        girder.restRequest({\n            path: this.resourceName + '/' + this.get('_id') + '/rootpath'\n        }).done(_.bind(function (resp) {\n            callback(resp);\n        }, this)).error(_.bind(function (err) {\n            this.trigger('g:error', err);\n        }, this));\n    }\n});\n\n_.extend(girder.models.ItemModel.prototype, girder.models.MetadataMixin);\n","girder.models.UserModel = girder.Model.extend({\n    resourceName: 'user',\n\n    /**\n     * Calling this function mutates the model in one of two ways: (1) if a user\n     * is currently logged into Girder, the model will reflect that user; (2) if\n     * no user is logged in, the model will become clear.  To know which path\n     * occurred, you can call this method, then install a one-time event handler\n     * for the model's change event.  In that handler, calling isNew() on the\n     * model will tell if you if a user is logged in (false) or not (true).\n     *\n     * This is equivalent to invoking girder.fetchCurrentUser(), then calling\n     * clear() or set() on the model depending on whether the result of the call\n     * is null or not.\n     */\n    current: function () {\n        girder.fetchCurrentUser()\n            .then(_.bind(function (user) {\n                if (user) {\n                    this.set(user);\n                } else {\n                    this.clear();\n                }\n            }, this));\n    },\n\n    name: function () {\n        return this.get('firstName') + ' ' + this.get('lastName');\n    },\n\n    /**\n     * When this user is added to a group, call this on the user model.\n     */\n    addToGroup: function (groupId) {\n        var groups = this.get('groups') || [];\n        groups.push(groupId);\n        this.set('groups', groups);\n    },\n\n    /**\n     * When this user is removed from a group, call this on the user model.\n     */\n    removeFromGroup: function (groupId) {\n        var groups = this.get('groups') || [];\n        var index = groups.indexOf(groupId);\n\n        while (index >= 0) {\n            groups.splice(index, 1);\n            index = groups.indexOf(groupId);\n        }\n\n        this.set('groups', groups);\n    },\n\n    /**\n     * When this user is invited to a group, call this on the user model.\n     */\n    addInvitation: function (groupId, level) {\n        var invites = this.get('groupInvites') || [];\n        invites.push({\n            groupId: groupId,\n            level: level\n        });\n\n        this.set('groupInvites', invites);\n    },\n\n    /**\n     * When this user's invitation is deleted, either by joining the group or\n     * having the invitation deleted manually, this should be called on the user\n     * model.\n     */\n    removeInvitation: function (groupId) {\n        var invites = this.get('groupInvites') || [];\n        var filtered = [];\n\n        _.each(invites, function (invite) {\n            if (invite.groupId !== groupId) {\n                filtered.push(invite);\n            }\n        }, this);\n\n        this.set('groupInvites', filtered);\n    },\n\n    /**\n     * Change the password for this user.\n     */\n    changePassword: function (oldPassword, newPassword) {\n        girder.restRequest({\n            path: this.resourceName + '/password',\n            data: {\n                old: oldPassword,\n                new: newPassword\n            },\n            type: 'PUT',\n            error: null\n        }).done(_.bind(function () {\n            this.trigger('g:passwordChanged');\n        }, this)).error(_.bind(function (err) {\n            this.trigger('g:error', err);\n        }, this));\n    },\n\n    /**\n     * Change the password for another user (as an admin).\n     */\n    adminChangePassword: function (newPassword) {\n        girder.restRequest({\n            path: this.resourceName + '/' + this.id + '/password',\n            data: {\n                password: newPassword\n            },\n            type: 'PUT',\n            error: null\n        }).done(_.bind(function () {\n            this.trigger('g:passwordChanged');\n        }, this)).error(_.bind(function (err) {\n            this.trigger('g:error', err);\n        }, this));\n    }\n});\n","girder.collections.ApiKeyCollection = girder.Collection.extend({\n    resourceName: 'api_key',\n    model: girder.models.ApiKeyModel\n});\n","girder.collections.AssetstoreCollection = girder.Collection.extend({\n    resourceName: 'assetstore',\n    model: girder.models.AssetstoreModel\n});\n","girder.collections.CollectionCollection = girder.Collection.extend({\n    resourceName: 'collection',\n    model: girder.models.CollectionModel\n});\n","girder.collections.FileCollection = girder.Collection.extend({\n    resourceName: 'file',\n\n    model: girder.models.FileModel,\n\n    pageLimit: 100\n});\n","girder.collections.FolderCollection = girder.Collection.extend({\n    resourceName: 'folder',\n    model: girder.models.FolderModel,\n\n    pageLimit: 100\n});\n","girder.collections.GroupCollection = girder.Collection.extend({\n    resourceName: 'group',\n    model: girder.models.GroupModel\n});\n","girder.collections.ItemCollection = girder.Collection.extend({\n    resourceName: 'item',\n    model: girder.models.ItemModel,\n\n    pageLimit: 100\n});\n","girder.collections.UserCollection = girder.Collection.extend({\n    resourceName: 'user',\n    model: girder.models.UserModel,\n\n    // Override default sort field\n    sortField: 'lastName',\n    secondarySortField: 'firstName'\n});\n","/**\n * This view shows the admin console, which links to all available admin pages.\n */\ngirder.views.AdminView = girder.View.extend({\n    events: {\n        'click .g-server-config': function () {\n            girder.router.navigate('settings', {trigger: true});\n        },\n        'click .g-assetstore-config': function () {\n            girder.router.navigate('assetstores', {trigger: true});\n        },\n        'click .g-plugins-config': function () {\n            girder.router.navigate('plugins', {trigger: true});\n        }\n    },\n\n    initialize: function () {\n        girder.cancelRestRequests('fetch');\n        this.render();\n    },\n\n    render: function () {\n        if (!girder.currentUser || !girder.currentUser.get('admin')) {\n            this.$el.text('Must be logged in as admin to view this page.');\n            return;\n        }\n        this.$el.html(girder.templates.adminConsole());\n\n        return this;\n    }\n});\n\ngirder.router.route('admin', 'admin', function () {\n    girder.events.trigger('g:navigateTo', girder.views.AdminView);\n});\n","/**\n * This view shows the admin console, which links to all available admin pages.\n */\ngirder.views.AssetstoresView = girder.View.extend({\n    events: {\n        'click .g-set-current': 'setCurrentAssetstore',\n        'click .g-delete-assetstore': 'deleteAssetstore',\n        'click .g-edit-assetstore': 'editAssetstore'\n    },\n\n    initialize: function (settings) {\n        girder.cancelRestRequests('fetch');\n        this.assetstoreEdit = settings.assetstoreEdit || false;\n        this.importableTypes = [\n            girder.AssetstoreType.FILESYSTEM,\n            girder.AssetstoreType.S3\n        ].concat(settings.importableTypes || []);\n\n        this.newAssetstoreWidget = new girder.views.NewAssetstoreWidget({\n            parentView: this\n        }).on('g:created', this.addAssetstore, this);\n\n        // Fetch all of the current assetstores\n        this.collection = new girder.collections.AssetstoreCollection();\n        this.collection.on('g:changed', function () {\n            this.render();\n        }, this).fetch();\n    },\n\n    render: function () {\n        if (!girder.currentUser || !girder.currentUser.get('admin')) {\n            this.$el.text('Must be logged in as admin to view this page.');\n            return;\n        }\n        this.$el.html(girder.templates.assetstores({\n            assetstores: this.collection.toArray(),\n            types: girder.AssetstoreType,\n            importableTypes: this.importableTypes,\n            getAssetstoreImportRoute: this.getAssetstoreImportRoute\n        }));\n\n        this.newAssetstoreWidget.setElement(this.$('#g-new-assetstore-container')).render();\n        this.$('.g-assetstore-button-container[title]').tooltip();\n\n        _.each(this.$('.g-assetstore-capacity-chart'),\n            this.capacityChart, this);\n\n        if (this.assetstoreEdit) {\n            this.editAssetstoreDialog(this.assetstoreEdit);\n            this.assetstoreEdit = false;\n        }\n\n        return this;\n    },\n\n    addAssetstore: function (assetstore) {\n        this.collection.add(assetstore);\n        this.render();\n    },\n\n    /**\n     * Renders the capacities of the assetstores in a pie chart using Chart.js.\n     * @param el The canvas element to render in.\n     */\n    capacityChart: function (el) {\n        var assetstore = this.collection.get($(el).attr('cid'));\n        var capacity = assetstore.get('capacity');\n        var used = capacity.total - capacity.free;\n        var data = [\n            ['Used (' + girder.formatSize(used) + ')', used],\n            ['Free (' + girder.formatSize(capacity.free) + ')', capacity.free]\n        ];\n        $(el).jqplot([data], {\n            seriesDefaults: {\n                renderer: $.jqplot.PieRenderer,\n                rendererOptions: {\n                    sliceMargin: 2,\n                    shadow: false,\n                    highlightMouseOver: false,\n                    showDataLabels: true,\n                    padding: 5,\n                    startAngle: 180\n                }\n            },\n            legend: {\n                show: true,\n                location: 'e',\n                background: 'transparent',\n                border: 'none'\n            },\n            grid: {\n                background: 'transparent',\n                border: 'none',\n                borderWidth: 0,\n                shadow: false\n            },\n            gridPadding: {top: 10, right: 10, bottom: 10, left: 10}\n        });\n    },\n\n    setCurrentAssetstore: function (evt) {\n        var el = $(evt.currentTarget);\n        var assetstore = this.collection.get(el.attr('cid'));\n        assetstore.set({current: true});\n        assetstore.off('g:saved').on('g:saved', function () {\n            girder.events.trigger('g:alert', {\n                icon: 'ok',\n                text: 'Changed current assetstore.',\n                type: 'success',\n                timeout: 4000\n            });\n            this.collection.fetch({}, true);\n        }, this).off('g:error').on('g:error', function (err) {\n            girder.events.trigger('g:alert', {\n                icon: 'cancel',\n                text: err.responseJSON.message,\n                type: 'danger'\n            });\n        }).save();\n    },\n\n    deleteAssetstore: function (evt) {\n        var el = $(evt.currentTarget);\n        var assetstore = this.collection.get(el.attr('cid'));\n\n        girder.confirm({\n            text: 'Are you sure you want to delete the assetstore <b>' +\n                  assetstore.escape('name') + '</b>?  There are no files ' +\n                  'stored in it, and no data will be lost.',\n            escapedHtml: true,\n            yesText: 'Delete',\n            confirmCallback: _.bind(function () {\n                assetstore.on('g:deleted', function () {\n                    girder.events.trigger('g:alert', {\n                        icon: 'ok',\n                        text: 'Assetstore deleted.',\n                        type: 'success',\n                        timeout: 4000\n                    });\n                    this.collection.fetch({}, true);\n                }, this).off('g:error').on('g:error', function (resp) {\n                    girder.events.trigger('g:alert', {\n                        icon: 'attention',\n                        text: resp.responseJSON.message,\n                        type: 'danger',\n                        timeout: 4000\n                    });\n                }, this).destroy();\n            }, this)\n        });\n    },\n\n    editAssetstore: function (evt) {\n        var cid = $(evt.currentTarget).attr('cid');\n        this.editAssetstoreDialog(cid);\n    },\n\n    editAssetstoreDialog: function (cid) {\n        var assetstore = this.collection.get(cid);\n        var container = $('#g-dialog-container');\n\n        var editAssetstoreWidget = new girder.views.EditAssetstoreWidget({\n            el: container,\n            model: assetstore,\n            parentView: this\n        }).off('g:saved').on('g:saved', function () {\n            this.render();\n        }, this);\n        editAssetstoreWidget.render();\n    }\n});\n\n/**\n * This data structure is a dynamic way to map assetstore types to the views\n * that should be rendered to import data into them.\n */\ngirder.assetstoreImportViewMap = {};\ngirder.assetstoreImportViewMap[girder.AssetstoreType.FILESYSTEM] = 'FilesystemImportView';\ngirder.assetstoreImportViewMap[girder.AssetstoreType.S3] = 'S3ImportView';\n\ngirder.router.route('assetstores', 'assetstores', function (params) {\n    girder.events.trigger('g:navigateTo', girder.views.AssetstoresView, {\n        assetstoreEdit: params.dialog === 'assetstoreedit'\n                        ? params.dialogid : false\n    });\n});\n\ngirder.router.route('assetstore/:id/import', 'assetstoreImport', function (assetstoreId) {\n    var assetstore = new girder.models.AssetstoreModel({\n        _id: assetstoreId\n    });\n\n    assetstore.once('g:fetched', function () {\n        var viewName = girder.assetstoreImportViewMap[assetstore.get('type')],\n            view = girder.views[viewName];\n\n        if (!view) {\n            throw 'No such view: ' + viewName;\n        }\n        girder.events.trigger('g:navigateTo', view, {\n            assetstore: assetstore\n        });\n    }).fetch();\n});\n","(function () {\n    /**\n     * This view shows a single collection's page.\n     */\n    girder.views.CollectionView = girder.View.extend({\n        events: {\n            'click .g-edit-collection': 'editCollection',\n            'click .g-collection-access-control': 'editAccess',\n            'click .g-delete-collection': function () {\n                girder.confirm({\n                    text: 'Are you sure you want to delete the collection <b>' +\n                          this.model.escape('name') + '</b>?',\n                    yesText: 'Delete',\n                    escapedHtml: true,\n                    confirmCallback: _.bind(function () {\n                        this.model.destroy().on('g:deleted', function () {\n                            girder.events.trigger('g:alert', {\n                                icon: 'ok',\n                                text: 'Collection deleted.',\n                                type: 'success',\n                                timeout: 4000\n                            });\n                            girder.router.navigate('collections', {trigger: true});\n                        });\n                    }, this)\n                });\n            }\n        },\n\n        initialize: function (settings) {\n            girder.cancelRestRequests('fetch');\n\n            this.upload = settings.upload || false;\n            this.access = settings.access || false;\n            this.edit = settings.edit || false;\n            this.folderAccess = settings.folderAccess || false;\n            this.folderCreate = settings.folderCreate || false;\n            this.folderEdit = settings.folderEdit || false;\n            this.itemCreate = settings.itemCreate || false;\n\n            // If collection model is already passed, there is no need to fetch.\n            if (settings.collection) {\n                this.model = settings.collection;\n\n                if (settings.folderId) {\n                    this.folder = new girder.models.FolderModel();\n                    this.folder.set({\n                        _id: settings.folderId\n                    }).on('g:fetched', function () {\n                        this._createHierarchyWidget();\n                        this.render();\n                    }, this).on('g:error', function () {\n                        this.folder = null;\n                        this._createHierarchyWidget();\n                        this.render();\n                    }, this).fetch();\n                } else {\n                    this._createHierarchyWidget();\n                    this.render();\n                }\n            } else if (settings.id) {\n                this.model = new girder.models.CollectionModel();\n                this.model.set('_id', settings.id);\n\n                this.model.on('g:fetched', function () {\n                    this._createHierarchyWidget();\n                    this.render();\n                }, this).fetch();\n            }\n        },\n\n        _createHierarchyWidget: function () {\n            this.hierarchyWidget = new girder.views.HierarchyWidget({\n                parentModel: this.folder || this.model,\n                upload: this.upload,\n                folderAccess: this.folderAccess,\n                folderEdit: this.folderEdit,\n                folderCreate: this.folderCreate,\n                itemCreate: this.itemCreate,\n                parentView: this\n            }).on('g:setCurrentModel', function () {\n                // When a user descends into the hierarchy, hide the collection\n                // actions list to avoid confusion.\n                this.$('.g-collection-header .g-collection-actions-button').hide();\n            }, this);\n        },\n\n        editCollection: function () {\n            var container = $('#g-dialog-container');\n\n            if (!this.editCollectionWidget) {\n                this.editCollectionWidget = new girder.views.EditCollectionWidget({\n                    el: container,\n                    model: this.model,\n                    parentView: this\n                }).on('g:saved', function () {\n                    this.render();\n                }, this);\n            }\n            this.editCollectionWidget.render();\n        },\n\n        render: function () {\n            this.$el.html(girder.templates.collectionPage({\n                collection: this.model,\n                girder: girder\n            }));\n\n            this.hierarchyWidget.setElement(\n                this.$('.g-collection-hierarchy-container')).render();\n\n            this.upload = false;\n            this.folderAccess = false;\n            this.folderEdit = false;\n            this.folderCreate = false;\n            this.itemCreate = false;\n\n            this.$('.g-collection-actions-button').tooltip({\n                container: 'body',\n                placement: 'left',\n                animation: false,\n                delay: {show: 100}\n            });\n\n            if (this.edit) {\n                this.editCollection();\n            } else if (this.access) {\n                this.editAccess();\n            }\n\n            return this;\n        },\n\n        editAccess: function () {\n            new girder.views.AccessWidget({\n                el: $('#g-dialog-container'),\n                modelType: 'collection',\n                model: this.model,\n                parentView: this\n            }).on('g:accessListSaved', function (params) {\n                if (params.recurse) {\n                    this.hierarchyWidget.refreshFolderList();\n                }\n            }, this);\n        }\n    });\n\n    /**\n     * Helper function for fetching the user and rendering the view with\n     * an arbitrary set of extra parameters.\n     */\n    var _fetchAndInit = function (collectionId, params) {\n        var collection = new girder.models.CollectionModel();\n        collection.set({\n            _id: collectionId\n        }).on('g:fetched', function () {\n            girder.events.trigger('g:navigateTo', girder.views.CollectionView, _.extend({\n                collection: collection\n            }, params || {}));\n        }, this).fetch();\n    };\n\n    girder.router.route('collection/:id', 'collectionAccess', function (collectionId, params) {\n        _fetchAndInit(collectionId, {\n            access: params.dialog === 'access',\n            edit: params.dialog === 'edit',\n            folderCreate: params.dialog === 'foldercreate',\n            dialog: params.dialog\n        });\n    });\n\n    girder.router.route('collection/:id/folder/:id', 'collectionFolder',\n        function (collectionId, folderId, params) {\n            _fetchAndInit(collectionId, {\n                folderId: folderId,\n                upload: params.dialog === 'upload',\n                access: params.dialog === 'access',\n                edit: params.dialog === 'edit',\n                folderAccess: params.dialog === 'folderaccess',\n                folderCreate: params.dialog === 'foldercreate',\n                folderEdit: params.dialog === 'folderedit',\n                itemCreate: params.dialog === 'itemcreate'\n            });\n        });\n}());\n","/**\n * This view lists the collections.\n */\ngirder.views.CollectionsView = girder.View.extend({\n    events: {\n        'click a.g-collection-link': function (event) {\n            var cid = $(event.currentTarget).attr('g-collection-cid');\n            girder.router.navigate('collection/' + this.collection.get(cid).id, {trigger: true});\n        },\n        'click button.g-collection-create-button': 'createCollectionDialog',\n        'submit .g-collections-search-form': function (event) {\n            event.preventDefault();\n        }\n    },\n\n    initialize: function (settings) {\n        girder.cancelRestRequests('fetch');\n        this.collection = new girder.collections.CollectionCollection();\n        this.collection.on('g:changed', function () {\n            this.render();\n        }, this).fetch();\n\n        this.paginateWidget = new girder.views.PaginateWidget({\n            collection: this.collection,\n            parentView: this\n        });\n\n        this.searchWidget = new girder.views.SearchFieldWidget({\n            placeholder: 'Search collections...',\n            types: ['collection'],\n            parentView: this\n        }).on('g:resultClicked', this._gotoCollection, this);\n\n        this.create = settings.dialog === 'create';\n    },\n\n    /**\n     * Prompt the user to create a new collection\n     */\n    createCollectionDialog: function () {\n        var container = $('#g-dialog-container');\n\n        new girder.views.EditCollectionWidget({\n            el: container,\n            parentView: this\n        }).on('g:saved', function (collection) {\n            girder.router.navigate('collection/' + collection.get('_id'),\n                                   {trigger: true});\n        }, this).render();\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.collectionList({\n            collections: this.collection.toArray(),\n            girder: girder\n        }));\n\n        this.paginateWidget.setElement(this.$('.g-collection-pagination')).render();\n        this.searchWidget.setElement(this.$('.g-collections-search-container')).render();\n\n        if (this.create) {\n            this.createCollectionDialog();\n        }\n\n        return this;\n    },\n\n    /**\n     * When the user clicks a search result collection, this helper method\n     * will navigate them to the view for that specific collection.\n     */\n    _gotoCollection: function (result) {\n        var collection = new girder.models.CollectionModel();\n        collection.set('_id', result.id).on('g:fetched', function () {\n            girder.router.navigate('/collection/' + collection.get('_id'), {trigger: true});\n        }, this).fetch();\n    }\n});\n\ngirder.router.route('collections', 'collections', function (params) {\n    girder.events.trigger('g:navigateTo', girder.views.CollectionsView, params || {});\n    girder.events.trigger('g:highlightItem', 'CollectionsView');\n});\n","girder.views.FilesystemImportView = girder.View.extend({\n    events: {\n        'submit .g-filesystem-import-form': function (e) {\n            e.preventDefault();\n\n            var destId = this.$('#g-filesystem-import-dest-id').val().trim(),\n                destType = this.$('#g-filesystem-import-dest-type').val(),\n                foldersAsItems = this.$('#g-filesystem-import-leaf-items').val();\n\n            this.$('.g-validation-failed-message').empty();\n\n            this.assetstore.off('g:imported').on('g:imported', function () {\n                girder.router.navigate(destType + '/' + destId, {trigger: true});\n            }, this).on('g:error', function (resp) {\n                this.$('.g-validation-failed-message').text(resp.responseJSON.message);\n            }, this).import({\n                importPath: this.$('#g-filesystem-import-path').val().trim(),\n                leafFoldersAsItems: foldersAsItems,\n                destinationId: destId,\n                destinationType: destType,\n                progress: true\n            });\n        },\n        'click .g-open-browser': '_openBrowser'\n    },\n\n    initialize: function (settings) {\n        this._browserWidgetView = new girder.views.BrowserWidget({\n            parentView: this,\n            titleText: 'Destination',\n            helpText: 'Browse to a location to select it as the destination.',\n            submitText: 'Select Destination',\n            validate: function (id) {\n                if (!id) {\n                    return 'Please select a valid root.';\n                }\n            }\n        });\n        this.listenTo(this._browserWidgetView, 'g:saved', function (val) {\n            this.$('#g-filesystem-import-dest-id').val(val);\n        });\n        this.assetstore = settings.assetstore;\n        this.render();\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.filesystemImport({\n            assetstore: this.assetstore\n        }));\n    },\n\n    _openBrowser: function () {\n        this._browserWidgetView.setElement($('#g-dialog-container')).render();\n    }\n});\n","/**\n * This view shows a single folder as a hierarchy widget.\n */\ngirder.views.FolderView = girder.View.extend({\n    initialize: function (settings) {\n        girder.cancelRestRequests('fetch');\n        this.folder = settings.folder;\n        this.upload = settings.upload || false;\n        this.folderAccess = settings.folderAccess || false;\n        this.folderCreate = settings.folderCreate || false;\n        this.folderEdit = settings.folderEdit || false;\n        this.itemCreate = settings.itemCreate || false;\n\n        this.hierarchyWidget = new girder.views.HierarchyWidget({\n            parentModel: this.folder,\n            upload: this.upload,\n            folderAccess: this.folderAccess,\n            folderEdit: this.folderEdit,\n            folderCreate: this.folderCreate,\n            itemCreate: this.itemCreate,\n            parentView: this\n        });\n\n        this.render();\n    },\n\n    render: function () {\n        this.hierarchyWidget.setElement(this.$el).render();\n        return this;\n    }\n});\n\ngirder.router.route('folder/:id', 'folder', function (id, params) {\n    // Fetch the folder by id, then render the view.\n    var folder = new girder.models.FolderModel();\n    folder.set({\n        _id: id\n    }).on('g:fetched', function () {\n        girder.events.trigger('g:navigateTo', girder.views.FolderView, _.extend({\n            folder: folder,\n            upload: params.dialog === 'upload',\n            folderAccess: params.dialog === 'folderaccess',\n            folderCreate: params.dialog === 'foldercreate',\n            folderEdit: params.dialog === 'folderedit',\n            itemCreate: params.dialog === 'itemcreate'\n        }, params || {}));\n    }, this).fetch();\n});\n","/**\n * This is the view for the front page of the app.\n */\ngirder.views.FrontPageView = girder.View.extend({\n    events: {\n        'click .g-register-link': function () {\n            girder.events.trigger('g:registerUi');\n        },\n        'click .g-login-link': function () {\n            girder.events.trigger('g:loginUi');\n        },\n        'click .g-collections-link': function () {\n            girder.router.navigate('collections', {trigger: true});\n        },\n        'click .g-quicksearch-link': function () {\n            $('.g-quick-search-container .g-search-field').focus();\n        },\n        'click .g-my-account-link': function () {\n            girder.router.navigate('useraccount/' + girder.currentUser.get('_id') +\n                                   '/info', {trigger: true});\n        },\n        'click .g-my-folders-link': function () {\n            girder.router.navigate('user/' + girder.currentUser.get('_id'), {trigger: true});\n        }\n    },\n\n    initialize: function () {\n        girder.cancelRestRequests('fetch');\n        this.render();\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.frontPage({\n            apiRoot: girder.apiRoot,\n            staticRoot: girder.staticRoot,\n            currentUser: girder.currentUser,\n            versionInfo: girder.versionInfo\n        }));\n\n        return this;\n    }\n});\n\ngirder.router.route('', 'index', function () {\n    girder.events.trigger('g:navigateTo', girder.views.FrontPageView);\n});\n","(function () {\n    /**\n     * This view shows a single group's page.\n     */\n    girder.views.GroupView = girder.View.extend({\n        events: {\n            'click .g-edit-group': 'editGroup',\n            'click .g-group-join': 'joinGroup',\n            'click .g-group-leave': 'leaveGroup',\n            'click .g-group-delete': 'deleteGroup',\n            'click .g-group-request-invite': 'requestInvitation',\n            'click .g-group-request-accept': 'acceptMembershipRequest',\n            'click .g-group-request-deny': 'denyMembershipRequest',\n\n            'click #g-group-tab-pending a.g-member-name': function (e) {\n                var userId = $(e.currentTarget).parents('li').attr('userid');\n                girder.router.navigate('user/' + userId, {trigger: true});\n            }\n        },\n\n        initialize: function (settings) {\n            girder.cancelRestRequests('fetch');\n            this.tab = settings.tab || 'roles';\n            this.edit = settings.edit || false;\n\n            // If group model is already passed, there is no need to fetch.\n            if (settings.group) {\n                this.model = settings.group;\n                this.model.on('g:accessFetched', function () {\n                    this.render();\n                }, this).fetchAccess();\n            } else if (settings.id) {\n                this.model = new girder.models.GroupModel();\n                this.model.set('_id', settings.id);\n\n                this.model.on('g:fetched', function () {\n                    this.model.on('g:accessFetched', function () {\n                        this.render();\n                    }, this).fetchAccess();\n                }, this).fetch();\n            }\n        },\n\n        editGroup: function () {\n            var container = $('#g-dialog-container');\n\n            if (!this.editGroupWidget) {\n                this.editGroupWidget = new girder.views.EditGroupWidget({\n                    el: container,\n                    model: this.model,\n                    parentView: this\n                }).off('g:saved').on('g:saved', function () {\n                    this.render();\n                }, this);\n            }\n            this.editGroupWidget.render();\n        },\n\n        deleteGroup: function () {\n            var view = this;\n            girder.confirm({\n                text: 'Are you sure you want to delete the group <b>' +\n                    view.model.escape('name') + '</b>?',\n                escapedHtml: true,\n                confirmCallback: function () {\n                    view.model.on('g:deleted', function () {\n                        girder.router.navigate('groups', {trigger: true});\n                    }).destroy();\n                }\n            });\n        },\n\n        render: function () {\n            this.isMember = false;\n            this.isInvited = false;\n            this.isRequested = false;\n            this.isModerator = false;\n            this.isAdmin = false;\n\n            if (girder.currentUser) {\n                _.every(girder.currentUser.get('groups'), function (groupId) {\n                    if (groupId === this.model.get('_id')) {\n                        this.isMember = true;\n                        return false; // 'break;'\n                    }\n                    return true;\n                }, this);\n\n                _.every(girder.currentUser.get('groupInvites'), function (inv) {\n                    if (inv.groupId === this.model.get('_id')) {\n                        this.isInvited = true;\n                        return false; // 'break;'\n                    }\n                    return true;\n                }, this);\n\n                _.every(this.model.get('requests') || [], function (user) {\n                    if (user.id === girder.currentUser.get('_id')) {\n                        this.isRequested = true;\n                        return false; // 'break;'\n                    }\n                    return true;\n                }, this);\n            }\n\n            if (this.isMember) {\n                _.every(this.model.get('access').users || [], function (access) {\n                    if (access.id === girder.currentUser.get('_id')) {\n                        if (access.level === girder.AccessType.WRITE) {\n                            this.isModerator = true;\n                        } else if (access.level === girder.AccessType.ADMIN) {\n                            this.isAdmin = true;\n                        }\n                        return false; // 'break';\n                    }\n                    return true;\n                }, this);\n            }\n            this.$el.html(girder.templates.groupPage({\n                group: this.model,\n                girder: girder,\n                isInvited: this.isInvited,\n                isRequested: this.isRequested,\n                isMember: this.isMember,\n                isModerator: this.isModerator,\n                isAdmin: this.isAdmin\n            }));\n\n            if (this.invitees) {\n                this._renderInvitesWidget();\n            } else {\n                var container = this.$('.g-group-invites-body');\n                new girder.views.LoadingAnimation({\n                    el: container,\n                    parentView: this\n                }).render();\n\n                this.invitees = new girder.collections.UserCollection();\n                this.invitees.altUrl =\n                    'group/' + this.model.get('_id') + '/invitation';\n                var view = this;\n                this.invitees.on('g:changed', function () {\n                    this._renderInvitesWidget();\n                    view.updatePendingStatus();\n                }, this).fetch();\n            }\n\n            this._updateRolesLists();\n\n            this.$('.g-group-actions-button,a[title]').tooltip({\n                container: this.$el,\n                placement: 'left',\n                animation: false,\n                delay: {show: 100}\n            });\n            this.$('.g-group-list-header[title]').tooltip({\n                container: this.$el,\n                placement: 'top',\n                animation: false,\n                delay: {show: 100}\n            });\n\n            girder.router.navigate('group/' + this.model.get('_id') + '/' +\n                                   this.tab, {replace: true});\n\n            if (this.edit) {\n                if (this.model.get('_accessLevel') >= girder.AccessType.ADMIN) {\n                    this.editGroup();\n                }\n                this.edit = false;\n            }\n\n            _.each($('.g-group-tabs>li>a'), function (el) {\n                var tabLink = $(el);\n                var view = this;\n                tabLink.tab().on('shown.bs.tab', function (e) {\n                    view.tab = $(e.currentTarget).attr('name');\n                    girder.router.navigate('group/' + view.model.get('_id') + '/' + view.tab);\n                });\n\n                if (tabLink.attr('name') === this.tab) {\n                    tabLink.tab('show');\n                }\n            }, this);\n\n            return this;\n        },\n\n        _renderInvitesWidget: function () {\n            new girder.views.GroupInvitesWidget({\n                el: this.$('.g-group-invites-body'),\n                invitees: this.invitees,\n                group: this.model,\n                parentView: this\n            }).render();\n            this.updatePendingStatus();\n        },\n\n        updatePendingStatus: function () {\n            var count = this.invitees.length +\n                this.model.get('requests').length;\n            $('#g-group-tab-pending-status').text(' (' + count + ')');\n        },\n\n        joinGroup: function () {\n            this.model.off('g:joined').on('g:joined', function () {\n                this.invitees.fetch(null, true);\n            }, this).joinGroup();\n        },\n\n        leaveGroup: function () {\n            var view = this;\n            girder.confirm({\n                text: 'Are you sure you want to leave this group?',\n                confirmCallback: function () {\n                    view.model.off('g:removed').on('g:removed', function () {\n                        view.render();\n                    }).removeMember(girder.currentUser.get('_id'));\n                }\n            });\n        },\n\n        removeMember: function (user) {\n            var id = user;\n            if ($.type(user) !== 'string') {\n                id = user.get('_id');\n            }\n            this.model.off('g:removed').on('g:removed', function () {\n                this.render();\n            }, this).removeMember(id);\n        },\n\n        requestInvitation: function () {\n            this.model.off('g:inviteRequested').on('g:inviteRequested', function () {\n                this.render();\n            }, this).requestInvitation();\n        },\n\n        acceptMembershipRequest: function (e) {\n            var userId = $(e.currentTarget).parents('li').attr('userid');\n            this.model.off('g:invited').on('g:invited', this.render, this)\n                      .sendInvitation(userId, girder.AccessType.READ, true);\n        },\n\n        denyMembershipRequest: function (e) {\n            var userId = $(e.currentTarget).parents('li').attr('userid');\n            this.model.off('g:removed').on('g:removed', this.render, this)\n                      .removeMember(userId);\n        },\n\n        _updateRolesLists: function () {\n            var mods = [],\n                admins = [];\n\n            _.each(this.model.get('access').users, function (userAccess) {\n                if (userAccess.level === girder.AccessType.WRITE) {\n                    mods.push(userAccess);\n                } else if (userAccess.level === girder.AccessType.ADMIN) {\n                    admins.push(userAccess);\n                }\n            }, this);\n\n            this.adminsWidget = new girder.views.GroupAdminsWidget({\n                el: this.$('.g-group-admins-container'),\n                group: this.model,\n                admins: admins,\n                parentView: this\n            }).off().on('g:demoteUser', function (userId) {\n                this.model.off('g:demoted').on('g:demoted', this.render, this)\n                          .demoteUser(userId, girder.AccessType.ADMIN);\n            }, this).on('g:removeMember', this.removeMember, this)\n                    .on('g:moderatorAdded', this.render, this)\n                    .render();\n\n            this.modsWidget = new girder.views.GroupModsWidget({\n                el: this.$('.g-group-mods-container'),\n                group: this.model,\n                moderators: mods,\n                parentView: this\n            }).on('g:demoteUser', function (userId) {\n                this.model.off('g:demoted').on('g:demoted', this.render, this)\n                          .demoteUser(userId, girder.AccessType.WRITE);\n            }, this).on('g:removeMember', this.removeMember, this)\n                    .on('g:adminAdded', this.render, this)\n                    .render();\n\n            this.membersWidget = new girder.views.GroupMembersWidget({\n                el: this.$('.g-group-members-container'),\n                group: this.model,\n                admins: admins,\n                moderators: mods,\n                parentView: this\n            }).on('g:sendInvite', function (params) {\n                var opts = {\n                    force: params.force || false\n                };\n                this.model.off('g:invited').on('g:invited', function () {\n                    this.invitees.fetch(null, true);\n                    if (params.force) {\n                        this.model.fetchAccess();\n                    }\n                }, this).off('g:error').on('g:error', function (err) {\n                    // TODO don't alert, show something useful\n                    alert(err.responseJSON.message);\n                }, this).sendInvitation(params.user.id, params.level, false, opts);\n            }, this).on('g:removeMember', this.removeMember, this)\n                    .on('g:moderatorAdded', this.render, this)\n                    .on('g:adminAdded', this.render, this);\n        }\n    });\n\n    /**\n     * Helper function for fetching the user and rendering the view with\n     * an arbitrary set of extra parameters.\n     */\n    var _fetchAndInit = function (groupId, params) {\n        var group = new girder.models.GroupModel();\n        group.set({\n            _id: groupId\n        }).once('g:fetched', function () {\n            girder.events.trigger('g:navigateTo', girder.views.GroupView, _.extend({\n                group: group\n            }, params || {}));\n        }, this).fetch();\n    };\n\n    girder.router.route('group/:id', 'groupView', function (groupId, params) {\n        _fetchAndInit(groupId, {\n            edit: params.dialog === 'edit'\n        });\n    });\n\n    girder.router.route('group/:id/:tab', 'groupView', function (groupId, tab, params) {\n        _fetchAndInit(groupId, {\n            edit: params.dialog === 'edit',\n            tab: tab\n        });\n    });\n}());\n","/**\n * This view lists groups.\n */\ngirder.views.GroupsView = girder.View.extend({\n    events: {\n        'click a.g-group-link': function (event) {\n            var cid = $(event.currentTarget).attr('g-group-cid');\n            girder.router.navigate('group/' + this.collection.get(cid).id, {trigger: true});\n        },\n        'submit .g-group-search-form': function (event) {\n            event.preventDefault();\n        },\n        'click .g-group-create-button': function () {\n            this.createGroupDialog();\n        }\n    },\n\n    initialize: function (settings) {\n        girder.cancelRestRequests('fetch');\n        this.collection = new girder.collections.GroupCollection();\n        this.collection.on('g:changed', function () {\n            this.render();\n        }, this).fetch();\n\n        this.paginateWidget = new girder.views.PaginateWidget({\n            collection: this.collection,\n            parentView: this\n        });\n\n        this.searchWidget = new girder.views.SearchFieldWidget({\n            placeholder: 'Search groups...',\n            types: ['group'],\n            parentView: this\n        }).on('g:resultClicked', this._gotoGroup, this);\n\n        this.create = settings.dialog === 'create';\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.groupList({\n            groups: this.collection.toArray(),\n            girder: girder\n        }));\n\n        this.paginateWidget.setElement(this.$('.g-group-pagination')).render();\n        this.searchWidget.setElement(this.$('.g-groups-search-container')).render();\n\n        if (this.create) {\n            this.createGroupDialog();\n            this.create = false;\n        }\n\n        return this;\n    },\n\n    /**\n     * Prompt the user to create a new group\n     */\n    createGroupDialog: function () {\n        new girder.views.EditGroupWidget({\n            el: $('#g-dialog-container'),\n            parentView: this\n        }).off('g:saved').on('g:saved', function (group) {\n            // Since the user has now joined this group, we can append its ID\n            // to their groups list\n            var userGroups = girder.currentUser.get('groups') || [];\n            userGroups.push(group.get('_id'));\n            girder.currentUser.set('groups', userGroups);\n\n            girder.router.navigate('group/' + group.get('_id'), {trigger: true});\n        }, this).render();\n    },\n\n    /**\n     * When the user clicks a search result group, this helper method\n     * will navigate them to the view for that group.\n     */\n    _gotoGroup: function (result) {\n        var group = new girder.models.GroupModel();\n        group.set('_id', result.id).on('g:fetched', function () {\n            girder.router.navigate('group/' + group.get('_id'), {trigger: true});\n        }, this).fetch();\n    }\n\n});\n\ngirder.router.route('groups', 'groups', function (params) {\n    girder.events.trigger('g:navigateTo', girder.views.GroupsView, params || {});\n    girder.events.trigger('g:highlightItem', 'GroupsView');\n});\n","(function () {\n    /**\n     * This view shows a single item's page.\n     */\n    girder.views.ItemView = girder.View.extend({\n        events: {\n            'click .g-edit-item': 'editItem',\n            'click .g-delete-item': 'deleteItem',\n            'click .g-upload-into-item': 'uploadIntoItem'\n        },\n\n        initialize: function (settings) {\n            girder.cancelRestRequests('fetch');\n            this.edit = settings.edit || false;\n            this.fileEdit = settings.fileEdit || false;\n            this.upload = settings.upload || false;\n\n            // If collection model is already passed, there is no need to fetch.\n            if (settings.item) {\n                this.model = settings.item;\n                this.render();\n            } else {\n                console.error('Implement fetch then render item');\n            }\n        },\n\n        uploadIntoItem: function () {\n            new girder.views.UploadWidget({\n                el: $('#g-dialog-container'),\n                parent: this.model,\n                parentType: 'item',\n                parentView: this\n            }).on('g:uploadFinished', function () {\n                girder.dialogs.handleClose('upload');\n                this.upload = false;\n\n                girder.events.trigger('g:alert', {\n                    icon: 'ok',\n                    text: 'Files added.',\n                    type: 'success',\n                    timeout: 4000\n                });\n\n                this.fileListWidget.collection.fetch(null, true);\n            }, this).render();\n        },\n\n        editItem: function () {\n            var container = $('#g-dialog-container');\n\n            if (!this.editItemWidget) {\n                this.editItemWidget = new girder.views.EditItemWidget({\n                    el: container,\n                    item: this.model,\n                    parentView: this\n                }).off('g:saved').on('g:saved', function () {\n                    this.render();\n                }, this);\n            }\n            this.editItemWidget.render();\n        },\n\n        deleteItem: function () {\n            var folderId = this.model.get('folderId');\n            var parentRoute = this.model.get('baseParentType') + '/' +\n                this.model.get('baseParentId') + '/folder/' + folderId;\n            var page = this;\n            girder.confirm({\n                text: 'Are you sure you want to delete <b>' + this.model.escape('name') + '</b>?',\n                yesText: 'Delete',\n                escapedHtml: true,\n                confirmCallback: _.bind(function () {\n                    this.model.destroy().on('g:deleted', function () {\n                        girder.router.navigate(parentRoute, {trigger: true});\n                    }).off('g:error').on('g:error', function () {\n                        page.render();\n                        girder.events.trigger('g:alert', {\n                            icon: 'cancel',\n                            text: 'Failed to delete item.',\n                            type: 'danger',\n                            timeout: 4000\n                        });\n                    });\n                }, this)\n            });\n        },\n\n        render: function () {\n            // Fetch the access level asynchronously and render once we have\n            // it. TODO: load the page and adjust only the action menu once\n            // the access level is fetched.\n            this.model.getAccessLevel(_.bind(function (accessLevel) {\n                this.$el.html(girder.templates.itemPage({\n                    item: this.model,\n                    accessLevel: accessLevel,\n                    girder: girder\n                }));\n\n                this.$('.g-item-actions-button,.g-upload-into-item').tooltip({\n                    container: 'body',\n                    placement: 'left',\n                    animation: false,\n                    delay: {show: 100}\n                });\n\n                this.fileListWidget = new girder.views.FileListWidget({\n                    el: this.$('.g-item-files-container'),\n                    item: this.model,\n                    fileEdit: this.fileEdit,\n                    upload: this.upload,\n                    parentView: this\n                });\n                this.fileListWidget.once('g:changed', function () {\n                    this.trigger('g:rendered');\n                }, this);\n\n                this.fileEdit = false;\n                this.upload = false;\n\n                this.metadataWidget = new girder.views.MetadataWidget({\n                    el: this.$('.g-item-metadata'),\n                    item: this.model,\n                    accessLevel: accessLevel,\n                    parentView: this\n                });\n\n                this.model.getRootPath(_.bind(function (resp) {\n                    this.breadcrumbWidget = new girder.views.ItemBreadcrumbWidget({\n                        el: this.$('.g-item-breadcrumb-container'),\n                        parentChain: resp,\n                        parentView: this\n                    });\n                }, this));\n\n                if (this.edit) {\n                    this.editItem();\n                    this.edit = false;\n                }\n            }, this));\n\n            return this;\n        }\n    });\n\n    /**\n     * Helper function for fetching the user and rendering the view with\n     * an arbitrary set of extra parameters.\n     */\n    var _fetchAndInit = function (itemId, params) {\n        var item = new girder.models.ItemModel();\n        item.set({\n            _id: itemId\n        }).on('g:fetched', function () {\n            girder.events.trigger('g:navigateTo', girder.views.ItemView, _.extend({\n                item: item\n            }, params || {}));\n        }, this).fetch();\n    };\n\n    girder.router.route('item/:id', 'item', function (itemId, params) {\n        _fetchAndInit(itemId, {\n            edit: params.dialog === 'itemedit',\n            fileEdit: params.dialog === 'fileedit' ? params.dialogid : false,\n            upload: params.dialog === 'upload' ? params.dialogid : false\n        });\n    });\n}());\n","/**\n * This is the plugin management page for administrators.\n */\ngirder.views.PluginsView = girder.View.extend({\n    events: {\n        'click a.g-plugin-config-link': function (evt) {\n            var route = $(evt.currentTarget).attr('g-route');\n            girder.router.navigate(route, {trigger: true});\n        },\n        'click .g-plugin-restart-button': function () {\n            var params = {\n                text: 'Are you sure you want to restart the server?  This ' +\n                      'will interrupt all running tasks for all users.',\n                yesText: 'Restart',\n                confirmCallback: girder.restartServer\n            };\n            girder.confirm(params);\n        }\n    },\n\n    initialize: function (settings) {\n        girder.cancelRestRequests('fetch');\n        if (settings.all && settings.enabled) {\n            this.enabled = settings.enabled;\n            this.allPlugins = settings.all;\n            this.render();\n        } else {\n            // Fetch the plugin list\n            girder.restRequest({\n                path: 'system/plugins',\n                type: 'GET'\n            }).done(_.bind(function (resp) {\n                this.enabled = resp.enabled;\n                this.allPlugins = resp.all;\n                this.render();\n            }, this));\n        }\n    },\n\n    render: function () {\n        _.each(this.allPlugins, function (info, name) {\n            info.unmetDependencies = this._unmetDependencies(info);\n            if (!_.isEmpty(info.unmetDependencies)) {\n                // Disable any plugins with unmet dependencies.\n                this.enabled = _.without(this.enabled, name);\n            }\n\n            if (_.contains(this.enabled, name)) {\n                info.enabled = true;\n                info.configRoute = girder.getPluginConfigRoute(name);\n            }\n        }, this);\n\n        this.$el.html(girder.templates.plugins({\n            allPlugins: this._sortPlugins(this.allPlugins)\n        }));\n\n        var view = this;\n        this.$('.g-plugin-switch').bootstrapSwitch()\n          .off('switchChange.bootstrapSwitch')\n          .on('switchChange.bootstrapSwitch', function (event, state) {\n              var plugin = $(event.currentTarget).attr('key');\n              if (state === true) {\n                  view.enabled.push(plugin);\n              } else {\n                  var idx;\n                  while ((idx = view.enabled.indexOf(plugin)) >= 0) {\n                      view.enabled.splice(idx, 1);\n                  }\n              }\n              girder.pluginsChanged = true;\n              $('.g-plugin-restart').addClass('g-plugin-restart-show');\n              view._updatePlugins();\n          });\n        this.$('.g-plugin-config-link').tooltip({\n            container: this.$el,\n            animation: false,\n            placement: 'bottom',\n            delay: {show: 100}\n        });\n        this.$('.g-experimental-notice').tooltip({\n            container: this.$el,\n            animation: false,\n            delay: {show: 100}\n        });\n        if (girder.pluginsChanged) {\n            $('.g-plugin-restart').addClass('g-plugin-restart-show');\n        }\n\n        return this;\n    },\n\n    /**\n     * Takes a plugin object and determines if it has any top level\n     * unmet dependencies.\n     *\n     * Given A depends on B, and B depends on C, and C is not present:\n     * A will have unmet dependencies of ['B'], and B will have unmet dependencies\n     * of ['C'].\n     **/\n    _unmetDependencies: function (plugin) {\n        return _.reject(plugin.dependencies, function (pluginName) {\n            return _.has(this.allPlugins, pluginName) &&\n                _.isEmpty(this._unmetDependencies(this.allPlugins[pluginName]));\n        }, this);\n    },\n\n    _sortPlugins: function (plugins) {\n        /* Sort a dictionary of plugins alphabetically so that the appear in a\n         * predictable order to the user.\n         *\n         * @param plugins: a dictionary to sort.  Each entry has a .name\n         *                 attribute used for sorting.\n         * @returns sortedPlugins: the sorted list. */\n        var sortedPlugins = [];\n        _.each(plugins, function (value, key) {\n            sortedPlugins.push({key: key, value: value});\n        });\n        sortedPlugins.sort(function (a, b) {\n            return a.value.name.localeCompare(b.value.name);\n        });\n        return sortedPlugins;\n    },\n\n    _updatePlugins: function () {\n        // Remove any missing plugins from the enabled list. Can happen\n        // if the directory of an enabled plugin disappears.\n        this.enabled = _.intersection(this.enabled, _.keys(this.allPlugins));\n\n        girder.restRequest({\n            path: 'system/plugins',\n            type: 'PUT',\n            data: {\n                plugins: JSON.stringify(this.enabled)\n            }\n        }).done(_.bind(function (resp) {\n            this.enabled = resp.value;\n\n            _.each(this.enabled, function (plugin) {\n                this.$('.g-plugin-switch[key=\"' + plugin + '\"]')\n                    .attr('checked', 'checked').bootstrapSwitch('state', true, true);\n            }, this);\n        }, this));  // TODO acknowledge?\n    }\n});\n\ngirder.router.route('plugins', 'plugins', function () {\n    // Fetch the plugin list\n    girder.restRequest({\n        path: 'system/plugins',\n        type: 'GET'\n    }).done(_.bind(function (resp) {\n        girder.events.trigger('g:navigateTo', girder.views.PluginsView, resp);\n    }, this)).error(_.bind(function () {\n        girder.events.trigger('g:navigateTo', girder.views.UsersView);\n    }, this));\n});\n","girder.views.S3ImportView = girder.View.extend({\n    events: {\n        'submit .g-s3-import-form': function (e) {\n            e.preventDefault();\n\n            var destId = this.$('#g-s3-import-dest-id').val().trim(),\n                destType = this.$('#g-s3-import-dest-type').val();\n\n            this.$('.g-validation-failed-message').empty();\n\n            this.assetstore.off('g:imported').on('g:imported', function () {\n                girder.router.navigate(destType + '/' + destId, {trigger: true});\n            }, this).on('g:error', function (resp) {\n                this.$('.g-validation-failed-message').text(resp.responseJSON.message);\n            }, this).import({\n                importPath: this.$('#g-s3-import-path').val().trim(),\n                destinationId: destId,\n                destinationType: destType,\n                progress: true\n            });\n        }\n    },\n\n    initialize: function (settings) {\n        this.assetstore = settings.assetstore;\n        this.render();\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.s3Import({\n            assetstore: this.assetstore\n        }));\n    }\n});\n\n// This route is only preserved for backward compatibility. The generic route\n// \"assetstore/:id/import\" is preferred, and is defined in AssetstoresView.js.\ngirder.router.route('assetstore/:id/s3import', 's3Import', function (assetstoreId) {\n    var assetstore = new girder.models.AssetstoreModel({\n        _id: assetstoreId\n    });\n\n    assetstore.once('g:fetched', function () {\n        girder.events.trigger('g:navigateTo', girder.views.S3ImportView, {\n            assetstore: assetstore\n        });\n    }).fetch();\n});\n","/**\n * The system config page for administrators.\n */\ngirder.views.SystemConfigurationView = girder.View.extend({\n    events: {\n        'submit .g-settings-form': function (event) {\n            event.preventDefault();\n            this.$('.g-submit-settings').addClass('disabled');\n            this.$('#g-settings-error-message').empty();\n\n            var settings = _.map(this.settingsKeys, function (key) {\n                return {\n                    key: key,\n                    value: this.$('#g-' + key.replace(/[_.]/g, '-')).val() || null\n                };\n            }, this);\n\n            girder.restRequest({\n                type: 'PUT',\n                path: 'system/setting',\n                data: {\n                    list: JSON.stringify(settings)\n                },\n                error: null\n            }).done(_.bind(function () {\n                this.$('.g-submit-settings').removeClass('disabled');\n                girder.events.trigger('g:alert', {\n                    icon: 'ok',\n                    text: 'Settings saved.',\n                    type: 'success',\n                    timeout: 4000\n                });\n            }, this)).error(_.bind(function (resp) {\n                this.$('.g-submit-settings').removeClass('disabled');\n                this.$('#g-settings-error-message').text(resp.responseJSON.message);\n            }, this));\n        },\n        'click .g-edit-collection-create-policy': function () {\n            this.collectionCreateAccessWidget.render();\n        }\n    },\n\n    initialize: function () {\n        girder.cancelRestRequests('fetch');\n\n        var keys = [\n            'core.cookie_lifetime',\n            'core.email_from_address',\n            'core.email_host',\n            'core.registration_policy',\n            'core.email_verification',\n            'core.smtp_host',\n            'core.smtp.port',\n            'core.smtp.encryption',\n            'core.smtp.username',\n            'core.smtp.password',\n            'core.upload_minimum_chunk_size',\n            'core.cors.allow_origin',\n            'core.cors.allow_methods',\n            'core.cors.allow_headers',\n            'core.add_to_group_policy',\n            'core.collection_create_policy',\n            'core.user_default_folders'\n        ];\n        this.settingsKeys = keys;\n        girder.restRequest({\n            path: 'system/setting',\n            type: 'GET',\n            data: {\n                list: JSON.stringify(keys),\n                default: 'none'\n            }\n        }).done(_.bind(function (resp) {\n            this.settings = resp;\n            girder.restRequest({\n                path: 'system/setting',\n                type: 'GET',\n                data: {\n                    list: JSON.stringify(keys),\n                    default: 'default'\n                }\n            }).done(_.bind(function (resp) {\n                this.defaults = resp;\n                this.render();\n            }, this));\n        }, this));\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.systemConfiguration({\n            settings: this.settings,\n            defaults: this.defaults,\n            JSON: window.JSON\n        }));\n\n        this.$('input[title]').tooltip({\n            container: this.$el,\n            animation: false,\n            delay: {show: 200}\n        });\n\n        this.searchWidget = new girder.views.SearchFieldWidget({\n            el: this.$('.g-collection-create-policy-container .g-search-container'),\n            parentView: this,\n            types: ['user', 'group'],\n            placeholder: 'Add a user or group...',\n            settingValue: this.settings['core.collection_create_policy'] ||\n                               this.defaults['core.collection_create_policy']\n        }).on('g:resultClicked', function (result) {\n            var settingValue = null;\n\n            try {\n                settingValue = JSON.parse(this.$('#g-core-collection-create-policy').val());\n                this.$('#g-settings-error-message').empty();\n            } catch (err) {\n                this.$('#g-settings-error-message').text('Collection creation policy must be a JSON object.');\n                this.searchWidget.resetState();\n                return this;\n            }\n            this.searchWidget.resetState();\n\n            if (result.type === 'user') {\n                settingValue.users = settingValue.users || [];\n                if (!_.contains(settingValue.users, result.id)) {\n                    settingValue.users.push(result.id);\n                } else {\n                    girder.events.trigger('g:alert', {\n                        icon: 'ok',\n                        text: 'User already exists in current policy.',\n                        type: 'warning',\n                        timeout: 4000\n                    });\n                }\n            } else if (result.type === 'group') {\n                settingValue.groups = settingValue.groups || [];\n                if (!_.contains(settingValue.groups, result.id)) {\n                    settingValue.groups.push(result.id);\n                } else {\n                    girder.events.trigger('g:alert', {\n                        icon: 'ok',\n                        text: 'Group already exists in current policy.',\n                        type: 'warning',\n                        timeout: 4000\n                    });\n                }\n            }\n\n            this.$('#g-core-collection-create-policy').val(\n                JSON.stringify(settingValue, null, 4));\n        }, this).render();\n\n        return this;\n    }\n});\n\ngirder.router.route('settings', 'settings', function () {\n    girder.events.trigger('g:navigateTo', girder.views.SystemConfigurationView);\n});\n","/**\n * This is the view for the user account (profile) page.\n */\ngirder.views.UserAccountView = girder.View.extend({\n    events: {\n        'submit #g-user-info-form': function (event) {\n            event.preventDefault();\n            this.$('#g-user-info-error-msg').empty();\n\n            var params = {\n                email: this.$('#g-email').val(),\n                firstName: this.$('#g-firstName').val(),\n                lastName: this.$('#g-lastName').val()\n            };\n\n            if (this.$('#g-admin').length > 0) {\n                params.admin = this.$('#g-admin').is(':checked');\n            }\n\n            this.user.set(params);\n\n            this.user.off('g:error').on('g:error', function (err) {\n                var msg = err.responseJSON.message;\n                this.$('#g-' + err.responseJSON.field).focus();\n                this.$('#g-user-info-error-msg').text(msg);\n            }, this).off('g:saved')\n                    .on('g:saved', function () {\n                        girder.events.trigger('g:alert', {\n                            icon: 'ok',\n                            text: 'Info saved.',\n                            type: 'success',\n                            timeout: 4000\n                        });\n                    }, this).save();\n        },\n        'submit #g-password-change-form': function (event) {\n            event.preventDefault();\n            this.$('#g-password-change-error-msg').empty();\n\n            if (this.$('#g-password-new').val() !==\n                    this.$('#g-password-retype').val()) {\n                this.$('#g-password-change-error-msg').text(\n                    'Passwords do not match, try again.'\n                );\n                this.$('#g-password-retype,#g-password-new').val('');\n                this.$('#g-password-new').focus();\n                return;\n            }\n\n            this.user.off('g:error').on('g:error', function (err) {\n                var msg = err.responseJSON.message;\n                this.$('#g-password-change-error-msg').text(msg);\n            }, this).off('g:passwordChanged')\n                    .on('g:passwordChanged', function () {\n                        girder.events.trigger('g:alert', {\n                            icon: 'ok',\n                            text: 'Password changed.',\n                            type: 'success',\n                            timeout: 4000\n                        });\n                        this.$('#g-password-old,#g-password-new,#g-password-retype').val('');\n                    }, this);\n\n            // here and in the template, an admin user who wants to change their\n            //   own password is intentionally forced to re-enter their old\n            //   password\n            if (this.isCurrentUser) {\n                this.user.changePassword(\n                    this.$('#g-password-old').val(),\n                    this.$('#g-password-new').val()\n                );\n            } else {\n                this.user.adminChangePassword(this.$('#g-password-new').val());\n            }\n        }\n    },\n\n    initialize: function (settings) {\n        this.tab = settings.tab || 'info';\n        this.user = settings.user || girder.currentUser;\n        this.isCurrentUser = girder.currentUser &&\n            settings.user.id === girder.currentUser.id;\n\n        this.model = this.user;\n        this.temporary = settings.temporary;\n\n        if (!this.user || this.user.getAccessLevel() < girder.AccessType.WRITE) {\n            girder.router.navigate('users', {trigger: true});\n            return;\n        }\n\n        girder.cancelRestRequests('fetch');\n\n        this.apiKeyListWidget = new girder.views.ApiKeyListWidget({\n            user: this.user,\n            parentView: this\n        });\n\n        this.render();\n    },\n\n    render: function () {\n        if (girder.currentUser === null) {\n            girder.router.navigate('users', {trigger: true});\n            return;\n        }\n\n        this.$el.html(girder.templates.userSettings({\n            user: this.model,\n            isCurrentUser: this.isCurrentUser,\n            girder: girder,\n            temporaryToken: this.temporary\n        }));\n\n        _.each($('.g-account-tabs>li>a'), function (el) {\n            var tabLink = $(el);\n            tabLink.tab().on('shown.bs.tab', _.bind(function (e) {\n                this.tab = $(e.currentTarget).attr('name');\n                girder.router.navigate('useraccount/' + this.model.id + '/' + this.tab);\n\n                if (this.tab === 'apikeys') {\n                    this.apiKeyListWidget.setElement(\n                        this.$('.g-api-keys-list-container')).render();\n                }\n            }, this));\n\n            if (tabLink.attr('name') === this.tab) {\n                tabLink.tab('show');\n            }\n        }, this);\n\n        return this;\n    }\n});\n\ngirder.router.route('useraccount/:id/:tab', 'accountTab', function (id, tab) {\n    var user = new girder.models.UserModel();\n    user.set({\n        _id: id\n    }).on('g:fetched', function () {\n        girder.events.trigger('g:navigateTo', girder.views.UserAccountView, {\n            user: user,\n            tab: tab\n        });\n    }, this).on('g:error', function () {\n        girder.router.navigate('users', {trigger: true});\n    }, this).fetch();\n});\n\ngirder.router.route('useraccount/:id/token/:token', 'accountToken', function (id, token) {\n    girder.restRequest({\n        path: 'user/password/temporary/' + id,\n        type: 'GET',\n        data: {token: token},\n        error: null\n    }).done(_.bind(function (resp) {\n        resp.user.token = resp.authToken.token;\n        girder.eventStream.close();\n        girder.currentUser = new girder.models.UserModel(resp.user);\n        girder.eventStream.open();\n        girder.events.trigger('g:login-changed');\n        girder.events.trigger('g:navigateTo', girder.views.UserAccountView, {\n            user: girder.currentUser,\n            tab: 'password',\n            temporary: token\n        });\n    }, this)).error(_.bind(function () {\n        girder.router.navigate('users', {trigger: true});\n    }, this));\n});\n\ngirder.router.route('useraccount/:id/verification/:token', 'accountVerify', function (id, token) {\n    girder.restRequest({\n        path: 'user/' + id + '/verification',\n        type: 'PUT',\n        data: {token: token},\n        error: null\n    }).done(_.bind(function (resp) {\n        if (resp.authToken) {\n            resp.user.token = resp.authToken.token;\n            girder.eventStream.close();\n            girder.currentUser = new girder.models.UserModel(resp.user);\n            girder.eventStream.open();\n            girder.events.trigger('g:login-changed');\n        }\n        girder.events.trigger('g:navigateTo', girder.views.FrontPageView);\n        girder.events.trigger('g:alert', {\n            icon: 'ok',\n            text: 'Email verified.',\n            type: 'success',\n            timeout: 4000\n        });\n    }, this)).error(_.bind(function () {\n        girder.events.trigger('g:navigateTo', girder.views.FrontPageView);\n        girder.events.trigger('g:alert', {\n            icon: 'cancel',\n            text: 'Could not verify email.',\n            type: 'danger',\n            timeout: 4000\n        });\n    }, this));\n});\n","(function () {\n    /**\n     * This view shows a single user's page.\n     */\n    girder.views.UserView = girder.View.extend({\n        events: {\n            'click a.g-edit-user': function () {\n                var editUrl = 'useraccount/' + this.model.get('_id') + '/info';\n                girder.router.navigate(editUrl, {trigger: true});\n            },\n\n            'click a.g-delete-user': function () {\n                girder.confirm({\n                    text: 'Are you sure you want to delete the user <b>' +\n                          this.model.escape('login') + '</b>?',\n                    yesText: 'Delete',\n                    escapedHtml: true,\n                    confirmCallback: _.bind(function () {\n                        this.model.destroy().on('g:deleted', function () {\n                            girder.router.navigate('users', {trigger: true});\n                        });\n                    }, this)\n                });\n            },\n\n            'click a.g-approve-user': function () {\n                this._setAndSave(\n                    {status: 'enabled'}, 'Approved user account.');\n            },\n\n            'click a.g-disable-user': function () {\n                this._setAndSave(\n                    {status: 'disabled'}, 'Disabled user account.');\n            },\n\n            'click a.g-enable-user': function () {\n                this._setAndSave(\n                    {status: 'enabled'}, 'Enabled user account.');\n            }\n        },\n\n        initialize: function (settings) {\n            girder.cancelRestRequests('fetch');\n            this.folderId = settings.folderId || null;\n            this.upload = settings.upload || false;\n            this.folderAccess = settings.folderAccess || false;\n            this.folderCreate = settings.folderCreate || false;\n            this.folderEdit = settings.folderEdit || false;\n            this.itemCreate = settings.itemCreate || false;\n\n            if (settings.user) {\n                this.model = settings.user;\n\n                if (settings.folderId) {\n                    this.folder = new girder.models.FolderModel();\n                    this.folder.set({\n                        _id: settings.folderId\n                    }).on('g:fetched', function () {\n                        this._createHierarchyWidget();\n                        this.render();\n                    }, this).on('g:error', function () {\n                        this.folder = null;\n                        this._createHierarchyWidget();\n\n                        this.render();\n                    }, this).fetch();\n                } else {\n                    this._createHierarchyWidget();\n                    this.render();\n                }\n            } else if (settings.id) {\n                this.model = new girder.models.UserModel();\n                this.model.set('_id', settings.id);\n\n                this.model.on('g:fetched', function () {\n                    this._createHierarchyWidget();\n                    this.render();\n                }, this).fetch();\n            }\n        },\n\n        _createHierarchyWidget: function () {\n            this.hierarchyWidget = new girder.views.HierarchyWidget({\n                parentModel: this.folder || this.model,\n                upload: this.upload,\n                folderAccess: this.folderAccess,\n                folderEdit: this.folderEdit,\n                folderCreate: this.folderCreate,\n                itemCreate: this.itemCreate,\n                parentView: this\n            });\n        },\n\n        render: function () {\n            this.$el.html(girder.templates.userPage({\n                user: this.model,\n                girder: girder\n            }));\n\n            this.hierarchyWidget.setElement(this.$('.g-user-hierarchy-container')).render();\n\n            this.upload = false;\n            this.folderAccess = false;\n            this.folderEdit = false;\n            this.folderCreate = false;\n            this.itemCreate = false;\n\n            return this;\n        },\n\n        _setAndSave: function (data, message) {\n            this.model.set(data);\n            this.model.off('g:saved').on('g:saved', function () {\n                girder.events.trigger('g:alert', {\n                    icon: 'ok',\n                    text: message,\n                    type: 'success',\n                    timeout: 4000\n                });\n                this.render();\n            }, this).off('g:error').on('g:error', function (err) {\n                girder.events.trigger('g:alert', {\n                    icon: 'cancel',\n                    text: err.responseJSON.message,\n                    type: 'danger'\n                });\n            }).save();\n        }\n    });\n\n    /**\n     * Helper function for fetching the user and rendering the view with\n     * an arbitrary set of extra parameters.\n     */\n    var _fetchAndInit = function (userId, params) {\n        var user = new girder.models.UserModel();\n        user.set({\n            _id: userId\n        }).on('g:fetched', function () {\n            girder.events.trigger('g:navigateTo', girder.views.UserView, _.extend({\n                user: user\n            }, params || {}));\n        }, this).on('g:error', function () {\n            girder.events.trigger('g:navigateTo', girder.views.UsersView);\n        }, this).fetch();\n    };\n\n    girder.router.route('user/:id', 'user', function (userId, params) {\n        _fetchAndInit(userId, {\n            folderCreate: params.dialog === 'foldercreate',\n            dialog: params.dialog\n        });\n    });\n\n    girder.router.route('user/:id/folder/:id', 'userFolder', function (userId, folderId, params) {\n        _fetchAndInit(userId, {\n            folderId: folderId,\n            upload: params.dialog === 'upload',\n            folderAccess: params.dialog === 'folderaccess',\n            folderCreate: params.dialog === 'foldercreate',\n            folderEdit: params.dialog === 'folderedit',\n            itemCreate: params.dialog === 'itemcreate'\n        });\n    });\n}());\n","/**\n * This view lists users.\n */\ngirder.views.UsersView = girder.View.extend({\n    events: {\n        'click a.g-user-link': function (event) {\n            var cid = $(event.currentTarget).attr('g-user-cid');\n            girder.router.navigate('user/' + this.collection.get(cid).id, {trigger: true});\n        },\n        'click button.g-user-create-button': 'createUserDialog',\n        'submit .g-user-search-form': function (event) {\n            event.preventDefault();\n        }\n    },\n\n    initialize: function (settings) {\n        girder.cancelRestRequests('fetch');\n        this.collection = new girder.collections.UserCollection();\n        this.collection.on('g:changed', function () {\n            this.render();\n        }, this).fetch();\n\n        this.paginateWidget = new girder.views.PaginateWidget({\n            collection: this.collection,\n            parentView: this\n        });\n\n        this.searchWidget = new girder.views.SearchFieldWidget({\n            placeholder: 'Search users...',\n            types: ['user'],\n            modes: 'prefix',\n            parentView: this\n        }).on('g:resultClicked', this._gotoUser, this);\n\n        this.register = settings.dialog === 'register' && girder.currentUser &&\n                        girder.currentUser.get('admin');\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.userList({\n            users: this.collection.toArray(),\n            girder: girder\n        }));\n\n        this.paginateWidget.setElement(this.$('.g-user-pagination')).render();\n        this.searchWidget.setElement(this.$('.g-users-search-container')).render();\n\n        if (this.register) {\n            this.createUserDialog();\n        }\n\n        return this;\n    },\n\n    /**\n     * When the user clicks a search result user, this helper method\n     * will navigate them to the view for that specific user.\n     */\n    _gotoUser: function (result) {\n        var user = new girder.models.UserModel();\n        user.set('_id', result.id).on('g:fetched', function () {\n            girder.router.navigate('user/' + user.get('_id'), {trigger: true});\n        }, this).fetch();\n    },\n\n    createUserDialog: function () {\n        var container = $('#g-dialog-container');\n\n        new girder.views.RegisterView({\n            el: container,\n            parentView: this\n        }).on('g:userCreated', function (info) {\n            girder.router.navigate('user/' + info.user.id, {trigger: true});\n        }, this).render();\n    }\n});\n\ngirder.router.route('users', 'users', function (params) {\n    girder.events.trigger('g:navigateTo', girder.views.UsersView, params || {});\n    girder.events.trigger('g:highlightItem', 'UsersView');\n});\n","/**\n * This view shows the footer in the layout.\n */\ngirder.views.LayoutFooterView = girder.View.extend({\n    render: function () {\n        this.$el.html(girder.templates.layoutFooter({\n            apiRoot: girder.apiRoot\n        }));\n        return this;\n    }\n});\n","/**\n * This view shows a list of global navigation links that should be\n * displayed at all times.\n */\ngirder.views.LayoutGlobalNavView = girder.View.extend({\n    events: {\n        'click .g-nav-link': function (event) {\n            event.preventDefault(); // so we can keep the href\n\n            var link = $(event.currentTarget);\n\n            girder.router.navigate(link.attr('g-target'), {trigger: true});\n\n            // Must call this after calling navigateTo, since that\n            // deactivates all global nav links.\n            link.parent().addClass('g-active');\n        }\n    },\n\n    initialize: function (settings) {\n        girder.events.on('g:highlightItem', this.selectForView, this);\n        girder.events.on('g:login', this.render, this);\n        girder.events.on('g:logout', this.render, this);\n        girder.events.on('g:login-changed', this.render, this);\n\n        settings = settings || {};\n        if (settings.navItems) {\n            this.navItems = settings.navItems;\n        } else {\n            this.defaultNavItems = [{\n                name: 'Collections',\n                icon: 'icon-sitemap',\n                target: 'collections'\n            }, {\n                name: 'Users',\n                icon: 'icon-user',\n                target: 'users'\n            }, {\n                name: 'Groups',\n                icon: 'icon-users',\n                target: 'groups'\n            }];\n        }\n    },\n\n    render: function () {\n        var navItems;\n        if (this.navItems) {\n            navItems = this.navItems;\n        } else {\n            navItems = this.defaultNavItems;\n            if (girder.currentUser && girder.currentUser.get('admin')) {\n                // copy navItems so that this.defaultNavItems is unchanged\n                navItems = navItems.slice();\n                navItems.push({\n                    name: 'Admin console',\n                    icon: 'icon-wrench',\n                    target: 'admin'\n                });\n            }\n        }\n        this.$el.html(girder.templates.layoutGlobalNav({\n            navItems: navItems\n        }));\n\n        if (Backbone.history.fragment) {\n            this.$('[g-target=\"' + Backbone.history.fragment + '\"]')\n                .parent().addClass('g-active');\n        }\n\n        return this;\n    },\n\n    /**\n     * Highlight the item with the given target attribute, which is the name\n     * of the view it navigates to.\n     */\n    selectForView: function (viewName) {\n        this.deactivateAll();\n        this.$('[g-name=\"' + viewName.slice(0, -4) + '\"]').parent().addClass('g-active');\n    },\n\n    deactivateAll: function () {\n        this.$('.g-global-nav-li').removeClass('g-active');\n    }\n});\n","/**\n * This view shows the user menu, or register/sign in links if the user is\n * not logged in.\n */\ngirder.views.LayoutHeaderUserView = girder.View.extend({\n    events: {\n        'click a.g-login': function () {\n            girder.events.trigger('g:loginUi');\n        },\n\n        'click a.g-register': function () {\n            girder.events.trigger('g:registerUi');\n        },\n\n        'click a.g-logout': girder.logout,\n\n        'click a.g-my-folders': function () {\n            girder.router.navigate('user/' + girder.currentUser.get('_id'), {trigger: true});\n        },\n\n        'click a.g-my-settings': function () {\n            girder.router.navigate('useraccount/' + girder.currentUser.get('_id') +\n                                   '/info', {trigger: true});\n        }\n    },\n\n    initialize: function () {\n        girder.events.on('g:login', this.render, this);\n        girder.events.on('g:login-changed', this.render, this);\n        girder.events.on('g:logout', this.render, this);\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.layoutHeaderUser({\n            user: girder.currentUser\n        }));\n        return this;\n    }\n});\n","/**\n * This view shows the header in the layout.\n */\ngirder.views.LayoutHeaderView = girder.View.extend({\n    events: {\n        'click .g-app-title': function () {\n            girder.router.navigate('', {trigger: true});\n        }\n    },\n\n    initialize: function () {\n        this.userView = new girder.views.LayoutHeaderUserView({\n            parentView: this\n        });\n\n        this.searchWidget = new girder.views.SearchFieldWidget({\n            placeholder: 'Quick search...',\n            types: ['item', 'folder', 'group', 'collection', 'user'],\n            parentView: this\n        }).on('g:resultClicked', function (result) {\n            this.searchWidget.resetState();\n            girder.router.navigate(result.type + '/' + result.id, {\n                trigger: true\n            });\n        }, this);\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.layoutHeader());\n\n        this.userView.setElement(this.$('.g-current-user-wrapper')).render();\n        this.searchWidget.setElement(this.$('.g-quick-search-container')).render();\n    }\n});\n","/**\n * This view shows a login modal dialog.\n */\ngirder.views.LoginView = girder.View.extend({\n    events: {\n        'submit #g-login-form': function (e) {\n            e.preventDefault();\n\n            girder.login(this.$('#g-login').val(), this.$('#g-password').val());\n\n            girder.events.once('g:login.success', function () {\n                this.$el.modal('hide');\n            }, this);\n\n            girder.events.once('g:login.error', function (status, err) {\n                this.$('.g-validation-failed-message').text(err.responseJSON.message);\n                this.$('#g-login-button').removeClass('disabled');\n                if (err.responseJSON.extra === 'emailVerification') {\n                    var html = err.responseJSON.message +\n                        ' <a class=\"g-send-verification-email\">Click here to send verification email.</a>';\n                    $('.g-validation-failed-message').html(html);\n                }\n            }, this);\n\n            this.$('#g-login-button').addClass('disabled');\n            this.$('.g-validation-failed-message').text('');\n        },\n\n        'click .g-send-verification-email': function () {\n            this.$('.g-validation-failed-message').html('');\n            girder.restRequest({\n                path: 'user/verification',\n                type: 'POST',\n                data: {login: this.$('#g-login').val()},\n                error: null\n            }).done(_.bind(function (resp) {\n                this.$('.g-validation-failed-message').html(resp.message);\n            }, this)).error(_.bind(function (err) {\n                this.$('.g-validation-failed-message').html(err.responseJSON.message);\n            }, this));\n        },\n\n        'click a.g-register-link': function () {\n            girder.events.trigger('g:registerUi');\n        },\n\n        'click a.g-forgot-password': function () {\n            girder.events.trigger('g:resetPasswordUi');\n        }\n    },\n\n    render: function () {\n        var view = this;\n        this.$el.html(girder.templates.loginDialog()).girderModal(this)\n            .on('shown.bs.modal', function () {\n                view.$('#g-login').focus();\n            }).on('hidden.bs.modal', function () {\n                girder.dialogs.handleClose('login', {replace: true});\n            });\n\n        girder.dialogs.handleOpen('login', {replace: true});\n        this.$('#g-login').focus();\n\n        return this;\n    }\n\n});\n","/**\n * Container showing list of active tasks that are reporting progress\n * via a girder.EventStream object.\n */\ngirder.views.ProgressListView = girder.View.extend({\n\n    initialize: function (settings) {\n        this.eventStream = settings.eventStream;\n        this.eventStream.on('g:event.progress', this._handleProgress, this);\n\n        // map progress IDs to widgets\n        this._map = {};\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.layoutProgressArea());\n\n        this._onUpdate();\n\n        return this;\n    },\n\n    _handleProgress: function (progress) {\n        if (_.has(this._map, progress._id)) {\n            this._map[progress._id].update(progress);\n        } else {\n            var el = $('<div/>', {\n                class: 'g-progress-widget-container'\n            }).appendTo(this.$('.g-progress-list-container'));\n\n            this._map[progress._id] = new girder.views.TaskProgressWidget({\n                el: el,\n                progress: progress,\n                parentView: null\n            }).on('g:hide', function (p) {\n                this._map[p._id].destroy();\n                delete this._map[p._id];\n                this._onUpdate();\n            }, this).render();\n        }\n        this._onUpdate();\n    },\n\n    _onUpdate: function () {\n        if (_.isEmpty(this._map)) {\n            this.$el.hide();\n        } else {\n            this.$el.show();\n        }\n    }\n});\n","/**\n * This view shows a register modal dialog.\n */\ngirder.views.RegisterView = girder.View.extend({\n    events: {\n        'submit #g-register-form': function (e) {\n            e.preventDefault();\n\n            this.$('.form-group').removeClass('has-error');\n\n            if (this.$('#g-password').val() !== this.$('#g-password2').val()) {\n                this.$('#g-group-password,#g-group-password2').addClass('has-error');\n                this.$('#g-password').focus();\n                this.$('.g-validation-failed-message').text('Passwords must match.');\n                return;\n            }\n\n            var user = new girder.models.UserModel({\n                login: this.$('#g-login').val(),\n                password: this.$('#g-password').val(),\n                email: this.$('#g-email').val(),\n                firstName: this.$('#g-firstName').val(),\n                lastName: this.$('#g-lastName').val()\n            });\n            user.on('g:saved', function () {\n                if (girder.currentUser) {\n                    this.trigger('g:userCreated', {\n                        user: user\n                    });\n                } else {\n                    var authToken = user.get('authToken') || {};\n\n                    if (authToken.token) {\n                        girder.currentUser = user;\n                        girder.currentToken = authToken.token;\n\n                        if (girder.corsAuth) {\n                            document.cookie = 'girderToken=' + girder.currentToken;\n                        }\n\n                        girder.events.trigger('g:login');\n                    } else {\n                        girder.events.trigger('g:alert', {\n                            icon: 'ok',\n                            text: 'Check your email to verify registration.',\n                            type: 'success',\n                            timeout: 4000\n                        });\n                    }\n\n                    girder.dialogs.handleClose('register', {replace: true});\n                }\n\n                this.$el.modal('hide');\n            }, this).on('g:error', function (err) {\n                var resp = err.responseJSON;\n                this.$('.g-validation-failed-message').text(resp.message);\n                if (resp.field) {\n                    this.$('#g-group-' + resp.field).addClass('has-error');\n                    this.$('#g-' + resp.field).focus();\n                }\n                this.$('#g-register-button').removeClass('disabled');\n            }, this).save();\n\n            this.$('#g-register-button').addClass('disabled');\n            this.$('.g-validation-failed-message').text('');\n        },\n\n        'click a.g-login-link': function () {\n            girder.events.trigger('g:loginUi');\n        }\n    },\n\n    render: function () {\n        var view = this;\n        this.$el.html(girder.templates.registerDialog({\n            currentUser: girder.currentUser,\n            title: girder.currentUser ? 'Create new user' : 'Sign up'\n        })).girderModal(this)\n            .on('shown.bs.modal', function () {\n                view.$('#g-login').focus();\n            }).on('hidden.bs.modal', function () {\n                girder.dialogs.handleClose('register', {replace: true});\n            });\n        this.$('#g-login').focus();\n\n        girder.dialogs.handleOpen('register', {replace: true});\n\n        return this;\n    }\n\n});\n","/**\n * This view shows a modal dialog for resetting a forgotten password.\n */\ngirder.views.ResetPasswordView = girder.View.extend({\n    events: {\n        'submit #g-reset-password-form': function (e) {\n            e.preventDefault();\n            girder.restRequest({\n                path: 'user/password/temporary',\n                data: {\n                    email: this.$('#g-email').val().trim()\n                },\n                type: 'PUT',\n                error: null // don't do default error behavior\n            }).done(_.bind(function () {\n                this.$el.modal('hide');\n                girder.events.trigger('g:alert', {\n                    icon: 'mail-alt',\n                    text: 'Password reset email sent.',\n                    type: 'success'\n                });\n            }, this)).error(_.bind(function (err) {\n                this.$('.g-validation-failed-message').text(err.responseJSON.message);\n                this.$('#g-reset-password-button').removeClass('disabled');\n            }, this));\n\n            this.$('#g-reset-password-button').addClass('disabled');\n            this.$('.g-validation-failed-message').text('');\n        },\n\n        'click a.g-register-link': function () {\n            girder.events.trigger('g:registerUi');\n        },\n\n        'click a.g-login-link': function () {\n            girder.events.trigger('g:loginUi');\n        }\n    },\n\n    render: function () {\n        var view = this;\n        this.$el.html(girder.templates.resetPasswordDialog(\n        )).girderModal(this).on('shown.bs.modal', function () {\n            view.$('#g-email').focus();\n        }).on('hidden.bs.modal', function () {\n            girder.dialogs.handleClose('resetpassword', {replace: true});\n        });\n        this.$('#g-email').focus();\n\n        girder.dialogs.handleOpen('resetpassword', {replace: true});\n\n        return this;\n    }\n});\n","/**\n * This view allows users to see and control access on a resource.\n */\ngirder.views.AccessWidget = girder.View.extend({\n    events: {\n        'click button.g-save-access-list': function (e) {\n            $(e.currentTarget).attr('disabled', 'disabled');\n            this.saveAccessList();\n        },\n        'click a.g-action-remove-access': 'removeAccessEntry',\n        'change .g-public-container .radio input': 'privacyChanged'\n    },\n\n    /**\n     * @param settings.modelType {string} Display name for the resource type\n     *    being edited.\n     * @param [settings.hideRecurseOption=false] {bool} Whether to hide the recursive\n     *    propagation setting widgets.\n     * @param [settings.hideSaveButton=false] {bool} Whether to hide the \"save\"\n     *    button in non-modal view. This allows for users of this widget to\n     *    provide their own save button elsewhere on the page that can call the\n     *    saveAccessList() method of this widget when pressed.\n     * @param [settings.modal=true] {bool} Whether to render the widget as a\n     *    modal dialog or not.\n     */\n    initialize: function (settings) {\n        this.modelType = settings.modelType;\n        this.hideRecurseOption = settings.hideRecurseOption || false;\n        this.hideSaveButton = settings.hideSaveButton || false;\n        this.modal = _.has(settings, 'modal') ? settings.modal : true;\n\n        this.searchWidget = new girder.views.SearchFieldWidget({\n            placeholder: 'Start typing a name...',\n            modes: ['prefix', 'text'],\n            types: ['group', 'user'],\n            parentView: this\n        }).on('g:resultClicked', this.addEntry, this);\n\n        if (this.model.get('access')) {\n            this.render();\n        } else {\n            this.model.on('g:accessFetched', function () {\n                this.render();\n            }, this).fetchAccess();\n        }\n    },\n\n    render: function () {\n        if (!this.model.get('access')) {\n            new girder.views.LoadingAnimation({\n                el: this.$el,\n                parentView: this\n            }).render();\n            return;\n        }\n\n        var closeFunction;\n        if (this.modal && this.modelType === 'folder') {\n            girder.dialogs.handleOpen('folderaccess');\n            closeFunction = function () {\n                girder.dialogs.handleClose('folderaccess');\n            };\n        } else if (this.modal) {\n            girder.dialogs.handleOpen('access');\n            closeFunction = function () {\n                girder.dialogs.handleClose('access');\n            };\n        }\n\n        var template = this.modal ? girder.templates.accessEditor\n                                  : girder.templates.accessEditorNonModal;\n        this.$el.html(template({\n            model: this.model,\n            modelType: this.modelType,\n            public: this.model.get('public'),\n            hideRecurseOption: this.hideRecurseOption,\n            hideSaveButton: this.hideSaveButton\n        }));\n\n        if (this.modal) {\n            this.$el.girderModal(this).on('hidden.bs.modal', closeFunction);\n        }\n\n        _.each(this.model.get('access').groups, function (groupAccess) {\n            this.$('#g-ac-list-groups').append(girder.templates.accessEntry({\n                accessTypes: girder.AccessType,\n                type: 'group',\n                entry: _.extend(groupAccess, {\n                    title: groupAccess.name,\n                    subtitle: groupAccess.description\n                })\n            }));\n        }, this);\n\n        _.each(this.model.get('access').users, function (userAccess) {\n            this.$('#g-ac-list-users').append(girder.templates.accessEntry({\n                accessTypes: girder.AccessType,\n                type: 'user',\n                entry: _.extend(userAccess, {\n                    title: userAccess.name,\n                    subtitle: userAccess.login\n                })\n            }));\n        }, this);\n\n        this._makeTooltips();\n\n        this.searchWidget.setElement(this.$('.g-search-field-container')).render();\n\n        this.privacyChanged();\n\n        return this;\n    },\n\n    _makeTooltips: function () {\n        this.$('.g-action-remove-access').tooltip({\n            placement: 'bottom',\n            animation: false,\n            delay: {show: 100}\n        });\n    },\n\n    /**\n     * Add a new user or group entry to the access control list UI. If the\n     * given user or group already has an entry there, this does nothing.\n     */\n    addEntry: function (entry) {\n        this.searchWidget.resetState();\n        if (entry.type === 'user') {\n            this._addUserEntry(entry);\n        } else if (entry.type === 'group') {\n            this._addGroupEntry(entry);\n        }\n    },\n\n    _addUserEntry: function (entry) {\n        var exists = false;\n        _.every(this.$('.g-user-access-entry'), function (el) {\n            if ($(el).attr('resourceid') === entry.id) {\n                exists = true;\n            }\n            return !exists;\n        }, this);\n\n        if (!exists) {\n            var model = new girder.models.UserModel();\n            model.set('_id', entry.id).on('g:fetched', function () {\n                this.$('#g-ac-list-users').append(girder.templates.accessEntry({\n                    accessTypes: girder.AccessType,\n                    type: 'user',\n                    entry: {\n                        title: model.name(),\n                        subtitle: model.get('login'),\n                        id: entry.id,\n                        level: girder.AccessType.READ\n                    }\n                }));\n\n                this._makeTooltips();\n            }, this).fetch();\n        }\n    },\n\n    _addGroupEntry: function (entry) {\n        var exists = false;\n        _.every(this.$('.g-group-access-entry'), function (el) {\n            if ($(el).attr('resourceid') === entry.id) {\n                exists = true;\n            }\n            return !exists;\n        }, this);\n\n        if (!exists) {\n            var model = new girder.models.GroupModel();\n            model.set('_id', entry.id).on('g:fetched', function () {\n                this.$('#g-ac-list-groups').append(girder.templates.accessEntry({\n                    accessTypes: girder.AccessType,\n                    type: 'group',\n                    entry: {\n                        title: model.name(),\n                        subtitle: model.get('description'),\n                        id: entry.id,\n                        level: girder.AccessType.READ\n                    }\n                }));\n\n                this._makeTooltips();\n            }, this).fetch();\n        }\n    },\n\n    saveAccessList: function () {\n        // Rebuild the access list\n        var acList = {\n            users: [],\n            groups: []\n        };\n\n        _.each(this.$('.g-group-access-entry'), function (el) {\n            var $el = $(el);\n            acList.groups.push({\n                name: $el.find('.g-desc-title').html(),\n                id: $el.attr('resourceid'),\n                level: parseInt(\n                    $el.find('.g-access-col-right>select').val(),\n                    10\n                )\n            });\n        }, this);\n\n        _.each(this.$('.g-user-access-entry'), function (el) {\n            var $el = $(el);\n            acList.users.push({\n                login: $el.find('.g-desc-subtitle').html(),\n                name: $el.find('.g-desc-title').html(),\n                id: $el.attr('resourceid'),\n                level: parseInt(\n                    $el.find('.g-access-col-right>select').val(),\n                    10\n                )\n            });\n        }, this);\n\n        this.model.set({\n            access: acList,\n            public: this.$('#g-access-public').is(':checked')\n        });\n\n        var recurse = this.$('#g-apply-recursive').is(':checked');\n\n        this.model.off('g:accessListSaved')\n                  .on('g:accessListSaved', function () {\n                      if (this.modal) {\n                          this.$el.modal('hide');\n                      }\n\n                      this.trigger('g:accessListSaved', {\n                          recurse: recurse\n                      });\n                  }, this).updateAccess({\n                      recurse: recurse,\n                      progress: true\n                  });\n    },\n\n    removeAccessEntry: function (event) {\n        var sel = '.g-user-access-entry,.g-group-access-entry';\n        $(event.currentTarget).tooltip('hide').parents(sel).remove();\n    },\n\n    privacyChanged: function () {\n        this.$('.g-public-container .radio').removeClass('g-selected');\n        var selected = this.$('.g-public-container .radio input:checked');\n        selected.parents('.radio').addClass('g-selected');\n    }\n});\n","girder.views.ApiKeyListWidget = girder.View.extend({\n    events: {\n        'click .g-api-key-toggle-active': function (e) {\n            var apiKey = this._getModelFromEvent(e);\n            var toggleActive = _.bind(function () {\n                apiKey.setActive(!apiKey.get('active')).once('g:setActive', function () {\n                    this.render();\n                }, this);\n            }, this);\n\n            if (apiKey.get('active')) {\n                girder.confirm({\n                    text: 'Deactivating this API key will delete any existing tokens ' +\n                          'created with it, and will not be usable until it is activated ' +\n                          'again. Are you sure you want to deactivate it?',\n                    yesText: 'Yes',\n                    yesClass: 'btn-warning',\n                    escapedHtml: true,\n                    confirmCallback: toggleActive\n                });\n            } else {\n                toggleActive();\n            }\n        },\n\n        'click .g-api-key-new': function (e) {\n            this._renderEditWidget();\n        },\n\n        'click .g-api-key-edit': function (e) {\n            var apiKey = this._getModelFromEvent(e);\n            this._renderEditWidget(apiKey);\n        },\n\n        'click .g-api-key-delete': function (e) {\n            var apiKey = this._getModelFromEvent(e);\n\n            girder.confirm({\n                text: 'Are you sure you want to delete the API key <b>' +\n                      apiKey.escape('name') + '</b>? Any client applications using ' +\n                      'this key will no longer be able to authenticate.',\n                yesText: 'Delete',\n                escapedHtml: true,\n                confirmCallback: _.bind(function () {\n                    apiKey.destroy().on('g:deleted', function () {\n                        girder.events.trigger('g:alert', {\n                            icon: 'ok',\n                            text: 'API key deleted.',\n                            type: 'success',\n                            timeout: 3000\n                        });\n                        this.render();\n                    }, this);\n                }, this)\n            });\n        }\n    },\n\n    /**\n     * A widget for listing and editing API keys for a user.\n     *\n     * @param settings.user {girder.models.UserModel} The user whose keys to show.\n     */\n    initialize: function (settings) {\n        this.model = settings.user;\n        this.fetched = false;\n\n        this.collection = new girder.collections.ApiKeyCollection();\n        this.collection.on('g:changed', function () {\n            this.fetched = true;\n            this.render();\n            this.trigger('g:changed');\n        }, this).fetch({\n            userId: this.model.id\n        });\n\n        this.paginateWidget = new girder.views.PaginateWidget({\n            collection: this.collection,\n            parentView: this\n        });\n    },\n\n    render: function () {\n        if (!this.fetched) {\n            return;\n        }\n\n        this.$el.html(girder.templates.apiKeyList({\n            apiKeys: this.collection.toArray(),\n            moment: window.moment\n        }));\n\n        this.$('button').tooltip();\n        this.$('.g-show-api-key').popover({\n            container: this.$('.g-api-key-table'),\n            placement: 'top'\n        });\n\n        this.paginateWidget.setElement(this.$('.g-paginate-container')).render();\n\n        return this;\n    },\n\n    _getModelFromEvent: function (e) {\n        var cid = $(e.currentTarget).parents('.g-api-key-container').attr('cid');\n        return this.collection.get(cid);\n    },\n\n    _renderEditWidget: function (apiKey) {\n        if (!this.editApiKeyWidget) {\n            this.editApiKeyWidget = new girder.views.EditApiKeyWidget({\n                el: $('#g-dialog-container'),\n                parentView: this\n            }).on('g:saved', function (model) {\n                if (!this.collection.get(model.cid)) {\n                    this.collection.add(model);\n                }\n                this.render();\n            }, this);\n        }\n        this.editApiKeyWidget.model = apiKey || null;\n        this.editApiKeyWidget.render();\n    }\n});\n","/**\n * This widget provides the user with an interface similar to a filesystem\n * browser to pick a single user, collection, folder, or item from a\n * hierarchical view.\n */\ngirder.views.BrowserWidget = girder.View.extend({\n    events: {\n        'click .g-submit-button': '_submitButton'\n    },\n\n    /**\n     * Initialize the widget.\n     * @param {object} settings\n     * @param {string} [titleText=\"Select an item\"] Text to display in the modal header\n     * @param {string} [helpText] Info text to display below the hierarchy widget\n     * @param {string} [submitText=\"Save\"] Text to display on the submit button\n     * @param {boolean} [showItems=false] Show items in the hierarchy widget\n     * @param {boolean} [showPreview=true] Show a preview of the current object id\n     * @param {function} [validate] A validation function returning a string that is displayed on error\n     * @param {object} [rootSelectorSettings] Settings passed to the root selector widget\n     */\n    initialize: function (settings) {\n        // store options\n        settings = settings || {};\n        this.titleText = settings.titleText || 'Select an item';\n        this.validate = settings.validate || function () {};\n        this.helpText = settings.helpText;\n        this.showItems = settings.showItems;\n        this.showPreview = settings.showPreview || true;\n        this.submitText = settings.submitText || 'Save';\n\n        // generate the root selection view and listen to it's events\n        this._rootSelectionView = new girder.views.RootSelectorWidget(_.extend({\n            parentView: this\n        }, settings.rootSelectorSettings));\n        this.listenTo(this._rootSelectionView, 'g:selected', function (evt) {\n            this._root = evt.root;\n            this._renderHierarchyView();\n        });\n    },\n\n    render: function () {\n        this.$el.html(\n            girder.templates.browserWidget({\n                title: this.titleText,\n                help: this.helpText,\n                preview: this.showPreview,\n                submit: this.submitText\n            })\n        ).girderModal(this);\n        this._renderRootSelection();\n        return this;\n    },\n\n    /**\n     * Return the selected model id.\n     */\n    selectedModel: function () {\n        return this.$('#g-selected-model').val();\n    },\n\n    _renderRootSelection: function () {\n        this._rootSelectionView.setElement(this.$('.g-hierarchy-root-container')).render();\n        this._renderHierarchyView();\n    },\n\n    _renderHierarchyView: function () {\n        if (this._hierarchyView) {\n            this.stopListening(this._hierarchyView);\n            this._hierarchyView.off();\n            this.$('.g-hierarchy-widget-container').empty();\n        }\n        if (!this._root) {\n            return;\n        }\n        this.$('.g-wait-for-root').removeClass('hidden');\n        this._hierarchyView = new girder.views.HierarchyWidget({\n            parentView: this,\n            parentModel: this._root,\n            checkboxes: false,\n            routing: false,\n            showActions: false,\n            showItems: this.showItems,\n            onItemClick: _.bind(this._selectItem, this)\n        });\n        this.listenTo(this._hierarchyView, 'g:setCurrentModel', this._selectModel);\n        this._hierarchyView.setElement(this.$('.g-hierarchy-widget-container')).render();\n        this._selectModel();\n    },\n\n    _selectItem: function () {\n        // for future extensibility, do something when an item is clicked\n    },\n\n    _selectModel: function () {\n        this.$('.g-validation-failed-message').addClass('hidden');\n        this.$('.g-selected-model').removeClass('has-error');\n        this.$('#g-selected-model').val(this._hierarchyView.parentModel.id);\n    },\n\n    _submitButton: function () {\n        var model = this.selectedModel();\n        var message = this.validate(model);\n        if (message) {\n            this.$('.g-selected-model').addClass('has-error');\n            this.$('.g-validation-failed-message').removeClass('hidden').text(message);\n        } else {\n            this.$el.modal('hide');\n            this.trigger('g:saved', model);\n        }\n    }\n});\n","/**\n * This widget presents a list of available batch actions\n * on a set of selected resources.\n */\ngirder.views.CheckedMenuWidget = girder.View.extend({\n\n    initialize: function (params) {\n        this._fetchAndInit(params);\n        this.dropdownToggle = params.dropdownToggle;\n    },\n\n    render: function () {\n        // If nothing is checked, disable the parent element and return\n        if (this.folderCount + this.itemCount + this.pickedCount === 0) {\n            this.dropdownToggle.attr('disabled', 'disabled');\n            return;\n        }\n\n        this.dropdownToggle.removeAttr('disabled');\n        this.$el.html(girder.templates.checkedActionsMenu({\n            minFolderLevel: this.minFolderLevel,\n            minItemLevel: this.minItemLevel,\n            folderCount: this.folderCount,\n            itemCount: this.itemCount,\n            AccessType: girder.AccessType,\n            pickedCount: this.pickedCount,\n            pickedCopyAllowed: this.pickedCopyAllowed,\n            pickedMoveAllowed: this.pickedMoveAllowed,\n            pickedDesc: this.pickedDesc,\n            girder: girder\n        }));\n    },\n\n    /**\n     * This should be called when the checkbox selection changes. It will\n     * update and re-render the checked action menu.\n     * @param minLevel The minimum access level across the checked resource set.\n     * @param folderCount The number of checked folders.\n     * @param itemCount The number of checked items.\n     */\n    update: function (params) {\n        this._fetchAndInit(params);\n        this.render();\n    },\n\n    _fetchAndInit: function (params) {\n        this.minFolderLevel = params.minFolderLevel || girder.AccessType.READ;\n        this.minItemLevel = params.minItemLevel || girder.AccessType.READ;\n        this.folderCount = params.folderCount || 0;\n        this.itemCount = params.itemCount || 0;\n        this.pickedCount = params.pickedCount || 0;\n        this.pickedCopyAllowed = params.pickedCopyAllowed || false;\n        this.pickedMoveAllowed = params.pickedMoveAllowed || false;\n        this.pickedDesc = params.pickedDesc || '';\n    }\n});\n","/**\n * This view shows a dialog containing detailed collection information.\n */\ngirder.views.CollectionInfoWidget = girder.View.extend({\n    initialize: function () {\n        this.needToFetch = !this.model.has('nFolders');\n        if (this.needToFetch) {\n            this.model.fetch({extraPath: 'details'}).once('g:fetched.details', function () {\n                this.needToFetch = false;\n                this.render();\n            }, this);\n        }\n    },\n\n    render: function () {\n        if (this.needToFetch) {\n            return;\n        }\n\n        this.$el.html(girder.templates.collectionInfoDialog({\n            collection: this.model,\n            girder: girder\n        })).girderModal(this);\n    }\n});\n","/* globals moment */\n\n/**\n * This widget provides a text input field to specify a date/time. The user\n * chooses the date/time using a popup picker.\n */\ngirder.views.DateTimeWidget = girder.View.extend({\n\n    /**\n     * @param [settings.defaultDate=false] The default date/time when not set\n     * explicitly. Set to false to have no default.\n     * @param [settings.showIcon=true] Whether to show a calendar icon beside\n     * the input field. When true, clicking the icon shows the popup. Otherwise,\n     * focusing the input field shows the popup.\n     */\n    initialize: function (settings) {\n        this.defaultDate = settings.defaultDate || false;\n        this.showIcon = _.has(settings, 'showIcon') ? settings.showIcon : true;\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.dateTimeWidget({\n            showIcon: this.showIcon\n        }));\n\n        this.$('.g-datetime-widget').datetimepicker({\n            showClear: true,\n            showTodayButton: true,\n            useCurrent: 'day',\n            icons: {\n                time: 'icon-clock',\n                date: 'icon-calendar',\n                up: 'icon-up-open',\n                down: 'icon-down-open',\n                previous: 'icon-left-open',\n                next: 'icon-right-open',\n                clear: 'icon-trash',\n                close: 'icon-cancel',\n                today: 'icon-target'\n            },\n            defaultDate: this.defaultDate\n        });\n\n        return this;\n    },\n\n    /**\n     * Set date/time. Argument can be an ISO 8601-formatted date string, a\n     * moment object, or a Date object. Call with null or the empty string to\n     * clear. When called with a string, the widget displays in local time.\n     *\n     * @param date Date/time to display.\n     */\n    setDate: function (date) {\n        var picker = this._picker();\n        if (_.isEmpty(date)) {\n            picker.clear();\n        } else if (_.isString(date)) {\n            var localDate = moment.utc(date).local();\n            picker.date(localDate);\n        } else {\n            picker.date(date);\n        }\n    },\n\n    /**\n     * Get the date/time as a moment object in UTC. Returns null if no date is\n     * set.\n     */\n    date: function () {\n        var picker = this._picker();\n        var date = picker.date();\n        if (date !== null) {\n            date = moment(date);\n            date.utc();\n        }\n        return date;\n    },\n\n    /**\n     * Convenience function to return the date/time as a string in UTC. Returns\n     * the empty string if no date is set.\n     */\n    dateString: function () {\n        var date = this.date();\n        if (date === null) {\n            return '';\n        }\n        return date.format();\n    },\n\n    /**\n     * Convenience function to access the datetimepicker on an element.\n     */\n    _picker: function () {\n        var picker = this.$('.g-datetime-widget').data('DateTimePicker');\n        return picker;\n    }\n});\n\n/**\n * This widget provides text input fields to specify a range of dates/times.\n * That is, the first field specifies \"from\" and the second field specifies\n * \"to.\" The user chooses each date/time using a popup picker.\n */\ngirder.views.DateTimeRangeWidget = girder.View.extend({\n\n    /**\n     * @param [settings.defaultFromDate=false] The default \"from\" date/time when\n     * not set explicitly. Set to false to have no default.\n     * @param [settings.defaultToDate=false] The default \"to\" date/time when not\n     * set explicitly. Set to false to have no default.\n     * @param [settings.showIcon=true] Whether to show calendar icons beside\n     * the input fields. When true, clicking the icon shows the popup. Otherwise,\n     * focusing the input field shows the popup.\n     * @param [settings.fromLabel='Start date'] The label text for the \"from\"\n     * input field.\n     * @param [settings.toLabel='End date'] The label text for the \"to\" input\n     * field.\n     */\n    initialize: function (settings) {\n        this.defaultFromDate = settings.defaultFromDate || false;\n        this.defaultToDate = settings.defaultToDate || false;\n        this.showIcon = _.has(settings, 'showIcon') ? settings.showIcon : true;\n        this.fromLabel = settings.fromLabel || 'Start date';\n        this.toLabel = settings.toLabel || 'End date';\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.dateTimeRangeWidget({\n            showIcon: this.showIcon,\n            fromLabel: this.fromLabel,\n            toLabel: this.toLabel\n        }));\n\n        // Link datetimepickers to disallow choosing range where \"from\" date is\n        // after \"to\" date\n\n        var options = {\n            showClear: true,\n            showTodayButton: true,\n            icons: {\n                time: 'icon-clock',\n                date: 'icon-calendar',\n                up: 'icon-up-open',\n                down: 'icon-down-open',\n                previous: 'icon-left-open',\n                next: 'icon-right-open',\n                clear: 'icon-trash',\n                close: 'icon-cancel',\n                today: 'icon-target'\n            }\n        };\n        options.useCurrent = 'day';\n        options.defaultDate = this.defaultFromDate;\n        this.$('.g-datetime-widget-from').datetimepicker(options);\n\n        options.useCurrent = false;\n        options.defaultDate = this.defaultToDate;\n        this.$('.g-datetime-widget-to').datetimepicker(options);\n\n        this.$('.g-datetime-widget-from').on('dp.change', _.bind(function (e) {\n            var picker = this._picker('.g-datetime-widget-to');\n            picker.minDate(e.date);\n        }, this));\n        this.$('.g-datetime-widget-to').on('dp.change', _.bind(function (e) {\n            var picker = this._picker('.g-datetime-widget-from');\n            picker.maxDate(e.date);\n        }, this));\n\n        return this;\n    },\n\n    /**\n     * Set \"from\" date/time. Argument can be an ISO 8601-formatted date string,\n     * a moment object, or a Date object. Call with null or the empty string to\n     * clear. When called with a string, the widget displays in local time.\n     *\n     * @param date From date/time to display.\n     */\n    setFromDate: function (date) {\n        this._setDate('.g-datetime-widget-from', date);\n    },\n\n    /**\n     * Set \"to\" date/time. Argument can be an ISO 8601-formatted date string,\n     * a moment object, or a Date object. Call with null or the empty string to\n     * clear. When called with a string, the widget displays in local time.\n     *\n     * @param date To date/time to display.\n     */\n    setToDate: function (date) {\n        this._setDate('.g-datetime-widget-to', date);\n    },\n\n    /*\n     * Convenience function to set date/time for a specified datetimepicker.\n     *\n     * @param [id] Element ID on which to access the datetimepicker.\n     */\n    _setDate: function (id, date) {\n        var picker = this._picker(id);\n        if (_.isEmpty(date)) {\n            picker.clear();\n        } else if (_.isString(date)) {\n            var localDate = moment.utc(date).local();\n            picker.date(localDate);\n        } else {\n            picker.date(date);\n        }\n    },\n\n    /**\n     * Get the \"from\" date/time as a moment object in UTC. Returns null if no\n     * date is set.\n     */\n    fromDate: function () {\n        return this._date('.g-datetime-widget-from');\n    },\n\n    /**\n     * Get the \"to\" date/time as a moment object in UTC. Returns null if no date\n     * is set.\n     */\n    toDate: function () {\n        return this._date('.g-datetime-widget-to');\n    },\n\n    /**\n     * Convenience function to return \"from\" the date/time as a string in UTC.\n     * Returns the empty string if no date is set.\n     */\n    fromDateString: function () {\n        return this._dateString('.g-datetime-widget-from');\n    },\n\n    /**\n     * Convenience function to return the \"to\" date/time as a string in UTC.\n     * Returns the empty string if no date is set.\n     */\n    toDateString: function () {\n        return this._dateString('.g-datetime-widget-to');\n    },\n\n    _picker: function (id) {\n        var picker = this.$(id).data('DateTimePicker');\n        return picker;\n    },\n\n    _date: function (id) {\n        var picker = this._picker(id);\n        var date = picker.date();\n        if (date !== null) {\n            date = moment(date);\n            date.utc();\n        }\n        return date;\n    },\n\n    _dateString: function (id) {\n        var date = this._date(id);\n        if (date === null) {\n            return '';\n        }\n        return date.format();\n    }\n});\n","/**\n * This widget is used to create a new API key or edit an existing one.\n */\ngirder.views.EditApiKeyWidget = girder.View.extend({\n    events: {\n        'submit #g-api-key-edit-form': function (e) {\n            e.preventDefault();\n\n            var fields = {\n                name: this.$('#g-api-key-name').val(),\n                tokenDuration: this.$('#g-api-key-token-duration').val(),\n                scope: null\n            };\n\n            if (this._getSelectedScopeMode() === 'custom') {\n                fields.scope = _.map(this.$('.g-custom-scope-checkbox:checked'), function (el) {\n                    return $(el).val();\n                });\n            }\n\n            this.saveModel(this.model, fields);\n\n            this.$('button.g-save-api-key').addClass('disabled');\n            this.$('.g-validation-failed-message').text('');\n        },\n\n        'change .g-scope-selection-container .radio input': function (e) {\n            var mode = this._getSelectedScopeMode();\n            if (mode === 'full') {\n                this.$('.g-custom-scope-checkbox').attr('disabled', 'disabled')\n                    .parent().parent().addClass('disabled');\n            } else if (mode === 'custom') {\n                this.$('.g-custom-scope-checkbox').removeAttr('disabled')\n                    .parent().parent().removeClass('disabled');\n            }\n        }\n    },\n\n    initialize: function (settings) {\n        this.model = settings.model || null;\n        this.scopeInfo = null;\n        this._shouldRender = false;\n\n        girder.restRequest({\n            path: 'token/scopes'\n        }).done(_.bind(function (resp) {\n            this.scopeInfo = resp;\n            if (this._shouldRender) {\n                this._shouldRender = false;\n                this.render();\n            }\n        }, this));\n    },\n\n    render: function () {\n        if (!this.scopeInfo) { // Wait for scope list to be fetched\n            this._shouldRender = true;\n            return;\n        }\n\n        var modal = this.$el.html(girder.templates.editApiKeyWidget({\n            apiKey: this.model,\n            user: girder.currentUser,\n            userTokenScopes: this.scopeInfo.custom,\n            adminTokenScopes: this.scopeInfo.adminCustom\n        })).girderModal(this).on('shown.bs.modal', _.bind(function () {\n            this.$('#g-api-key-name').focus();\n        }, this)).on('ready.girder.modal', _.bind(function () {\n            if (this.model) {\n                this.$('#g-api-key-name').val(this.model.get('name'));\n                this.$('#g-api-key-token-duration').val(this.model.get('tokenDuration') || '');\n                if (this.model.get('scope')) {\n                    this.$('#g-scope-mode-custom').attr('checked', 'checked');\n                    this.$('.g-custom-scope-checkbox').removeAttr('disabled');\n                    _.each(this.model.get('scope'), function (scope) {\n                        this.$('.g-custom-scope-checkbox[value=\"' + scope + '\"]').attr('checked', 'checked');\n                    }, this);\n                }\n            }\n        }, this));\n        modal.trigger($.Event('ready.girder.modal', {relatedTarget: modal}));\n\n        this.$('#g-api-key-name').focus();\n        this.$('.g-custom-scope-description').tooltip({\n            placement: 'right',\n            viewport: this.$el,\n            trigger: 'hover'\n        });\n\n        return this;\n    },\n\n    saveModel: function (model, fields) {\n        model = model || new girder.models.ApiKeyModel();\n\n        model.set(fields);\n        model.once('g:saved', function () {\n            this.$el.modal('hide');\n            this.trigger('g:saved', model);\n        }, this).off('g:error', null, this).on('g:error', function (err) {\n            this.$('.g-validation-failed-message').text(err.responseJSON.message);\n            this.$('button.g-save-api-key').removeClass('disabled');\n        }, this).save();\n    },\n\n    _getSelectedScopeMode: function () {\n        return this.$('.g-scope-selection-container .radio input:checked').attr('value');\n    }\n});\n","/**\n * This widget is used to edit an existing assetstore.\n */\ngirder.views.EditAssetstoreWidget = girder.View.extend({\n    events: {\n        'submit #g-assetstore-edit-form': function (e) {\n            e.preventDefault();\n\n            var fields = this.fieldsMap[this.model.get('type')].get.call(this);\n            fields.name = this.$('#g-edit-name').val();\n\n            this.updateAssetstore(fields);\n\n            this.$('button.g-save-assetstore').addClass('disabled');\n            this.$('.g-validation-failed-message').text('');\n        }\n    },\n\n    initialize: function (settings) {\n        this.model = settings.model || null;\n    },\n\n    /**\n     * This maps each type of assetstore to a function to getter and setter\n     * functions. The set functions are reponsible for populating the dialog\n     * fields with the appropriate current model values, and the get functions\n     * are responsible for reading the user input values from the dialog and\n     * returning a set of fields (excluding the name field) to set on the model.\n     *\n     * This is meant to make it easy for plugins that add new assetstore types\n     * to extend this dialog to allow the setting of custom fields using whatever\n     * widgets make the most sense. By adding a new field to this object, this\n     * edit dialog can support any type of assetstore dynamically.\n     *\n     * Since the keys of this array are values defined by variables,\n     * we set them after this class rather than inline with object creation syntax.\n     */\n    fieldsMap: {},\n\n    render: function () {\n        var view = this;\n        var modal = this.$el.html(girder.templates.editAssetstoreWidget({\n            assetstore: view.model,\n            types: girder.AssetstoreType\n        })).girderModal(this).on('shown.bs.modal', function () {\n            view.$('#g-edit-name').focus();\n            girder.dialogs.handleOpen('assetstoreedit', undefined, view.model.get('id'));\n            view.$('#g-edit-name').val(view.model.get('name'));\n            view.fieldsMap[view.model.get('type')].set.call(view);\n        }).on('hidden.bs.modal', function () {\n            girder.dialogs.handleClose('assetstoreedit', undefined, view.model.get('id'));\n        });\n        modal.trigger($.Event('ready.girder.modal', {relatedTarget: modal}));\n        return this;\n    },\n\n    updateAssetstore: function (fields) {\n        var oldfields = {};\n        var model = this.model;\n        _.each(fields, function (value, key) {\n            oldfields[key] = model.get(key);\n        });\n        this.model.set(fields);\n        this.model.on('g:saved', function () {\n            this.$el.modal('hide');\n            this.trigger('g:saved', this.model);\n        }, this).on('g:error', function (err) {\n            this.$('.g-validation-failed-message').text(err.responseJSON.message);\n            this.$('button.g-save-assetstore').removeClass('disabled');\n            this.$('#g-' + err.responseJSON.field).focus();\n            this.model.set(oldfields);\n        }, this).save();\n    }\n});\n\n(function () {\n    var fieldsMap = girder.views.EditAssetstoreWidget.prototype.fieldsMap;\n\n    fieldsMap[girder.AssetstoreType.FILESYSTEM] = {\n        get: function () {\n            return {\n                root: this.$('#g-edit-fs-root').val(),\n                perms: this.$('#g-edit-fs-perms').val()\n            };\n        },\n        set: function () {\n            var permStr = this.model.get('perms') ? this.model.get('perms').toString(8) : '600';\n            this.$('#g-edit-fs-perms').val(permStr);\n            this.$('#g-edit-fs-root').val(this.model.get('root'));\n        }\n    };\n\n    fieldsMap[girder.AssetstoreType.GRIDFS] = {\n        get: function () {\n            return {\n                db: this.$('#g-edit-gridfs-db').val(),\n                mongohost: this.$('#g-edit-gridfs-mongohost').val(),\n                replicaset: this.$('#g-edit-gridfs-replicaset').val()\n            };\n        },\n        set: function () {\n            this.$('#g-edit-gridfs-db').val(this.model.get('db'));\n            this.$('#g-edit-gridfs-mongohost').val(this.model.get('mongohost'));\n            this.$('#g-edit-gridfs-replicaset').val(this.model.get('replicaset'));\n        }\n    };\n\n    fieldsMap[girder.AssetstoreType.S3] = {\n        get: function () {\n            return {\n                bucket: this.$('#g-edit-s3-bucket').val(),\n                prefix: this.$('#g-edit-s3-prefix').val(),\n                accessKeyId: this.$('#g-edit-s3-access-key-id').val(),\n                secret: this.$('#g-edit-s3-secret').val(),\n                service: this.$('#g-edit-s3-service').val(),\n                readOnly: this.$('#g-edit-s3-readonly').is(':checked')\n            };\n        },\n        set: function () {\n            this.$('#g-edit-s3-bucket').val(this.model.get('bucket'));\n            this.$('#g-edit-s3-prefix').val(this.model.get('prefix'));\n            this.$('#g-edit-s3-access-key-id').val(this.model.get('accessKeyId'));\n            this.$('#g-edit-s3-secret').val(this.model.get('secret'));\n            this.$('#g-edit-s3-service').val(this.model.get('service'));\n            this.$('#g-edit-s3-readonly').attr('checked', this.model.get('readOnly') ? 'checked' : undefined);\n        }\n    };\n})();\n","/**\n * This widget is used to create a new collection or edit an existing one.\n */\ngirder.views.EditCollectionWidget = girder.View.extend({\n    events: {\n        'submit #g-collection-edit-form': function (e) {\n            e.preventDefault();\n\n            var fields = {\n                name: this.$('#g-name').val(),\n                description: this.$('#g-description').val()\n            };\n\n            if (this.model) {\n                this.updateCollection(fields);\n            } else {\n                this.createCollection(fields);\n            }\n\n            this.$('button.g-save-collection').addClass('disabled');\n            this.$('.g-validation-failed-message').text('');\n        }\n    },\n\n    initialize: function (settings) {\n        this.model = settings.model || null;\n    },\n\n    render: function () {\n        var view = this;\n        var modal = this.$el.html(girder.templates.editCollectionWidget({\n            collection: view.model\n        })).girderModal(this).on('shown.bs.modal', function () {\n            view.$('#g-name').focus();\n        }).on('hidden.bs.modal', function () {\n            if (view.create) {\n                girder.dialogs.handleClose('create');\n            } else {\n                girder.dialogs.handleClose('edit');\n            }\n        }).on('ready.girder.modal', function () {\n            if (view.model) {\n                view.$('#g-name').val(view.model.get('name'));\n                view.$('#g-description').val(view.model.get('description'));\n                view.create = false;\n            } else {\n                view.create = true;\n            }\n        });\n        modal.trigger($.Event('ready.girder.modal', {relatedTarget: modal}));\n        this.$('#g-name').focus();\n\n        if (view.model) {\n            girder.dialogs.handleOpen('edit');\n        } else {\n            girder.dialogs.handleOpen('create');\n        }\n\n        return this;\n    },\n\n    createCollection: function (fields) {\n        var collection = new girder.models.CollectionModel();\n        collection.set(fields);\n        collection.on('g:saved', function () {\n            this.$el.modal('hide');\n            this.trigger('g:saved', collection);\n        }, this).off('g:error').on('g:error', function (err) {\n            this.$('.g-validation-failed-message').text(err.responseJSON.message);\n            this.$('button.g-save-collection').removeClass('disabled');\n            this.$('#g-' + err.responseJSON.field).focus();\n        }, this).save();\n    },\n\n    updateCollection: function (fields) {\n        this.model.set(fields);\n        this.model.on('g:saved', function () {\n            this.$el.modal('hide');\n            this.trigger('g:saved', this.model);\n        }, this).off('g:error').on('g:error', function (err) {\n            this.$('.g-validation-failed-message').text(err.responseJSON.message);\n            this.$('button.g-save-collection').removeClass('disabled');\n            this.$('#g-' + err.responseJSON.field).focus();\n        }, this).save();\n    }\n});\n","/**\n * This widget is used to edit file information.\n */\ngirder.views.EditFileWidget = girder.View.extend({\n    events: {\n        'submit #g-file-edit-form': function () {\n            var fields = {\n                name: this.$('#g-name').val(),\n                mimeType: this.$('#g-mimetype').val()\n            };\n\n            this.file.set(fields);\n            this.file.off(null, null, this).on('g:saved', function () {\n                this.$el.modal('hide');\n                this.trigger('g:saved', this.file);\n            }, this).on('g:error', function (err) {\n                this.$('.g-validation-failed-message').text(err.responseJSON.message);\n                this.$('button.g-save-file').removeClass('disabled');\n                this.$('#g-' + err.responseJSON.field).focus();\n            }, this).save();\n\n            this.$('button.g-save-file').addClass('disabled');\n            this.$('.g-validation-failed-message').empty();\n\n            return false;\n        }\n    },\n\n    initialize: function (settings) {\n        this.file = settings.file || null;\n    },\n\n    render: function () {\n        var view = this;\n        if (this.file.get('mimeType') === undefined) {\n            this.file.set('mimeType', '');\n        }\n        this.$el.html(girder.templates.editFileWidget({file: this.file}))\n            .girderModal(this).on('shown.bs.modal', function () {\n                view.$('#g-name').select().focus();\n            }).on('hidden.bs.modal', function () {\n                girder.dialogs.handleClose('fileedit', undefined,\n                                           view.file.get('_id'));\n            });\n        girder.dialogs.handleOpen('fileedit', undefined, this.file.get('_id'));\n        return this;\n    }\n});\n","/**\n * This widget is used to create a new folder or edit an existing one.\n */\ngirder.views.EditFolderWidget = girder.View.extend({\n    events: {\n        'submit #g-folder-edit-form': function (e) {\n            e.preventDefault();\n            var fields = {\n                name: this.$('#g-name').val(),\n                description: this.descriptionEditor.val()\n            };\n\n            if (this.folder) {\n                this.updateFolder(fields);\n            } else {\n                this.createFolder(fields);\n            }\n\n            this.$('button.g-save-folder').addClass('disabled');\n            this.$('.g-validation-failed-message').text('');\n        }\n    },\n\n    initialize: function (settings) {\n        this.folder = settings.folder || null;\n        this.parentModel = settings.parentModel;\n        this.descriptionEditor = new girder.views.MarkdownWidget({\n            text: this.folder ? this.folder.get('description') : '',\n            prefix: 'folder-description',\n            placeholder: 'Enter a description',\n            parent: this.folder,\n            allowedExtensions: ['png', 'jpg', 'jpeg', 'gif'],\n            enableUploads: !!this.folder,\n            parentView: this\n        }).on('g:fileUploaded', function (args) {\n            this.trigger('g:fileUploaded', args);\n        }, this);\n    },\n\n    render: function () {\n        var view = this;\n        var modal = this.$el.html(girder.templates.editFolderWidget({\n            folder: this.folder\n        })).girderModal(this).on('shown.bs.modal', function () {\n            view.$('#g-name').focus();\n            if (view.folder) {\n                girder.dialogs.handleOpen('folderedit');\n            } else {\n                girder.dialogs.handleOpen('foldercreate');\n            }\n        }).on('hidden.bs.modal', function () {\n            if (view.create) {\n                girder.dialogs.handleClose('foldercreate');\n            } else {\n                girder.dialogs.handleClose('folderedit');\n            }\n        }).on('ready.girder.modal', function () {\n            if (view.folder) {\n                view.$('#g-name').val(view.folder.get('name'));\n                view.descriptionEditor.val(view.folder.get('description'));\n                view.create = false;\n            } else {\n                view.create = true;\n            }\n        });\n        modal.trigger($.Event('ready.girder.modal', {relatedTarget: modal}));\n        this.$('#g-name').focus();\n        this.descriptionEditor.setElement(\n            this.$('.g-description-editor-container')).render();\n\n        return this;\n    },\n\n    createFolder: function (fields) {\n        var folder = new girder.models.FolderModel();\n        folder.set(_.extend(fields, {\n            parentType: this.parentModel.resourceName,\n            parentId: this.parentModel.get('_id')\n        }));\n        folder.on('g:saved', function () {\n            this.$el.modal('hide');\n            this.trigger('g:saved', folder);\n        }, this).on('g:error', function (err) {\n            this.$('.g-validation-failed-message').text(err.responseJSON.message);\n            this.$('button.g-save-folder').removeClass('disabled');\n            this.$('#g-' + err.responseJSON.field).focus();\n        }, this).save();\n    },\n\n    updateFolder: function (fields) {\n        this.folder.set(fields);\n        this.folder.off().on('g:saved', function () {\n            this.$el.modal('hide');\n            this.trigger('g:saved', this.folder);\n        }, this).on('g:error', function (err) {\n            this.$('.g-validation-failed-message').text(err.responseJSON.message);\n            this.$('button.g-save-folder').removeClass('disabled');\n            this.$('#g-' + err.responseJSON.field).focus();\n        }, this).save();\n    }\n});\n","/**\n * This widget is used to create a new group or edit an existing one.\n */\ngirder.views.EditGroupWidget = girder.View.extend({\n    events: {\n        'submit #g-group-edit-form': function (e) {\n            e.preventDefault();\n\n            var fields = {\n                name: this.$('#g-name').val(),\n                description: this.$('#g-description').val(),\n                public: this.$('#g-access-public').is(':checked')\n            };\n            if (this.$('#g-add-to-group').length) {\n                fields.addAllowed = this.$('#g-add-to-group').val();\n            }\n\n            if (this.model) {\n                this.updateGroup(fields);\n            } else {\n                this.createGroup(fields);\n            }\n\n            this.$('button.g-save-group').addClass('disabled');\n            this.$('.g-validation-failed-message').text('');\n        },\n\n        'change .g-public-container .radio input': 'privacyChanged'\n    },\n\n    initialize: function (settings) {\n        this.model = settings.model || null;\n    },\n\n    render: function () {\n        var view = this;\n        var pub = this.model ? this.model.get('public') : false;\n        var groupAddAllowed;\n        var addToGroupPolicy = this.model ? this.model.get('_addToGroupPolicy') : null;\n        if (girder.currentUser.get('admin')) {\n            if (addToGroupPolicy === 'nomod' || addToGroupPolicy === 'yesmod') {\n                groupAddAllowed = 'mod';\n            } else if (addToGroupPolicy === 'noadmin' || addToGroupPolicy === 'yesadmin') {\n                groupAddAllowed = 'admin';\n            }\n        }\n        var modal = this.$el.html(girder.templates.editGroupWidget({\n            group: this.model,\n            public: pub,\n            addToGroupPolicy: addToGroupPolicy,\n            groupAddAllowed: groupAddAllowed,\n            addAllowed: this.model ? this.model.get('addAllowed') : false\n        })).girderModal(this).on('shown.bs.modal', function () {\n            view.$('#g-name').focus();\n            if (view.model) {\n                girder.dialogs.handleOpen('edit');\n            } else {\n                girder.dialogs.handleOpen('create');\n            }\n        }).on('hidden.bs.modal', function () {\n            if (view.create) {\n                girder.dialogs.handleClose('create');\n            } else {\n                girder.dialogs.handleClose('edit');\n            }\n        }).on('ready.girder.modal', function () {\n            if (view.model) {\n                view.$('#g-name').val(view.model.get('name'));\n                view.$('#g-description').val(view.model.get('description'));\n                view.create = false;\n            } else {\n                view.create = true;\n            }\n        });\n        modal.trigger($.Event('ready.girder.modal', {relatedTarget: modal}));\n        this.$('#g-name').focus();\n\n        this.privacyChanged();\n\n        return this;\n    },\n\n    createGroup: function (fields) {\n        var group = new girder.models.GroupModel();\n        group.set(fields);\n        group.on('g:saved', function () {\n            this.$el.modal('hide');\n            this.trigger('g:saved', group);\n        }, this).on('g:error', function (err) {\n            this.$('.g-validation-failed-message').text(err.responseJSON.message);\n            this.$('button.g-save-group').removeClass('disabled');\n            this.$('#g-' + err.responseJSON.field).focus();\n        }, this).save();\n    },\n\n    updateGroup: function (fields) {\n        this.model.set(fields);\n        this.model.off().on('g:saved', function () {\n            this.$el.modal('hide');\n            this.trigger('g:saved', this.model);\n        }, this).on('g:error', function (err) {\n            this.$('.g-validation-failed-message').text(err.responseJSON.message);\n            this.$('button.g-save-group').removeClass('disabled');\n            this.$('#g-' + err.responseJSON.field).focus();\n        }, this).save();\n    },\n\n    privacyChanged: function () {\n        this.$('.g-public-container .radio').removeClass('g-selected');\n        var selected = this.$('.g-public-container .radio input:checked');\n        selected.parents('.radio').addClass('g-selected');\n    }\n});\n","/**\n * This widget is used to create a new item or edit an existing one.\n */\ngirder.views.EditItemWidget = girder.View.extend({\n    events: {\n        'submit #g-item-edit-form': function () {\n            var fields = {\n                name: this.$('#g-name').val(),\n                description: this.$('#g-description').val()\n            };\n\n            if (this.item) {\n                this.updateItem(fields);\n            } else {\n                this.createItem(fields);\n            }\n\n            this.$('button.g-save-item').addClass('disabled');\n            this.$('.g-validation-failed-message').empty();\n\n            return false;\n        }\n    },\n\n    initialize: function (settings) {\n        this.item = settings.item || null;\n        this.parentModel = settings.parentModel;\n    },\n\n    render: function () {\n        var view = this;\n        var modal = this.$el.html(girder.templates.editItemWidget({\n            item: this.item}))\n            .girderModal(this).on('shown.bs.modal', function () {\n                view.$('#g-name').focus();\n                if (view.item) {\n                    girder.dialogs.handleOpen('itemedit');\n                } else {\n                    girder.dialogs.handleOpen('itemcreate');\n                }\n            }).on('hidden.bs.modal', function () {\n                if (view.create) {\n                    girder.dialogs.handleClose('itemcreate');\n                } else {\n                    girder.dialogs.handleClose('itemedit');\n                }\n            }).on('ready.girder.modal', function () {\n                if (view.item) {\n                    view.$('#g-name').val(view.item.get('name'));\n                    view.$('#g-description').val(view.item.get('description'));\n                    view.create = false;\n                } else {\n                    view.create = true;\n                }\n            });\n        modal.trigger($.Event('ready.girder.modal', {relatedTarget: modal}));\n\n        return this;\n    },\n\n    createItem: function (fields) {\n        var item = new girder.models.ItemModel();\n        item.set(_.extend(fields, {\n            folderId: this.parentModel.get('_id')\n        }));\n        item.on('g:saved', function () {\n            this.$el.modal('hide');\n            this.trigger('g:saved', item);\n        }, this).on('g:error', function (err) {\n            this.$('.g-validation-failed-message').text(err.responseJSON.message);\n            this.$('button.g-save-item').removeClass('disabled');\n            this.$('#g-' + err.responseJSON.field).focus();\n        }, this).save();\n    },\n\n    updateItem: function (fields) {\n        this.item.set(fields);\n        this.item.off().on('g:saved', function () {\n            this.$el.modal('hide');\n            this.trigger('g:saved', this.item);\n        }, this).on('g:error', function (err) {\n            this.$('.g-validation-failed-message').text(err.responseJSON.message);\n            this.$('button.g-save-item').removeClass('disabled');\n            this.$('#g-' + err.responseJSON.field).focus();\n        }, this).save();\n    }\n});\n","/**\n * This widget shows information about a single file in a modal dialog.\n */\ngirder.views.FileInfoWidget = girder.View.extend({\n    render: function () {\n        this.$el.html(girder.templates.fileInfoDialog({\n            file: this.model,\n            girder: girder\n        })).girderModal(this);\n    }\n});\n","/**\n * This widget shows a list of files in a given item.\n */\ngirder.views.FileListWidget = girder.View.extend({\n    events: {\n        'click a.g-show-more-files': function () {\n            this.collection.fetchNextPage();\n        },\n\n        'click a.g-show-info': function (e) {\n            var cid = $(e.currentTarget).attr('file-cid');\n            new girder.views.FileInfoWidget({\n                el: $('#g-dialog-container'),\n                model: this.collection.get(cid),\n                parentView: this\n            }).render();\n        },\n\n        'click a.g-update-contents': function (e) {\n            var cid = $(e.currentTarget).parent().attr('file-cid');\n            this.uploadDialog(cid);\n        },\n\n        'click a.g-update-info': function (e) {\n            var cid = $(e.currentTarget).parent().attr('file-cid');\n            this.editFileDialog(cid);\n        },\n\n        'click a.g-delete-file': function (e) {\n            var cid = $(e.currentTarget).parent().attr('file-cid');\n            var file = this.collection.get(cid);\n\n            girder.confirm({\n                text: 'Are you sure you want to delete the file <b>' +\n                      file.escape('name') + '</b>?',\n                yesText: 'Delete',\n                escapedHtml: true,\n                confirmCallback: _.bind(function () {\n                    file.once('g:deleted', function () {\n                        girder.events.trigger('g:alert', {\n                            icon: 'ok',\n                            type: 'success',\n                            text: 'File deleted.',\n                            timeout: 4000\n                        });\n\n                        this.render();\n                    }, this).once('g:error', function () {\n                        girder.events.trigger('g:alert', {\n                            icon: 'cancel',\n                            text: 'Failed to delete file.',\n                            type: 'danger',\n                            timeout: 4000\n                        });\n                    }).destroy();\n                }, this)\n            });\n        }\n    },\n\n    initialize: function (settings) {\n        this.upload = settings.upload;\n        this.fileEdit = settings.fileEdit;\n        this.checked = [];\n        this.collection = new girder.collections.FileCollection();\n        this.collection.altUrl = 'item/' +\n            (settings.itemId || settings.item.get('_id')) + '/files';\n        this.collection.append = true; // Append, don't replace pages\n        this.collection.on('g:changed', function () {\n            this.render();\n            this.trigger('g:changed');\n        }, this).fetch();\n\n        this.parentItem = settings.item;\n    },\n\n    editFileDialog: function (cid) {\n        this.editFileWidget = new girder.views.EditFileWidget({\n            el: $('#g-dialog-container'),\n            file: this.collection.get(cid),\n            parentView: this\n        }).off('g:saved', null, this).on('g:saved', function () {\n            this.render();\n        }, this);\n        this.editFileWidget.render();\n    },\n\n    uploadDialog: function (cid) {\n        new girder.views.UploadWidget({\n            el: $('#g-dialog-container'),\n            title: 'Replace file contents',\n            parent: this.collection.get(cid),\n            parentType: 'file',\n            parentView: this\n        }).on('g:uploadFinished', function () {\n            girder.events.trigger('g:alert', {\n                icon: 'ok',\n                text: 'File contents updated.',\n                type: 'success',\n                timeout: 4000\n            });\n        }, this).render();\n    },\n\n    render: function () {\n        this.checked = [];\n        this.$el.html(girder.templates.fileList({\n            files: this.collection.toArray(),\n            hasMore: this.collection.hasNextPage(),\n            girder: girder,\n            parentItem: this.parentItem\n        }));\n\n        this.$('.g-file-list-entry a[title]').tooltip({\n            container: 'body',\n            placement: 'auto',\n            delay: 100\n        });\n\n        if (this.fileEdit) {\n            this.editFileDialog(this.fileEdit);\n            this.fileEdit = false;\n        } else if (this.upload) {\n            this.uploadDialog(this.upload);\n            this.upload = false;\n        }\n\n        return this;\n    },\n\n    /**\n     * Insert a file into the collection and re-render it.\n     */\n    insertFile: function (file) {\n        this.collection.add(file);\n        this.render();\n        this.trigger('g:changed');\n    }\n});\n","/**\n * This view shows a dialog container detailed folder information.\n */\ngirder.views.FolderInfoWidget = girder.View.extend({\n    initialize: function () {\n        this.needToFetch = !this.model.has('nItems') || !this.model.has('nFolders');\n        if (this.needToFetch) {\n            this.model.fetch({extraPath: 'details'}).once('g:fetched.details', function () {\n                this.needToFetch = false;\n                this.render();\n            }, this);\n        }\n    },\n\n    render: function () {\n        if (this.needToFetch) {\n            return;\n        }\n\n        this.$el.html(girder.templates.folderInfoDialog({\n            folder: this.model,\n            girder: girder\n        })).girderModal(this);\n    }\n});\n","/**\n * This widget shows a list of folders under a given parent.\n * Initialize this with a \"parentType\" and \"parentId\" value, which will\n * be passed to the folder GET endpoint.\n */\ngirder.views.FolderListWidget = girder.View.extend({\n    events: {\n        'click a.g-folder-list-link': function (event) {\n            var cid = $(event.currentTarget).attr('g-folder-cid');\n            this.trigger('g:folderClicked', this.collection.get(cid));\n        },\n        'click a.g-show-more-folders': function () {\n            this.collection.fetchNextPage();\n        }\n    },\n\n    initialize: function (settings) {\n        this.checked = [];\n        this._checkboxes = settings.checkboxes;\n\n        new girder.views.LoadingAnimation({\n            el: this.$el,\n            parentView: this\n        }).render();\n\n        this.collection = new girder.collections.FolderCollection();\n        this.collection.append = true; // Append, don't replace pages\n        this.collection.on('g:changed', function () {\n            this.render();\n            this.trigger('g:changed');\n        }, this).fetch({\n            parentType: settings.parentType || 'folder',\n            parentId: settings.parentId\n        });\n    },\n\n    render: function () {\n        this.checked = [];\n        this.$el.html(girder.templates.folderList({\n            folders: this.collection.toArray(),\n            hasMore: this.collection.hasNextPage(),\n            checkboxes: this._checkboxes\n        }));\n\n        var view = this;\n        this.$('.g-list-checkbox').change(function () {\n            var cid = $(this).attr('g-folder-cid');\n            if (this.checked) {\n                view.checked.push(cid);\n            } else {\n                var idx = view.checked.indexOf(cid);\n                if (idx !== -1) {\n                    view.checked.splice(idx, 1);\n                }\n            }\n            view.trigger('g:checkboxesChanged');\n        });\n        return this;\n    },\n\n    /**\n     * Insert a folder into the collection and re-render it.\n     */\n    insertFolder: function (folder) {\n        this.collection.add(folder);\n        this.trigger('g:changed');\n        this.render();\n    },\n\n    /**\n     * Set all folder checkboxes to a certain checked state. The event\n     * g:checkboxesChanged is triggered once after checking/unchecking everything.\n     * @param {bool} checked The checked state.\n     */\n    checkAll: function (checked) {\n        this.$('.g-list-checkbox').prop('checked', checked);\n\n        this.checked = [];\n        if (checked) {\n            this.collection.each(function (model) {\n                this.checked.push(model.cid);\n            }, this);\n        }\n\n        this.trigger('g:checkboxesChanged');\n    },\n\n    recomputeChecked: function () {\n        this.checked = _.map(this.$('.g-list-checkbox:checked'), function (checkbox) {\n            return $(checkbox).attr('g-folder-cid');\n        }, this);\n    }\n});\n","/**\n * This view shows a list of administrators of a group.\n */\ngirder.views.GroupAdminsWidget = girder.View.extend({\n    events: {\n        'click .g-demote-moderator': function (e) {\n            var li = $(e.currentTarget).parents('.g-group-admins>li');\n            var userid = li.attr('userid');\n            var view = this;\n\n            girder.confirm({\n                text: 'Are you sure you want to demote <b>' +\n                    _.escape(li.attr('username')) + '</b> to a moderator?',\n                escapedHtml: true,\n                confirmCallback: function () {\n                    var user = new girder.models.UserModel({_id: userid});\n                    view.model.off('g:promoted').on('g:promoted', function () {\n                        this.trigger('g:moderatorAdded');\n                    }, view).promoteUser(user, girder.AccessType.WRITE);\n                }\n            });\n        },\n\n        'click .g-demote-member': function (e) {\n            var li = $(e.currentTarget).parents('.g-group-admins>li');\n            var view = this;\n\n            girder.confirm({\n                text: 'Are you sure you want to remove admin privileges ' +\n                    'from <b>' + _.escape(li.attr('username')) + '</b>?',\n                escapedHtml: true,\n                confirmCallback: function () {\n                    view.trigger('g:demoteUser', li.attr('userid'));\n                }\n            });\n        },\n\n        'click a.g-group-admin-remove': function (e) {\n            var view = this;\n            var li = $(e.currentTarget).parents('li');\n\n            girder.confirm({\n                text: 'Are you sure you want to remove <b> ' +\n                    _.escape(li.attr('username')) +\n                    '</b> from this group?',\n                escapedHtml: true,\n                confirmCallback: function () {\n                    view.trigger('g:removeMember', li.attr('userid'));\n                }\n            });\n        },\n\n        'click a.g-member-name': function (e) {\n            girder.events.trigger('g:navigateTo', girder.views.UserView, {\n                id: $(e.currentTarget).parents('li').attr('userid')\n            });\n        }\n    },\n\n    initialize: function (settings) {\n        this.model = settings.group;\n        this.admins = settings.admins;\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.groupAdminList({\n            group: this.model,\n            level: this.model.get('_accessLevel'),\n            admins: this.admins,\n            accessType: girder.AccessType\n        }));\n\n        this.$('.g-group-admin-demote').tooltip({\n            container: 'body',\n            placement: 'left',\n            animation: false,\n            delay: {show: 100}\n        });\n\n        return this;\n    }\n});\n","/**\n * This view shows a list of pending invitations to the group.\n */\ngirder.views.GroupInvitesWidget = girder.View.extend({\n    events: {\n        'click .g-group-uninvite': function (e) {\n            var li = $(e.currentTarget).parents('li');\n            var view = this;\n\n            girder.confirm({\n                text: 'Are you sure you want to remove the invitation ' +\n                    'for <b>' + _.escape(li.attr('username')) + '</b>?',\n                escapedHtml: true,\n                confirmCallback: function () {\n                    var user = view.collection.get(li.attr('cid'));\n                    view.group.off('g:removed').on('g:removed', function () {\n                        view.collection.remove(user);\n                        view.render();\n                        view.parentView.render();\n                    }).removeMember(user.get('_id'));\n                }\n            });\n        },\n\n        'click a.g-member-name': function (e) {\n            var user = this.collection.get($(e.currentTarget).parents('li').attr('cid'));\n            girder.router.navigate('user/' + user.get('_id'), {trigger: true});\n        }\n    },\n\n    initialize: function (settings) {\n        this.collection = settings.invitees;\n        this.group = settings.group;\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.groupInviteList({\n            level: this.group.get('_accessLevel'),\n            invitees: this.collection.toArray(),\n            accessType: girder.AccessType\n        }));\n\n        this.$('a[title]').tooltip({\n            container: this.$el,\n            placement: 'left',\n            animation: false,\n            delay: {show: 100}\n        });\n\n        return this;\n    }\n});\n","/**\n * This view shows a list of members of a group.\n */\ngirder.views.GroupMembersWidget = girder.View.extend({\n    events: {\n        'click a.g-member-name': function (e) {\n            var model = this.membersColl.get(\n                $(e.currentTarget).parents('li').attr('cid')\n            );\n            girder.router.navigate('user/' + model.get('_id'), {trigger: true});\n        },\n\n        'click a.g-group-member-remove': function (e) {\n            var view = this;\n            var user = this.membersColl.get(\n                $(e.currentTarget).parents('li').attr('cid')\n            );\n\n            girder.confirm({\n                text: 'Are you sure you want to remove <b> ' + _.escape(user.name()) +\n                    '</b> from this group?',\n                escapedHtml: true,\n                confirmCallback: function () {\n                    view.trigger('g:removeMember', user);\n                }\n            });\n        },\n\n        'click .g-promote-moderator': function (e) {\n            var cid = $(e.currentTarget).parents('.g-group-members>li')\n                                        .attr('cid');\n            var user = this.membersColl.get(cid);\n            this.model.off('g:promoted').on('g:promoted', function () {\n                this.trigger('g:moderatorAdded');\n            }, this).promoteUser(user, girder.AccessType.WRITE);\n        },\n\n        'click .g-promote-admin': function (e) {\n            var cid = $(e.currentTarget).parents('.g-group-members>li')\n                                        .attr('cid');\n            var user = this.membersColl.get(cid);\n            this.model.off('g:promoted').on('g:promoted', function () {\n                this.trigger('g:adminAdded');\n            }, this).promoteUser(user, girder.AccessType.ADMIN);\n        }\n    },\n\n    initialize: function (settings) {\n        this.model = settings.group;\n        this.modsAndAdmins = [];\n        var view = this;\n        _.each(settings.admins, function (user) {\n            view.modsAndAdmins.push(user.id);\n        });\n        _.each(settings.moderators, function (user) {\n            view.modsAndAdmins.push(user.id);\n        });\n        this.membersColl = new girder.collections.UserCollection();\n        this.membersColl.altUrl =\n            'group/' + this.model.get('_id') + '/member';\n        this.membersColl.on('g:changed', function () {\n            this.render();\n        }, this).fetch();\n    },\n\n    render: function () {\n        var members = [];\n        for (var i = 0; i < this.membersColl.models.length; i += 1) {\n            var member = this.membersColl.models[i];\n            if ($.inArray(member.id, this.modsAndAdmins) < 0) {\n                members.push(member);\n            }\n        }\n        this.$el.html(girder.templates.groupMemberList({\n            group: this.model,\n            members: members,\n            level: this.model.get('_accessLevel'),\n            accessType: girder.AccessType\n        }));\n\n        new girder.views.PaginateWidget({\n            el: this.$('.g-member-pagination'),\n            collection: this.membersColl,\n            parentView: this\n        }).render();\n\n        this.userSearch = new girder.views.SearchFieldWidget({\n            el: this.$('.g-group-invite-container'),\n            placeholder: 'Invite a user to join...',\n            types: ['user'],\n            parentView: this\n        }).off().on('g:resultClicked', this._inviteUser, this).render();\n\n        this.$('.g-group-member-remove,.g-group-member-promote').tooltip({\n            container: 'body',\n            placement: 'left',\n            animation: false,\n            delay: {show: 100}\n        });\n\n        return this;\n    },\n\n    /**\n     * When user searches and clicks a user, this method is called and a\n     * dialog is opened allowing the user to select a role to invite into.\n     */\n    _inviteUser: function (user) {\n        this.userSearch.resetState();\n\n        new girder.views.InviteUserDialog({\n            el: $('#g-dialog-container'),\n            group: this.model,\n            user: user,\n            parentView: this\n        }).on('g:sendInvite', function (params) {\n            this.trigger('g:sendInvite', params);\n        }, this).render();\n    }\n});\n\ngirder.views.InviteUserDialog = girder.View.extend({\n    events: {\n        'click .g-invite-as-member': function () {\n            this._sendInvitation(girder.AccessType.READ);\n        },\n\n        'click .g-invite-as-moderator': function () {\n            this._sendInvitation(girder.AccessType.WRITE);\n        },\n\n        'click .g-invite-as-admin': function () {\n            this._sendInvitation(girder.AccessType.ADMIN);\n        },\n\n        'click .g-add-as-member': function () {\n            this._sendInvitation(girder.AccessType.READ, true);\n        },\n\n        'click .g-add-as-moderator': function () {\n            this._sendInvitation(girder.AccessType.WRITE, true);\n        },\n\n        'click .g-add-as-admin': function () {\n            this._sendInvitation(girder.AccessType.ADMIN, true);\n        }\n    },\n\n    initialize: function (settings) {\n        this.group = settings.group;\n        this.user = settings.user;\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.groupInviteDialog({\n            group: this.group,\n            user: this.user,\n            level: this.group.get('_accessLevel'),\n            accessType: girder.AccessType,\n            mayAdd: this.group.mayAddMembers()\n        })).girderModal(this);\n\n        return this;\n    },\n\n    _sendInvitation: function (level, force) {\n        this.$el.modal('hide');\n        this.trigger('g:sendInvite', {\n            user: this.user,\n            group: this.group,\n            level: level,\n            force: force\n        });\n    }\n});\n","/**\n * This view shows a list of moderators of a group.\n */\ngirder.views.GroupModsWidget = girder.View.extend({\n    events: {\n        'click .g-group-mod-promote': function (e) {\n            var userid = $(e.currentTarget).parents('li').attr('userid');\n            var user = new girder.models.UserModel({_id: userid});\n            this.model.off('g:promoted').on('g:promoted', function () {\n                this.trigger('g:adminAdded');\n            }, this).promoteUser(user, girder.AccessType.ADMIN);\n        },\n\n        'click .g-group-mod-demote': function (e) {\n            var li = $(e.currentTarget).parents('li');\n            var view = this;\n\n            girder.confirm({\n                text: 'Are you sure you want to remove moderator privileges ' +\n                    'from <b>' + _.escape(li.attr('username')) + '</b>?',\n                escapedHtml: true,\n                confirmCallback: function () {\n                    view.trigger('g:demoteUser', li.attr('userid'));\n                }\n            });\n        },\n\n        'click a.g-group-mod-remove': function (e) {\n            var view = this;\n            var li = $(e.currentTarget).parents('li');\n\n            girder.confirm({\n                text: 'Are you sure you want to remove <b> ' +\n                    _.escape(li.attr('username')) +\n                    '</b> from this group?',\n                escapedHtml: true,\n                confirmCallback: function () {\n                    view.trigger('g:removeMember', li.attr('userid'));\n                }\n            });\n        },\n\n        'click a.g-member-name': function (e) {\n            girder.events.trigger('g:navigateTo', girder.views.UserView, {\n                id: $(e.currentTarget).parents('li').attr('userid')\n            });\n        }\n    },\n\n    initialize: function (settings) {\n        this.model = settings.group;\n        this.moderators = settings.moderators;\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.groupModList({\n            group: this.model,\n            level: this.model.get('_accessLevel'),\n            moderators: this.moderators,\n            accessType: girder.AccessType\n        }));\n\n        this.$('.g-group-mod-demote.g-group-mod-promote,.g-group-mod-remove').tooltip({\n            container: 'body',\n            placement: 'left',\n            animation: false,\n            delay: {show: 100}\n        });\n\n        return this;\n    }\n});\n","/**\n * This widget is used to navigate the data hierarchy of folders and items.\n */\ngirder.views.HierarchyWidget = girder.View.extend({\n    events: {\n        'click a.g-create-subfolder': 'createFolderDialog',\n        'click a.g-edit-folder': 'editFolderDialog',\n        'click a.g-delete-folder': 'deleteFolderDialog',\n        'click .g-folder-info-button': 'showInfoDialog',\n        'click .g-collection-info-button': 'showInfoDialog',\n        'click .g-description-preview': 'showInfoDialog',\n        'click a.g-create-item': 'createItemDialog',\n        'click .g-upload-here-button': 'uploadDialog',\n        'click .g-edit-access': 'editAccess',\n        'click .g-hierarchy-level-up': 'upOneLevel',\n        'click a.g-download-checked': 'downloadChecked',\n        'click a.g-pick-checked': 'pickChecked',\n        'click a.g-move-picked': 'movePickedResources',\n        'click a.g-copy-picked': 'copyPickedResources',\n        'click a.g-clear-picked': 'clearPickedResources',\n        'click a.g-delete-checked': 'deleteCheckedDialog',\n        'click .g-list-checkbox': 'checkboxListener',\n        'change .g-select-all': function (e) {\n            this.folderListView.checkAll(e.currentTarget.checked);\n\n            if (this.itemListView) {\n                this.itemListView.checkAll(e.currentTarget.checked);\n            }\n        }\n    },\n\n    /**\n     * This should be instantiated with the following settings:\n     *   parentModel: The model representing the root node. Must be a User,\n     *                 Collection, or Folder model.\n     *   [showActions=true]: Whether to show the action bar.\n     *   [showItems=true]: Whether to show items in the list (or just folders).\n     *   [checkboxes=true]: Whether to show checkboxes next to each resource.\n     *   [routing=true]: Whether the route should be updated by this widget.\n     *   [appendPages=false]: Whether new pages should be appended instead of\n     *                        replaced.\n     *   [onItemClick]: A function that will be called when an item is clicked,\n     *                  passed the Item model as its first argument and the\n     *                  event as its second.\n     */\n    initialize: function (settings) {\n        this.parentModel = settings.parentModel;\n        this.upload = settings.upload;\n\n        this._showActions = _.has(settings, 'showActions') ? settings.showActions : true;\n        this._showItems = _.has(settings, 'showItems') ? settings.showItems : true;\n        this._checkboxes = _.has(settings, 'checkboxes') ? settings.checkboxes : true;\n        this._routing = _.has(settings, 'routing') ? settings.routing : true;\n        this._appendPages = _.has(settings, 'appendPages') ? settings.appendPages : false;\n        this._onItemClick = settings.onItemClick || function (item) {\n            girder.router.navigate('item/' + item.get('_id'), {trigger: true});\n        };\n\n        this.folderAccess = settings.folderAccess;\n        this.folderCreate = settings.folderCreate;\n        this.folderEdit = settings.folderEdit;\n        this.itemCreate = settings.itemCreate;\n        this.breadcrumbs = [this.parentModel];\n\n        // Initialize the breadcrumb bar state\n        this.breadcrumbView = new girder.views.HierarchyBreadcrumbView({\n            objects: this.breadcrumbs,\n            parentView: this\n        });\n        this.breadcrumbView.on('g:breadcrumbClicked', function (idx) {\n            this.breadcrumbs = this.breadcrumbs.slice(0, idx + 1);\n            this.setCurrentModel(this.breadcrumbs[idx]);\n            this._setRoute();\n        }, this);\n\n        this.checkedMenuWidget = new girder.views.CheckedMenuWidget({\n            pickedCount: this.getPickedCount(),\n            pickedCopyAllowed: this.getPickedCopyAllowed(),\n            pickedMoveAllowed: this.getPickedMoveAllowed(),\n            pickedDesc: this.getPickedDescription(),\n            parentView: this\n        });\n\n        this.folderListView = new girder.views.FolderListWidget({\n            parentType: this.parentModel.resourceName,\n            parentId: this.parentModel.get('_id'),\n            checkboxes: this._checkboxes,\n            parentView: this\n        });\n        this.folderListView.on('g:folderClicked', function (folder) {\n            this.descend(folder);\n\n            if (this.uploadWidget) {\n                this.uploadWidget.folder = folder;\n            }\n        }, this).off('g:checkboxesChanged')\n                .on('g:checkboxesChanged', this.updateChecked, this)\n                .off('g:changed').on('g:changed', function () {\n                    this.folderCount = this.folderListView.collection.length;\n                    this._childCountCheck();\n                }, this);\n\n        if (this.parentModel.resourceName === 'folder') {\n            this._initFolderViewSubwidgets();\n        } else {\n            this.itemCount = 0;\n        }\n\n        if (this.parentModel.resourceName === 'folder') {\n            this._fetchToRoot(this.parentModel);\n        } else {\n            this.render();\n        }\n        girder.events.on('g:login', girder.resetPickedResources, this);\n    },\n\n    /**\n     * If both the child folders and child items have been fetched, and\n     * there are neither of either type in this parent container, we should\n     * show the \"empty container\" message.\n     */\n    _childCountCheck: function () {\n        var container = this.$('.g-empty-parent-message').addClass('hide');\n        if (this.folderCount === 0 && this.itemCount === 0) {\n            container.removeClass('hide');\n        }\n    },\n\n    /**\n     * Initializes the subwidgets that are only shown when the parent resource\n     * is a folder type.\n     */\n    _initFolderViewSubwidgets: function () {\n        this.itemListView = new girder.views.ItemListWidget({\n            folderId: this.parentModel.get('_id'),\n            checkboxes: this._checkboxes,\n            parentView: this\n        });\n        this.itemListView.on('g:itemClicked', this._onItemClick, this)\n            .off('g:checkboxesChanged')\n            .on('g:checkboxesChanged', this.updateChecked, this)\n            .off('g:changed').on('g:changed', function () {\n                this.itemCount = this.itemListView.collection.length;\n                this._childCountCheck();\n            }, this);\n\n        this.metadataWidget = new girder.views.MetadataWidget({\n            item: this.parentModel,\n            parentView: this,\n            accessLevel: this.parentModel.getAccessLevel()\n        });\n    },\n\n    _setRoute: function () {\n        if (this._routing) {\n            var route = this.breadcrumbs[0].resourceName + '/' +\n                this.breadcrumbs[0].get('_id');\n            if (this.parentModel.resourceName === 'folder') {\n                route += '/folder/' + this.parentModel.get('_id');\n            }\n            girder.router.navigate(route);\n            girder.events.trigger('g:hierarchy.route', {route: route});\n        }\n    },\n\n    _fetchToRoot: function (folder) {\n        var parentId = folder.get('parentId');\n        var parentType = folder.get('parentCollection');\n        var parent = new girder.models[girder.getModelClassByName(parentType)]();\n        parent.set({\n            _id: parentId\n        }).once('g:fetched', function () {\n            this.breadcrumbs.push(parent);\n\n            if (parentType === 'folder') {\n                this._fetchToRoot(parent);\n            } else {\n                this.breadcrumbs.reverse();\n                this.render();\n            }\n        }, this).fetch();\n    },\n\n    render: function () {\n        this.folderCount = null;\n        this.itemCount = null;\n\n        this.$el.html(girder.templates.hierarchyWidget({\n            type: this.parentModel.resourceName,\n            model: this.parentModel,\n            level: this.parentModel.getAccessLevel(),\n            AccessType: girder.AccessType,\n            showActions: this._showActions,\n            checkboxes: this._checkboxes,\n            girder: girder\n        }));\n\n        if (this.$('.g-folder-actions-menu>li>a').length === 0) {\n            // Disable the actions button if actions list is empty\n            this.$('.g-folder-actions-button').attr('disabled', 'disabled');\n        }\n\n        this.breadcrumbView.setElement(this.$('.g-hierarchy-breadcrumb-bar>ol')).render();\n        this.checkedMenuWidget.dropdownToggle = this.$('.g-checked-actions-button');\n        this.checkedMenuWidget.setElement(this.$('.g-checked-actions-menu')).render();\n        this.folderListView.setElement(this.$('.g-folder-list-container')).render();\n\n        if (this.parentModel.resourceName === 'folder' && this._showItems) {\n            this.itemListView.setElement(this.$('.g-item-list-container')).render();\n            this.metadataWidget.setItem(this.parentModel);\n            this.metadataWidget.setElement(this.$('.g-folder-metadata')).render();\n        }\n\n        this.$('[title]').tooltip({\n            container: this.$el,\n            animation: false,\n            delay: {\n                show: 100\n            },\n            placement: function () {\n                return this.$element.attr('placement') || 'top';\n            }\n        });\n\n        if (this.upload) {\n            this.uploadDialog();\n        } else if (this.folderAccess) {\n            this.editAccess();\n        } else if (this.folderCreate) {\n            this.createFolderDialog();\n        } else if (this.folderEdit) {\n            this.editFolderDialog();\n        } else if (this.itemCreate) {\n            this.createItemDialog();\n        }\n\n        this.fetchAndShowChildCount();\n\n        return this;\n    },\n\n    /**\n     * Descend into the given folder.\n     */\n    descend: function (folder) {\n        this.breadcrumbs.push(folder);\n        this.setCurrentModel(folder);\n    },\n\n    /**\n     * Go to the parent of the current folder\n     */\n    upOneLevel: function () {\n        this.breadcrumbs.pop();\n        this.setCurrentModel(this.breadcrumbs[this.breadcrumbs.length - 1]);\n    },\n\n    /**\n     * Prompt the user to create a new subfolder in the current folder.\n     */\n    createFolderDialog: function () {\n        new girder.views.EditFolderWidget({\n            el: $('#g-dialog-container'),\n            parentModel: this.parentModel,\n            parentView: this\n        }).on('g:saved', function (folder) {\n            this.folderListView.insertFolder(folder);\n            if (this.parentModel.has('nFolders')) {\n                this.parentModel.increment('nFolders');\n            }\n            this.updateChecked();\n        }, this).render();\n    },\n\n    /**\n     * Prompt the user to create a new item in the current folder\n     */\n    createItemDialog: function () {\n        new girder.views.EditItemWidget({\n            el: $('#g-dialog-container'),\n            parentModel: this.parentModel,\n            parentView: this\n        }).on('g:saved', function (item) {\n            this.itemListView.insertItem(item);\n            if (this.parentModel.has('nItems')) {\n                this.parentModel.increment('nItems');\n            }\n            this.updateChecked();\n        }, this).render();\n    },\n\n    /**\n     * Prompt user to edit the current folder or collection.\n     */\n    editFolderDialog: function () {\n        if (this.parentModel.resourceName === 'folder') {\n            new girder.views.EditFolderWidget({\n                el: $('#g-dialog-container'),\n                parentModel: this.parentModel,\n                folder: this.parentModel,\n                parentView: this\n            }).on('g:saved', function () {\n                girder.events.trigger('g:alert', {\n                    icon: 'ok',\n                    text: 'Folder info updated.',\n                    type: 'success',\n                    timeout: 4000\n                });\n                this.breadcrumbView.render();\n            }, this).on('g:fileUploaded', function (args) {\n                var item = new girder.models.ItemModel({\n                    _id: args.model.get('itemId')\n                });\n\n                item.once('g:fetched', function () {\n                    this.itemListView.insertItem(item);\n                    if (this.parentModel.has('nItems')) {\n                        this.parentModel.increment('nItems');\n                    }\n                    this.updateChecked();\n                }, this).fetch();\n            }, this).render();\n        } else if (this.parentModel.resourceName === 'collection') {\n            new girder.views.EditCollectionWidget({\n                el: $('#g-dialog-container'),\n                model: this.parentModel,\n                parentView: this\n            }).on('g:saved', function () {\n                this.breadcrumbView.render();\n                this.trigger('g:collectionChanged');\n            }, this).render();\n        }\n    },\n\n    /**\n     * Prompt the user to delete the currently viewed folder or collection.\n     */\n    deleteFolderDialog: function () {\n        var type = this.parentModel.resourceName;\n        var params = {\n            text: 'Are you sure you want to delete the ' + type + ' <b>' +\n                  this.parentModel.escape('name') + '</b>?',\n            escapedHtml: true,\n            yesText: 'Delete',\n            confirmCallback: _.bind(function () {\n                this.parentModel.destroy({\n                    throwError: true,\n                    progress: true\n                }).on('g:deleted', function () {\n                    if (type === 'collection') {\n                        girder.router.navigate('collections', {trigger: true});\n                    } else if (type === 'folder') {\n                        this.breadcrumbs.pop();\n                        this.setCurrentModel(this.breadcrumbs.slice(-1)[0]);\n                    }\n                }, this);\n            }, this)\n        };\n        girder.confirm(params);\n    },\n\n    /**\n     * Deprecated alias for showInfoDialog.\n     * @deprecated\n     */\n    folderInfoDialog: function () {\n        this.showInfoDialog();\n    },\n\n    showInfoDialog: function () {\n        var opts = {\n            el: $('#g-dialog-container'),\n            model: this.parentModel,\n            parentView: this\n        };\n\n        if (this.parentModel.resourceName === 'collection') {\n            new girder.views.CollectionInfoWidget(opts).render();\n        } else if (this.parentModel.resourceName === 'folder') {\n            new girder.views.FolderInfoWidget(opts).render();\n        }\n    },\n\n    fetchAndShowChildCount: function () {\n        this.$('.g-child-count-container').addClass('hide');\n\n        var showCounts = _.bind(function () {\n            this.$('.g-child-count-container').removeClass('hide');\n            this.$('.g-subfolder-count').text(\n                girder.formatCount(this.parentModel.get('nFolders')));\n            if (this.parentModel.has('nItems')) {\n                this.$('.g-item-count').text(\n                    girder.formatCount(this.parentModel.get('nItems')));\n            }\n        }, this);\n\n        if (this.parentModel.has('nFolders')) {\n            showCounts();\n        } else {\n            this.parentModel.set('nFolders', 0); // prevents fetching details twice\n            this.parentModel.once('g:fetched.details', function () {\n                showCounts();\n            }, this).fetch({extraPath: 'details'});\n        }\n\n        this.parentModel.off('change:nItems', showCounts, this)\n                        .on('change:nItems', showCounts, this)\n                        .off('change:nFolders', showCounts, this)\n                        .on('change:nFolders', showCounts, this);\n\n        return this;\n    },\n\n    /**\n     * Change the current parent model, i.e. the resource being shown currently.\n     *\n     * @param parent The parent model to change to.\n     */\n    setCurrentModel: function (parent, opts) {\n        opts = opts || {};\n        this.parentModel = parent;\n\n        this.breadcrumbView.objects = this.breadcrumbs;\n\n        this.folderListView.initialize({\n            parentType: parent.resourceName,\n            parentId: parent.get('_id'),\n            checkboxes: this._checkboxes\n        });\n\n        this.updateChecked();\n\n        if (parent.resourceName === 'folder') {\n            if (this.itemListView) {\n                this.itemListView.initialize({\n                    folderId: parent.get('_id'),\n                    checkboxes: this._checkboxes\n                });\n            } else {\n                this._initFolderViewSubwidgets();\n            }\n        }\n\n        this.render();\n        if (!_.has(opts, 'setRoute') || opts.setRoute) {\n            this._setRoute();\n        }\n        this.trigger('g:setCurrentModel');\n    },\n\n    /**\n     * Based on a resource collection with either has model references or\n     * checkbox references, return a string that describes the collection.\n     * :param resources: a hash with different resources.\n     * :returns: description of the resources.\n     */\n    _describeResources: function (resources) {\n        /* If the resources aren't English words or don't have simple plurals,\n         * this will need to be refactored. */\n        var kinds = ['folder', 'item'];\n\n        var desc = [];\n        for (var i = 0; i < kinds.length; i += 1) {\n            var kind = kinds[i];\n            if (resources[kind] && resources[kind].length) {\n                desc.push(resources[kind].length + ' ' + kind +\n                          (resources[kind].length !== 1 ? 's' : ''));\n            }\n        }\n        switch (desc.length) {\n            case 0:\n                return 'nothing';\n            case 1:\n                return desc[0];\n            case 2:\n                return desc[0] + ' and ' + desc [1];\n            /* If we add a third model type, enable this:\n            default:\n                desc[desc.length-1] = 'and ' + desc[desc.length-1];\n                return ', '.join(desc);\n             */\n        }\n    },\n\n    /**\n     * Prompt the user to delete the currently checked items.\n     */\n    deleteCheckedDialog: function () {\n        var view = this;\n        var folders = this.folderListView.checked;\n        var items;\n        if (this.itemListView && this.itemListView.checked.length) {\n            items = this.itemListView.checked;\n        }\n        var desc = this._describeResources({folder: folders, item: items});\n\n        var params = {\n            text: 'Are you sure you want to delete the checked resources (' +\n                  desc + ')?',\n\n            yesText: 'Delete',\n            confirmCallback: function () {\n                var resources = view._getCheckedResourceParam();\n                /* Content on DELETE requests is somewhat oddly supported (I\n                 * can't get it to work under jasmine/phantom), so override the\n                 * method. */\n                girder.restRequest({\n                    path: 'resource',\n                    type: 'POST',\n                    data: {resources: resources, progress: true},\n                    headers: {'X-HTTP-Method-Override': 'DELETE'}\n                }).done(function () {\n                    if (items && items.length && view.parentModel.has('nItems')) {\n                        view.parentModel.increment('nItems', -items.length);\n                    }\n                    if (folders.length && view.parentModel.has('nFolders')) {\n                        view.parentModel.increment('nFolders', -folders.length);\n                    }\n\n                    view.setCurrentModel(view.parentModel, {setRoute: false});\n                });\n            }\n        };\n        girder.confirm(params);\n    },\n\n    /**\n     * Show and handle the upload dialog\n     */\n    uploadDialog: function () {\n        var container = $('#g-dialog-container');\n\n        new girder.views.UploadWidget({\n            el: container,\n            parent: this.parentModel,\n            parentType: this.parentType,\n            parentView: this\n        }).on('g:uploadFinished', function (info) {\n            girder.dialogs.handleClose('upload');\n            this.upload = false;\n            if (this.parentModel.has('nItems')) {\n                this.parentModel.increment('nItems', info.files.length);\n            }\n            if (this.parentModel.has('size')) {\n                this.parentModel.increment('size', info.totalSize);\n            }\n            this.setCurrentModel(this.parentModel, {setRoute: false});\n        }, this).render();\n    },\n\n    /**\n     * When any of the checkboxes is changed, this will be called to update\n     * the checked menu state.\n     */\n    updateChecked: function () {\n        var folders = this.folderListView.checked,\n            items = [];\n\n        // Only show actions corresponding to the minimum access level over\n        // the whole set of checked resources.\n        var minFolderLevel = girder.AccessType.ADMIN;\n        _.every(folders, function (cid) {\n            var folder = this.folderListView.collection.get(cid);\n            minFolderLevel = Math.min(minFolderLevel, folder.getAccessLevel());\n            return minFolderLevel > girder.AccessType.READ; // acts as 'break'\n        }, this);\n\n        var minItemLevel = girder.AccessType.ADMIN;\n        if (this.itemListView) {\n            items = this.itemListView.checked;\n            if (items.length) {\n                minItemLevel = Math.min(minItemLevel, this.parentModel.getAccessLevel());\n            }\n        }\n\n        if (folders.length + items.length) {\n            // Disable folder actions if checkboxes are checked\n            this.$('.g-folder-actions-button').attr('disabled', 'disabled');\n        } else {\n            this.$('.g-folder-actions-button').removeAttr('disabled');\n        }\n\n        this.checkedMenuWidget.update({\n            minFolderLevel: minFolderLevel,\n            minItemLevel: minItemLevel,\n            folderCount: folders.length,\n            itemCount: items.length,\n            pickedCount: this.getPickedCount(),\n            pickedCopyAllowed: this.getPickedCopyAllowed(),\n            pickedMoveAllowed: this.getPickedMoveAllowed(),\n            pickedDesc: this.getPickedDescription()\n        });\n    },\n\n    getPickedCount: function () {\n        var pickedCount = 0;\n        if (girder.pickedResources && girder.pickedResources.resources) {\n            _.each(girder.pickedResources.resources, function (list) {\n                pickedCount += list.length;\n            });\n        }\n        return pickedCount;\n    },\n\n    getPickedCopyAllowed: function () {\n        /* We must have something picked */\n        if (!girder.pickedResources) {\n            return false;\n        }\n        /* If we have an item picked but this page isn't a folder's list, then\n         * you can't move or copy them here. */\n        if (this.parentModel.resourceName !== 'folder') {\n            if (girder.pickedResources.resources.item &&\n                    girder.pickedResources.resources.item.length) {\n                return false;\n            }\n        }\n        /* We must have permission to write to this folder to be allowed to\n         * copy. */\n        if (this.parentModel.getAccessLevel() < girder.AccessType.WRITE) {\n            return false;\n        }\n        return true;\n    },\n\n    getPickedMoveAllowed: function () {\n        /* All of the restrictions for copy are the same */\n        if (!this.getPickedCopyAllowed()) {\n            return false;\n        }\n        /* We also can't move an item or folder if we don't have permission to\n         * delete that item or folder (since a move deletes it from the\n         * original spot). */\n        if (girder.pickedResources.minFolderLevel < girder.AccessType.ADMIN) {\n            return false;\n        }\n        if (girder.pickedResources.minItemLevel < girder.AccessType.WRITE) {\n            return false;\n        }\n        return true;\n    },\n\n    getPickedDescription: function () {\n        if (!girder.pickedResources || !girder.pickedResources.resources) {\n            return '';\n        }\n        return this._describeResources(girder.pickedResources.resources);\n    },\n\n    /**\n     * Get a parameter that can be added to a url for the checked resources.\n     */\n    _getCheckedResourceParam: function (asObject) {\n        var resources = {folder: [], item: []};\n        var folders = this.folderListView.checked;\n        _.each(folders, function (cid) {\n            var folder = this.folderListView.collection.get(cid);\n            resources.folder.push(folder.id);\n        }, this);\n        if (this.itemListView) {\n            var items = this.itemListView.checked;\n            _.each(items, function (cid) {\n                var item = this.itemListView.collection.get(cid);\n                resources.item.push(item.id);\n                return true;\n            }, this);\n        }\n        _.each(resources, function (list, key) {\n            if (!list.length) {\n                delete resources[key];\n            }\n        });\n        if (asObject) {\n            return resources;\n        }\n        return JSON.stringify(resources);\n    },\n\n    downloadChecked: function () {\n        var url = girder.apiRoot + '/resource/download';\n        var resources = this._getCheckedResourceParam();\n        var data = {resources: resources};\n\n        this.redirectViaForm('POST', url, data);\n    },\n\n    pickChecked: function () {\n        if (!girder.pickedResources) {\n            girder.pickedResources = {\n                resources: {},\n                minItemLevel: girder.AccessType.ADMIN,\n                minFolderLevel: girder.AccessType.ADMIN\n            };\n        }\n        /* Maintain our minimum permissions.  It is expensive to compute them\n         * arbitrarily later. */\n        var folders = this.folderListView.checked;\n        _.every(folders, function (cid) {\n            var folder = this.folderListView.collection.get(cid);\n            girder.pickedResources.minFolderLevel = Math.min(\n                girder.pickedResources.minFolderLevel,\n                folder.getAccessLevel());\n            return (girder.pickedResources.minFolderLevel >\n                    girder.AccessType.READ); // acts as 'break'\n        }, this);\n        if (this.itemListView) {\n            var items = this.itemListView.checked;\n            if (items.length) {\n                girder.pickedResources.minItemLevel = Math.min(\n                    girder.pickedResources.minItemLevel,\n                    this.parentModel.getAccessLevel());\n            }\n        }\n        var resources = this._getCheckedResourceParam(true);\n        var pickDesc = this._describeResources(resources);\n        /* Merge these resources with any that are already picked */\n        var existing = girder.pickedResources.resources;\n        _.each(existing, function (list, resource) {\n            if (!resources[resource]) {\n                resources[resource] = list;\n            } else {\n                resources[resource] = _.union(list, resources[resource]);\n            }\n        });\n        girder.pickedResources.resources = resources;\n        this.updateChecked();\n        var totalPickDesc = this.getPickedDescription();\n        var desc = totalPickDesc + ' picked.';\n        if (pickDesc !== totalPickDesc) {\n            desc = pickDesc + ' added to picked resources.  Now ' + desc;\n        }\n        girder.events.trigger('g:alert', {\n            icon: 'ok',\n            text: desc,\n            type: 'info',\n            timeout: 4000\n        });\n    },\n\n    _incrementCounts: function (nFolders, nItems) {\n        if (this.parentModel.has('nItems')) {\n            this.parentModel.increment('nItems', nItems);\n        }\n        if (this.parentModel.has('nFolders')) {\n            this.parentModel.increment('nFolders', nFolders);\n        }\n    },\n\n    movePickedResources: function () {\n        if (!this.getPickedMoveAllowed()) {\n            return;\n        }\n        var resources = JSON.stringify(girder.pickedResources.resources);\n        var nFolders = (girder.pickedResources.resources.folder || []).length;\n        var nItems = (girder.pickedResources.resources.item || []).length;\n        girder.restRequest({\n            path: 'resource/move',\n            type: 'PUT',\n            data: {\n                resources: resources,\n                parentType: this.parentModel.resourceName,\n                parentId: this.parentModel.get('_id'),\n                progress: true\n            }\n        }).done(_.bind(function () {\n            this._incrementCounts(nFolders, nItems);\n            this.setCurrentModel(this.parentModel, {setRoute: false});\n        }, this));\n        this.clearPickedResources();\n    },\n\n    copyPickedResources: function () {\n        if (!this.getPickedCopyAllowed()) {\n            return;\n        }\n        var resources = JSON.stringify(girder.pickedResources.resources);\n        var nFolders = (girder.pickedResources.resources.folder || []).length;\n        var nItems = (girder.pickedResources.resources.item || []).length;\n        girder.restRequest({\n            path: 'resource/copy',\n            type: 'POST',\n            data: {\n                resources: resources,\n                parentType: this.parentModel.resourceName,\n                parentId: this.parentModel.get('_id'),\n                progress: true\n            }\n        }).done(_.bind(function () {\n            this._incrementCounts(nFolders, nItems);\n            this.setCurrentModel(this.parentModel, {setRoute: false});\n        }, this));\n        this.clearPickedResources();\n    },\n\n    clearPickedResources: function (event) {\n        girder.resetPickedResources();\n        this.updateChecked();\n        if (event) {\n            girder.events.trigger('g:alert', {\n                icon: 'ok',\n                text: 'Cleared picked resources',\n                type: 'info',\n                timeout: 4000\n            });\n        }\n    },\n\n    redirectViaForm: function (method, url, data) {\n        var form = $('<form action=\"' + url + '\" method=\"' + method + '\"/>');\n        _.each(data, function (value, key) {\n            form.append($('<input/>').attr(\n                {type: 'text', name: key, value: value}));\n        });\n        $(form).submit();\n    },\n\n    editAccess: function () {\n        new girder.views.AccessWidget({\n            el: $('#g-dialog-container'),\n            modelType: this.parentModel.resourceName,\n            model: this.parentModel,\n            parentView: this\n        }).on('g:accessListSaved', function (params) {\n            if (params.recurse) {\n                // Refresh list since the public flag may have changed on the children.\n                this.refreshFolderList();\n            }\n        }, this);\n    },\n\n    /**\n     * Deprecated alias for editAccess.\n     * @deprecated\n     */\n    editFolderAccess: function () {\n        this.editAccess();\n    },\n\n    /**\n     * Reloads the folder list view.\n     */\n    refreshFolderList: function () {\n        this.folderListView.collection.fetch(null, true);\n    },\n\n    /**\n     * Select (highlight) an item in the list.\n     * @param item An ItemModel instance representing the item to select.\n     */\n    selectItem: function (item) {\n        this.itemListView.selectItem(item);\n    },\n\n    /**\n     * Return the currently selected item, or null if there is no selected item.\n     */\n    getSelectedItem: function () {\n        return this.itemListView.getSelectedItem();\n    },\n\n    /**\n     * In order to handle range selection, we must listen to checkbox changes\n     * at this level, in case a range selection crosses the boundary between\n     * folders and items.\n     */\n    checkboxListener: function (e) {\n        var checkbox = $(e.currentTarget);\n\n        if (this._lastCheckbox) {\n            if (e.shiftKey) {\n                var checkboxes = this.$el.find(':checkbox');\n                var from = checkboxes.index(this._lastCheckbox);\n                var to = checkboxes.index(checkbox);\n\n                checkboxes.slice(Math.min(from, to), Math.max(from, to) + 1)\n                    .prop('checked', checkbox.prop('checked'));\n\n                this.folderListView.recomputeChecked();\n\n                if (this.itemListView) {\n                    this.itemListView.recomputeChecked();\n                }\n\n                this.updateChecked();\n            }\n        }\n        this._lastCheckbox = checkbox;\n    }\n});\n\n/* Because we need to be able to clear picked resources when the current user\n * changes, this function is placed in the girder namespace. */\ngirder.resetPickedResources = function () {\n    girder.pickedResources = null;\n};\n\n/**\n * Renders the breadcrumb list in the hierarchy widget.\n */\ngirder.views.HierarchyBreadcrumbView = girder.View.extend({\n    events: {\n        'click a.g-breadcrumb-link': function (event) {\n            var link = $(event.currentTarget);\n            this.trigger('g:breadcrumbClicked', parseInt(link.attr('g-index'), 10));\n        }\n    },\n\n    initialize: function (settings) {\n        this.objects = settings.objects;\n    },\n\n    render: function () {\n        // Clone the array so we don't alter the instance's copy\n        var objects = this.objects.slice(0);\n\n        // Pop off the last object, it refers to the currently viewed\n        // object and should be the \"active\" class, and not a link.\n        var active = objects.pop();\n\n        var descriptionText = $(girder.renderMarkdown(\n            active.get('description') || '')).text();\n\n        this.$el.html(girder.templates.hierarchyBreadcrumb({\n            links: objects,\n            current: active,\n            descriptionText: descriptionText\n        }));\n    }\n});\n","/**\n * Renders the a breadcrumb for the item page\n */\ngirder.views.ItemBreadcrumbWidget = girder.View.extend({\n    events: {\n        'click a.g-item-breadcrumb-link': function (event) {\n            var link = $(event.currentTarget);\n            girder.router.navigate(link.data('type') + '/' + link.data('id'),\n                                   {trigger: true});\n        },\n        'click a.g-hierarchy-level-up': function () {\n            var folder = this.parentChain.pop().object;\n            girder.router.navigate('folder/' + folder._id, {trigger: true});\n        }\n    },\n\n    initialize: function (settings) {\n        this.parentChain = settings.parentChain;\n        this.render();\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.itemBreadcrumb({\n            parentChain: this.parentChain\n        }));\n\n        this.$('.g-hierarchy-level-up').tooltip({\n            container: this.$el,\n            placement: 'left',\n            animation: false,\n            delay: {show: 100}\n        });\n    }\n});\n","/**\n * This widget shows a list of items under a given folder.\n */\ngirder.views.ItemListWidget = girder.View.extend({\n    events: {\n        'click a.g-item-list-link': function (event) {\n            var cid = $(event.currentTarget).attr('g-item-cid');\n            this.trigger('g:itemClicked', this.collection.get(cid), event);\n        },\n        'click a.g-show-more-items': function () {\n            this.collection.fetchNextPage();\n        }\n    },\n\n    initialize: function (settings) {\n        this.checked = [];\n        this._checkboxes = settings.checkboxes;\n\n        new girder.views.LoadingAnimation({\n            el: this.$el,\n            parentView: this\n        }).render();\n\n        this.collection = new girder.collections.ItemCollection();\n        this.collection.append = true; // Append, don't replace pages\n        this.collection.on('g:changed', function () {\n            this.render();\n            this.trigger('g:changed');\n        }, this).fetch({\n            folderId: settings.folderId\n        });\n    },\n\n    render: function () {\n        this.checked = [];\n        this.$el.html(girder.templates.itemList({\n            items: this.collection.toArray(),\n            hasMore: this.collection.hasNextPage(),\n            girder: girder,\n            checkboxes: this._checkboxes\n        }));\n\n        this.$('.g-item-list-entry a[title]').tooltip({\n            container: 'body',\n            placement: 'auto',\n            delay: 100\n        });\n\n        var view = this;\n        this.$('.g-list-checkbox').change(function () {\n            var cid = $(this).attr('g-item-cid');\n            if (this.checked) {\n                view.checked.push(cid);\n            } else {\n                var idx = view.checked.indexOf(cid);\n                if (idx !== -1) {\n                    view.checked.splice(idx, 1);\n                }\n            }\n            view.trigger('g:checkboxesChanged');\n        });\n        return this;\n    },\n\n    /**\n     * Insert an item into the collection and re-render it.\n     */\n    insertItem: function (item) {\n        this.collection.add(item);\n        this.trigger('g:changed');\n        this.render();\n    },\n\n    /**\n     * Set all item checkboxes to a certain checked state. The event\n     * g:checkboxesChanged is triggered once after checking/unchecking everything.\n     * @param {bool} checked The checked state.\n     */\n    checkAll: function (checked) {\n        this.$('.g-list-checkbox').prop('checked', checked);\n\n        this.checked = [];\n        if (checked) {\n            this.collection.each(function (model) {\n                this.checked.push(model.cid);\n            }, this);\n        }\n\n        this.trigger('g:checkboxesChanged');\n    },\n\n    /**\n     * Select (highlight) an item in the list.\n     * @param item An ItemModel instance representing the item to select.\n     */\n    selectItem: function (item) {\n        this.$('li.g-item-list-entry').removeClass('g-selected');\n        this.$('a.g-item-list-link[g-item-cid=' + item.cid + ']')\n            .parents('li.g-item-list-entry').addClass('g-selected');\n    },\n\n    /**\n     * Return the currently selected item, or null if there is no selected item.\n     */\n    getSelectedItem: function () {\n        var el = this.$('li.g-item-list-entry.g-selected');\n        if (!el.length) {\n            return null;\n        }\n        var cid = $('.g-item-list-link', $(el[0])).attr('g-item-cid');\n        return this.collection.get(cid);\n    },\n\n    recomputeChecked: function () {\n        this.checked = _.map(this.$('.g-list-checkbox:checked'), function (checkbox) {\n            return $(checkbox).attr('g-item-cid');\n        }, this);\n    }\n});\n","/**\n * This widget can be used to display a small loading animation.\n */\ngirder.views.LoadingAnimation = girder.View.extend({\n    render: function () {\n        this.$el.html(girder.templates.loadingAnimation());\n        return this;\n    }\n});\n","/**\n * A simple widget for editing markdown text with a preview tab.\n */\ngirder.views.MarkdownWidget = girder.View.extend({\n    events: {\n        'show.bs.tab .g-preview-link': function () {\n            girder.renderMarkdown(this.val().trim() || 'Nothing to show',\n                                  this.$('.g-markdown-preview'));\n        },\n\n        'shown.bs.tab .g-write-link': function () {\n            this.$('.g-markdown-text').focus();\n        },\n\n        'click .g-browse': function () {\n            this.$('.g-file-input').click();\n        },\n\n        'change .g-file-input': function (e) {\n            var files = e.target.files;\n\n            if (files.length) {\n                this.files = files;\n                this.filesAdded();\n            }\n        },\n\n        'dragenter .g-markdown-drop-zone': function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n            e.originalEvent.dataTransfer.dropEffect = 'copy';\n            this.$('.g-markdown-text,.g-upload-footer').addClass('dragover');\n        },\n\n        'dragleave .g-markdown-drop-zone': function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n            this.$('.g-markdown-text,.g-upload-footer').removeClass('dragover');\n        },\n\n        'dragover .g-markdown-drop-zone': function (e) {\n            e.originalEvent.dataTransfer.dropEffect = 'copy';\n            this.$('.g-markdown-text,.g-upload-footer').addClass('dragover');\n        },\n\n        'drop .g-markdown-drop-zone': function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n            this.$('.g-markdown-text,.g-upload-footer').removeClass('dragover');\n            this.files = e.originalEvent.dataTransfer.files;\n            this.filesAdded();\n        }\n    },\n\n    /**\n     * @param [settings.text=''] Initial markdown text.\n     * @param [settings.placeholder=''] Text area placeholder.\n     * @param [settings.prefix='markdown'] Prefix for element IDs in case\n     *     multiple of these widgets are rendered simultaneously.\n     * @param [settings.enableUploads=false] Whether to allow uploading files\n     *     inline into the markdown.\n     * @param [settings.maxUploadSize=10 MB] Max upload size in bytes.\n     * @param [settings.parent] If enableUploads is true, set this to the object\n     *     into which files should be uploaded.\n     * @param [settings.allowedExtensions=null] If you want to restrict to\n     *     certain file extensions, set this to a list of (lowercase) extensions,\n     *     not including periods. E.g.: [\"png\", \"jpg\", \"jpeg\"]\n     */\n    initialize: function (settings) {\n        this.text = settings.text || '';\n        this.placeholder = settings.placeholder || '';\n        this.prefix = settings.prefix || 'markdown';\n        this.enableUploads = settings.enableUploads || false;\n        this.parent = settings.parent || null;\n        this.maxUploadSize = settings.maxUploadSize || 1024 * 1024 * 10;\n        this.allowedExtensions = settings.allowedExtensions || null;\n        this.files = [];\n    },\n\n    filesAdded: function () {\n        try {\n            this.validateFiles();\n        } catch (err) {\n            girder.events.trigger('g:alert', {\n                type: 'danger',\n                text: err.message,\n                icon: 'cancel',\n                timeout: 5000\n            });\n            return;\n        }\n\n        var file = this.files[0];\n        var fileModel = new girder.models.FileModel();\n\n        fileModel.on('g:upload.complete', function () {\n            var val = this.$('.g-markdown-text').val();\n            val += '![' + file.name + '](' + fileModel.downloadUrl() + ')\\n';\n\n            this.$('.g-upload-overlay').addClass('hide');\n            this.$('.g-markdown-text').removeAttr('disabled').val(val);\n\n            this.trigger('g:fileUploaded', {\n                file: file,\n                model: fileModel\n            });\n        }, this).on('g:upload.progress', function (info) {\n            var currentProgress = info.startByte + info.loaded;\n            this.$('.g-markdown-upload-progress>.progress-bar').css('width',\n                Math.ceil(100 * currentProgress / info.total) + '%');\n            this.$('.g-markdown-upload-progress-message').text(\n                'Uploading ' + info.file.name + ' - ' +\n                   girder.formatSize(currentProgress) + ' / ' +\n                   girder.formatSize(info.total)\n            );\n        }, this).on('g:upload.error', function (info) {\n            girder.events.trigger('g:alert', {\n                type: 'danger',\n                text: info.message,\n                icon: 'cancel',\n                timeout: 5000\n            });\n            this.$('.g-upload-overlay').addClass('hide');\n            this.$('.g-markdown-text').removeAttr('disabled');\n        }, this).on('g:upload.errorStarting', function (info) {\n            girder.events.trigger('g:alert', {\n                type: 'danger',\n                text: info.message,\n                icon: 'cancel',\n                timeout: 5000\n            });\n            this.$('.g-upload-overlay').addClass('hide');\n            this.$('.g-markdown-text').removeAttr('disabled');\n        }, this).upload(this.parent, file);\n\n        this.$('.g-upload-overlay').removeClass('hide');\n        this.$('.g-markdown-text').attr('disabled', true);\n    },\n\n    /**\n     * Validate a selection of files. If invalid, throws an object containing\n     * a \"message\" field.\n     */\n    validateFiles: function (files) {\n        files = files || this.files;\n\n        if (this.files.length !== 1) {\n            throw {message: 'Please add only one file at a time.'};\n        }\n\n        var file = files[0],\n            ext = file.name.split('.').pop().toLowerCase();\n\n        if (this.maxUploadSize && file.size > this.maxUploadSize) {\n            throw {\n                message: 'That file is too large. You may only attach files ' +\n                         'up to ' + girder.formatSize(this.maxUploadSize) + '.'\n            };\n        }\n\n        if (this.allowedExtensions && !_.contains(this.allowedExtensions, ext)) {\n            throw {\n                message: 'Only files with the following extensions are allowed: ' +\n                         this.allowedExtensions.join(', ') + '.'\n            };\n        }\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.markdownWidget({\n            text: this.text,\n            placeholder: this.placeholder,\n            prefix: this.prefix,\n            enableUploads: this.enableUploads\n        }));\n\n        return this;\n    },\n\n    /**\n     * Get or set the current markdown text. Call with no arguments to return\n     * the current value, or call with one argument to set the value to that.\n     */\n    val: function () {\n        if (arguments.length) {\n            return this.$('.g-markdown-text').val(arguments[0]);\n        } else {\n            return this.$('.g-markdown-text').val();\n        }\n    }\n});\n","/**\n * This widget shows a list of metadata in a given item.\n */\ngirder.views.MetadataWidget = girder.View.extend({\n    events: {\n        'click .g-add-json-metadata': function (event) {\n            this.addMetadata(event, 'json');\n        },\n        'click .g-add-simple-metadata': function (event) {\n            this.addMetadata(event, 'simple');\n        }\n    },\n\n    /**\n     * Creates a widget to display and optionally edit metadata fields.\n     *\n     * @param settings.item {girder.Model} The model object whose metadata to display.\n     *    Can be any model type that inherits girder.models.MetadataMixin.\n     * @param [settings.fieldName='meta'] {string} The name of the model attribute\n     *    to display/edit. The model attribute with this name should be an object\n     *    whose top level keys represent metadata keys.\n     * @param [settings.title='Metadata'] {string} Title for the widget.\n     * @param [settings.apiPath] {string} The relative API path to use when editing\n     *    metadata keys for this model. Defaults to using the MetadataMixin default path.\n     * @param [settings.accessLevel=girder.AccessType.READ] {girder.AccessType} The\n     *    access level for this widget. Use READ for read-only, or WRITE (or greater)\n     *    for adding editing capabilities as well.\n     * @param [settings.onMetadataAdded] {Function} A custom callback for when a\n     *    new metadata key is added to the list. If passed, will override the\n     *    default behavior of calling MetadataMixin.addMetadata.\n     * @param [settings.onMetadataEdited] {Function} A custom callback for when an\n     *    existing metadata key is updated. If passed, will override the default\n     *    behavior of calling MetadataMixin.editMetadata.\n     */\n    initialize: function (settings) {\n        this.item = settings.item;\n        this.fieldName = settings.fieldName || 'meta';\n        this.title = settings.title || 'Metadata';\n        this.apiPath = settings.apiPath;\n        this.accessLevel = settings.accessLevel;\n        this.onMetadataEdited = settings.onMetadataEdited;\n        this.onMetadataAdded = settings.onMetadataAdded;\n\n        this.item.on('g:changed', function () {\n            this.render();\n        }, this);\n        this.render();\n    },\n\n    modes: {\n        simple: {\n            editor: function (args) {\n                return new girder.views.MetadatumEditWidget(args);\n            },\n            displayValue: function () {\n                return this.value;\n            },\n            template: girder.templates.metadatumView\n        },\n        json: {\n            editor: function (args) {\n                if (args.value !== undefined) {\n                    args.value = JSON.parse(args.value);\n                }\n                return new girder.views.JsonMetadatumEditWidget(args);\n            },\n            displayValue: function () {\n                return JSON.stringify(this.value, null, 4);\n            },\n            validation: {\n                from: {\n                    simple: [\n                        function (value) {\n                            try {\n                                JSON.parse(value);\n                                return true;\n                            } catch (e) {}\n\n                            return false;\n                        },\n                        'The simple field is not valid JSON and can not be converted.'\n                    ]\n                }\n            },\n            template: girder.templates.jsonMetadatumView\n        }\n    },\n\n    setItem: function (item) {\n        this.item = item;\n        return this;\n    },\n\n    // Does not support modal editing\n    getModeFromValue: function (value) {\n        return _.isString(value) ? 'simple' : 'json';\n    },\n\n    addMetadata: function (event, mode) {\n        var EditWidget = this.modes[mode].editor;\n        var newRow = $('<div>').attr({\n            class: 'g-widget-metadata-row editing'\n        }).appendTo(this.$el.find('.g-widget-metadata-container'));\n        var value = (mode === 'json') ? '{}' : '';\n\n        var widget = new girder.views.MetadatumWidget({\n            el: newRow,\n            mode: mode,\n            key: '',\n            value: value,\n            item: this.item,\n            fieldName: this.fieldName,\n            apiPath: this.apiPath,\n            accessLevel: this.accessLevel,\n            girder: girder,\n            parentView: this,\n            onMetadataEdited: this.onMetadataEdited,\n            onMetadataAdded: this.onMetadataAdded\n        });\n\n        var newEditRow = $('<div>').appendTo(widget.$el);\n\n        new EditWidget({\n            el: newEditRow,\n            item: this.item,\n            key: '',\n            value: value,\n            fieldName: this.fieldName,\n            apiPath: this.apiPath,\n            accessLevel: this.accessLevel,\n            newDatum: true,\n            parentView: widget,\n            onMetadataEdited: this.onMetadataEdited,\n            onMetadataAdded: this.onMetadataAdded\n        }).render();\n    },\n\n    render: function () {\n        var metaDict = this.item.get(this.fieldName) || {};\n        var metaKeys = Object.keys(metaDict);\n        metaKeys.sort(girder.localeSort);\n\n        // Metadata header\n        this.$el.html(girder.templates.metadataWidget({\n            item: this.item,\n            title: this.title,\n            accessLevel: this.accessLevel,\n            girder: girder\n        }));\n\n        // Append each metadatum\n        _.each(metaKeys, function (metaKey) {\n            this.$el.find('.g-widget-metadata-container').append(new girder.views.MetadatumWidget({\n                mode: this.getModeFromValue(metaDict[metaKey]),\n                key: metaKey,\n                value: metaDict[metaKey],\n                accessLevel: this.accessLevel,\n                girder: girder,\n                parentView: this,\n                fieldName: this.fieldName,\n                apiPath: this.apiPath,\n                onMetadataEdited: this.onMetadataEdited,\n                onMetadataAdded: this.onMetadataAdded\n            }).render().$el);\n        }, this);\n\n        this.$('.g-widget-metadata-add-button').tooltip({\n            container: this.$el,\n            placement: 'left',\n            animation: false,\n            delay: {show: 100}\n        });\n\n        return this;\n    }\n});\n\ngirder.views.MetadatumWidget = girder.View.extend({\n    events: {\n        'click .g-widget-metadata-edit-button': 'editMetadata'\n    },\n\n    initialize: function (settings) {\n        if (!_.has(this.parentView.modes, settings.mode)) {\n            throw 'Unsupported metadatum mode ' + settings.mode + ' detected.';\n        }\n\n        this.mode = settings.mode;\n        this.key = settings.key;\n        this.value = settings.value;\n        this.accessLevel = settings.accessLevel;\n        this.parentView = settings.parentView;\n        this.fieldName = settings.fieldName;\n        this.apiPath = settings.apiPath;\n        this.onMetadataEdited = settings.onMetadataEdited;\n        this.onMetadataAdded = settings.onMetadataAdded;\n    },\n\n    _validate: function (from, to, value) {\n        var newMode = this.parentView.modes[to];\n\n        if (_.has(newMode, 'validation') &&\n            _.has(newMode.validation, 'from') &&\n            _.has(newMode.validation.from, from)) {\n            var validate = newMode.validation.from[from][0];\n            var msg = newMode.validation.from[from][1];\n\n            if (!validate(value)) {\n                girder.events.trigger('g:alert', {\n                    text: msg,\n                    type: 'warning'\n                });\n                return false;\n            }\n        }\n\n        return true;\n    },\n\n    // @todo too much duplication with editMetadata\n    toggleEditor: function (event, newEditorMode, existingEditor, overrides) {\n        var fromEditorMode =\n                (existingEditor instanceof girder.views.JsonMetadatumEditWidget)\n                    ? 'json' : 'simple';\n        var newValue = (overrides || {}).value || existingEditor.$el.attr('g-value');\n        if (!this._validate(fromEditorMode, newEditorMode, newValue)) {\n            return;\n        }\n\n        var row = existingEditor.$el;\n        existingEditor.destroy();\n        row.addClass('editing').empty();\n\n        var opts = _.extend({\n            el: row,\n            item: this.parentView.item,\n            key: row.attr('g-key'),\n            value: row.attr('g-value'),\n            accessLevel: this.accessLevel,\n            newDatum: false,\n            parentView: this,\n            fieldName: this.fieldName,\n            apiPath: this.apiPath,\n            onMetadataEdited: this.onMetadataEdited,\n            onMetadataAdded: this.onMetadataAdded\n        }, overrides || {});\n\n        this.parentView.modes[newEditorMode].editor(opts).render();\n    },\n\n    editMetadata: function (event) {\n        var row = $(event.currentTarget.parentElement);\n        row.addClass('editing').empty();\n\n        var newEditRow = row.append('<div></div>');\n\n        var opts = {\n            el: newEditRow.find('div'),\n            item: this.parentView.item,\n            key: row.attr('g-key'),\n            value: row.attr('g-value'),\n            accessLevel: this.accessLevel,\n            newDatum: false,\n            parentView: this,\n            fieldName: this.fieldName,\n            apiPath: this.apiPath,\n            onMetadataEdited: this.onMetadataEdited,\n            onMetadataAdded: this.onMetadataAdded\n        };\n\n        // If they're trying to open false, null, 6, etc which are not stored as strings\n        if (this.mode === 'json') {\n            try {\n                var jsonValue = JSON.parse(row.attr('g-value'));\n\n                if (jsonValue !== undefined && !_.isObject(jsonValue)) {\n                    opts.value = jsonValue;\n                }\n            } catch (e) {}\n        }\n\n        this.parentView.modes[this.mode].editor(opts).render();\n    },\n\n    render: function () {\n        this.$el.attr({\n            class: 'g-widget-metadata-row',\n            'g-key': this.key,\n            'g-value': _.bind(this.parentView.modes[this.mode].displayValue, this)()\n        }).empty();\n\n        this.$el.html(this.parentView.modes[this.mode].template({\n            key: this.key,\n            value: _.bind(this.parentView.modes[this.mode].displayValue, this)(),\n            accessLevel: this.accessLevel,\n            girder: girder\n        }));\n\n        return this;\n    }\n});\n\ngirder.views.MetadatumEditWidget = girder.View.extend({\n    events: {\n        'click .g-widget-metadata-cancel-button': 'cancelEdit',\n        'click .g-widget-metadata-save-button': 'save',\n        'click .g-widget-metadata-delete-button': 'deleteMetadatum',\n        'click .g-widget-metadata-toggle-button': function (event) {\n            var editorType;\n            // @todo modal\n            // in the future this event will have the new editorType (assuming a dropdown)\n            if (this instanceof girder.views.JsonMetadatumEditWidget) {\n                editorType = 'simple';\n            } else {\n                editorType = 'json';\n            }\n\n            this.parentView.toggleEditor(event, editorType, this, {\n                // Save state before toggling editor\n                key: this.$el.find('.g-widget-metadata-key-input').val(),\n                value: this.getCurrentValue()\n            });\n        }\n    },\n\n    initialize: function (settings) {\n        this.item = settings.item;\n        this.key = settings.key || '';\n        this.fieldName = settings.fieldName || 'meta';\n        this.value = (settings.value !== undefined) ? settings.value : '';\n        this.accessLevel = settings.accessLevel;\n        this.newDatum = settings.newDatum;\n        this.fieldName = settings.fieldName;\n        this.apiPath = settings.apiPath;\n        this.onMetadataEdited = settings.onMetadataEdited;\n        this.onMetadataAdded = settings.onMetadataAdded;\n    },\n\n    editTemplate: girder.templates.metadatumEditWidget,\n\n    getCurrentValue: function () {\n        return this.$el.find('.g-widget-metadata-value-input').val();\n    },\n\n    deleteMetadatum: function (event) {\n        event.stopImmediatePropagation();\n        var metadataList = $(event.currentTarget.parentElement).parent();\n        var params = {\n            text: 'Are you sure you want to delete the metadatum <b>' +\n                _.escape(this.key) + '</b>?',\n            escapedHtml: true,\n            yesText: 'Delete',\n            confirmCallback: _.bind(function () {\n                this.item.removeMetadata(this.key, function () {\n                    metadataList.remove();\n                }, null, {\n                    field: this.fieldName,\n                    path: this.apiPath\n                });\n            }, this)\n        };\n        girder.confirm(params);\n    },\n\n    cancelEdit: function (event) {\n        event.stopImmediatePropagation();\n        var curRow = $(event.currentTarget.parentElement).parent();\n        if (this.newDatum) {\n            curRow.remove();\n        } else {\n            this.parentView.render();\n        }\n    },\n\n    save: function (event, value) {\n        event.stopImmediatePropagation();\n        var curRow = $(event.currentTarget.parentElement),\n            tempKey = curRow.find('.g-widget-metadata-key-input').val(),\n            tempValue = (value !== undefined) ? value : curRow.find('.g-widget-metadata-value-input').val();\n\n        if (this.newDatum && tempKey === '') {\n            girder.events.trigger('g:alert', {\n                text: 'A key is required for all metadata.',\n                type: 'warning'\n            });\n            return;\n        }\n\n        var saveCallback = _.bind(function () {\n            this.key = tempKey;\n            this.value = tempValue;\n\n            this.parentView.key = this.key;\n            this.parentView.value = this.value;\n\n            if (this instanceof girder.views.JsonMetadatumEditWidget) {\n                this.parentView.mode = 'json';\n            } else {\n                this.parentView.mode = 'simple';\n            }\n\n            this.parentView.render();\n\n            this.newDatum = false;\n        }, this);\n\n        var errorCallback = function (out) {\n            girder.events.trigger('g:alert', {\n                text: out.message,\n                type: 'danger'\n            });\n        };\n\n        if (this.newDatum) {\n            if (this.onMetadataAdded) {\n                this.onMetadataAdded(tempKey, tempValue, saveCallback, errorCallback);\n            } else {\n                this.item.addMetadata(tempKey, tempValue, saveCallback, errorCallback, {\n                    field: this.fieldName,\n                    path: this.apiPath\n                });\n            }\n        } else {\n            if (this.onMetadataEdited) {\n                this.onMetadataEdited(tempKey, this.key, tempValue, saveCallback, errorCallback);\n            } else {\n                this.item.editMetadata(tempKey, this.key, tempValue, saveCallback, errorCallback, {\n                    field: this.fieldName,\n                    path: this.apiPath\n                });\n            }\n        }\n    },\n\n    render: function () {\n        this.$el.html(this.editTemplate({\n            item: this.item,\n            key: this.key,\n            value: this.value,\n            accessLevel: this.accessLevel,\n            newDatum: this.newDatum,\n            girder: girder\n        }));\n        this.$el.find('.g-widget-metadata-key-input').focus();\n\n        this.$('[title]').tooltip({\n            container: this.$el,\n            placement: 'bottom',\n            animation: false,\n            delay: {show: 100}\n        });\n\n        return this;\n    }\n});\n\ngirder.views.JsonMetadatumEditWidget = girder.views.MetadatumEditWidget.extend({\n    editTemplate: girder.templates.jsonMetadatumEditWidget,\n\n    getCurrentValue: function () {\n        return this.editor.getText();\n    },\n\n    save: function (event) {\n        try {\n            girder.views.MetadatumEditWidget.prototype.save.call(\n                this, event, this.editor.get());\n        } catch (err) {\n            girder.events.trigger('g:alert', {\n                text: 'The field contains invalid JSON and can not be saved.',\n                type: 'warning'\n            });\n        }\n    },\n\n    render: function () {\n        girder.views.MetadatumEditWidget.prototype.render.apply(this, arguments);\n\n        this.editor = new JSONEditor(this.$el.find('.g-json-editor')[0], {\n            mode: 'tree',\n            modes: ['code', 'tree'],\n            error: function () {\n                girder.events.trigger('g:alert', {\n                    text: 'The field contains invalid JSON and can not be viewed in Tree Mode.',\n                    type: 'warning'\n                });\n            }\n        });\n\n        if (this.value !== undefined) {\n            this.editor.setText(JSON.stringify(this.value));\n            this.editor.expandAll();\n        }\n\n        return this;\n    }\n});\n","/**\n * This widget is for creating new assetstores. The parent view is responsible\n * for checking admin privileges before rendering this widget.\n */\ngirder.views.NewAssetstoreWidget = girder.View.extend({\n    events: {\n        'submit #g-new-fs-form': function (e) {\n            this.createAssetstore(e, this.$('#g-new-fs-error'), {\n                type: girder.AssetstoreType.FILESYSTEM,\n                name: this.$('#g-new-fs-name').val(),\n                root: this.$('#g-new-fs-root').val()\n            });\n        },\n\n        'submit #g-new-gridfs-form': function (e) {\n            this.createAssetstore(e, this.$('#g-new-gridfs-error'), {\n                type: girder.AssetstoreType.GRIDFS,\n                name: this.$('#g-new-gridfs-name').val(),\n                db: this.$('#g-new-gridfs-db').val(),\n                mongohost: this.$('#g-new-gridfs-mongohost').val(),\n                replicaset: this.$('#g-new-gridfs-replicaset').val()\n            });\n        },\n\n        'submit #g-new-s3-form': function (e) {\n            this.createAssetstore(e, this.$('#g-new-s3-error'), {\n                type: girder.AssetstoreType.S3,\n                name: this.$('#g-new-s3-name').val(),\n                bucket: this.$('#g-new-s3-bucket').val(),\n                prefix: this.$('#g-new-s3-prefix').val(),\n                accessKeyId: this.$('#g-new-s3-access-key-id').val(),\n                secret: this.$('#g-new-s3-secret').val(),\n                service: this.$('#g-new-s3-service').val(),\n                readOnly: this.$('#g-new-s3-readonly').is(':checked')\n            });\n        }\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.newAssetstore());\n        return this;\n    },\n\n    /**\n     * Call this to make the request to the server to create the assetstore.\n     * @param e The submit event from the form.\n     * @param container The element to write the error message into.\n     * @param data The form data to POST to /assetstore\n     */\n    createAssetstore: function (e, container, data) {\n        e.preventDefault();\n        this.$('.g-new-assetstore-submit').addClass('disabled');\n        container.empty();\n\n        var assetstore = new girder.models.AssetstoreModel();\n        assetstore.set(data);\n        assetstore.on('g:saved', function () {\n            this.$('.g-new-assetstore-submit').removeClass('disabled');\n            this.trigger('g:created', assetstore);\n        }, this).on('g:error', function (err) {\n            this.$('.g-new-assetstore-submit').removeClass('disabled');\n            container.text(err.responseJSON.message);\n        }, this).save();\n    }\n});\n","/**\n * This widget is used to provide a consistent widget for iterating amongst\n * pages of a girder.Collection.\n */\ngirder.views.PaginateWidget = girder.View.extend({\n    events: {\n        'click .g-page-next': function (e) {\n            if (!$(e.currentTarget).hasClass('disabled')) {\n                this.collection.fetchNextPage();\n            }\n        },\n        'click .g-page-prev': function (e) {\n            if (!$(e.currentTarget).hasClass('disabled')) {\n                this.collection.fetchPreviousPage();\n            }\n        }\n    },\n\n    initialize: function (settings) {\n        this.collection = settings.collection;\n    },\n\n    /**\n     * Do not call render() until the collection has been fetched once.\n     */\n    render: function () {\n        this.$el.html(girder.templates.paginateWidget({\n            collection: this.collection\n        }));\n\n        if (this.collection.hasNextPage()) {\n            this.$('.g-page-next').removeClass('disabled');\n        } else {\n            this.$('.g-page-next').addClass('disabled');\n        }\n\n        if (this.collection.hasPreviousPage()) {\n            this.$('.g-page-prev').removeClass('disabled');\n        } else {\n            this.$('.g-page-prev').addClass('disabled');\n        }\n        return this;\n    }\n});\n","/**\n * This widget provides a consistent breadcrumb to be displayed on the admin\n * configuration pages for plugins.\n */\ngirder.views.PluginConfigBreadcrumbWidget = girder.View.extend({\n    events: {\n        'click a.g-admin-console-link': function () {\n            girder.router.navigate('admin', {trigger: true});\n        },\n        'click a.g-plugins-link': function () {\n            girder.router.navigate('plugins', {trigger: true});\n        }\n    },\n\n    initialize: function (settings) {\n        this.pluginName = settings.pluginName;\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.pluginConfigBreadcrumb({\n            pluginName: this.pluginName\n        }));\n\n        return this;\n    }\n});\n","/**\n * This widget creates a dropdown box allowing the user to select\n * \"root\" paths for a hierarchy widget.\n *\n * @emits RootSelectorWidget#g:selected The selected element changed\n * @type {object}\n * @property {girder.Model|null} root The selected root model\n * @property {string|null} group The selection group\n *\n * @emits RootSelectorWidget#g:group A collection group was updated\n * @type {object}\n * @property {girder.Collection} collection\n */\ngirder.views.RootSelectorWidget = girder.View.extend({\n    events: {\n        'change #g-root-selector': '_selectRoot'\n    },\n\n    /**\n     * Initialize the widget.  The caller can configure the list of items\n     * that are present in the select box.  If no values are given, then\n     * appropriate rest calls will be made to fetch models automatically.\n     *\n     * Additional categories of roots can be provided via an object mapping,\n     * for example:\n     *\n     *   {\n     *     friends: new girder.collections.UserCollection([...]),\n     *     saved: new girder.collections.FolderCollection([...])\n     *   }\n     *\n     * Only a single page of results are displayed for each collection provided.\n     * The default maximum number can be configured, but for more sophisticated\n     * behavior, the caller should act on the collection objects directly and\n     * rerender.\n     *\n     * @param {object} settings\n     * @param {girder.models.UserModel} [settings.home=girder.currentUser]\n     * @param {object} [settings.groups] Additional collection groups to add\n     * @param {number} [settings.pageLimit=25] The maximum number of models to fetch\n     * @param {girder.Model} [settings.selected] The default/current selection\n     * @param {string[]} [settings.display=['Home', 'Collections', 'Users'] Display order\n     * @param {boolean} [settings.reset=true] Always fetch from offset 0\n     */\n    initialize: function (settings) {\n        settings = settings || {};\n\n        this.pageLimit = settings.pageLimit || 25;\n\n        // collections are provided for public access here\n        this.groups = {\n            'Collections': new girder.collections.CollectionCollection(),\n            'Users': new girder.collections.UserCollection()\n        };\n\n        this.groups.Collections.pageLimit = settings.pageLimit;\n        this.groups.Users.pageLimit = settings.pageLimit;\n        this.groups.Users.sortField = 'login';\n\n        // override default selection groups\n        _.extend(this.groups, settings.groups);\n\n        // attach collection change events\n        _.each(this.groups, _.bind(function (group) {\n            this.listenTo(group, 'g:changed', this._updateGroup);\n        }, this));\n\n        // possible values that determine rendered behavior for \"Home\":\n        //   - model: show this model as Home\n        //   - undefined|null: use girder.currentUser\n        this.home = settings.home;\n\n        // we need to fetch the collections and rerender on login\n        this.listenTo(girder.events, 'g:login', this.fetch);\n\n        this.selected = settings.selected;\n        this.display = settings.display || ['Home', 'Collections', 'Users'];\n\n        this.fetch();\n    },\n\n    render: function () {\n        this._home = this.home || girder.currentUser;\n\n        this.$el.html(\n            girder.templates.rootSelectorWidget({\n                home: this._home,\n                groups: this.groups,\n                display: this.display,\n                selected: this.selected,\n                format: this._formatName\n            })\n        );\n    },\n\n    /**\n     * Called when the user selects a new item.  Resolves the\n     * model object from the DOM and triggers the g:selected event.\n     */\n    _selectRoot: function (evt) {\n        var sel = this.$(':selected');\n        var id = sel.val();\n        var group = sel.data('group') || null;\n        this.selected = null;\n        if (_.has(this.groups, group)) {\n            this.selected = this.groups[group].get(id);\n        } else if (this._home && this._home.id === id) {\n            this.selected = this._home;\n        }\n        this.trigger('g:selected', {\n            root: this.selected,\n            group: group\n        });\n    },\n\n    /**\n     * Called when a collection is modified... rerenders the view.\n     */\n    _updateGroup: function (collection) {\n        this.trigger('g:group', {\n            collection: collection\n        });\n        this.render();\n    },\n\n    /**\n     * Return a string to display for the given model.\n     */\n    _formatName: function (model) {\n        var name = model.id;\n        switch (model.get('_modelType')) {\n            case 'user':\n                name = model.get('login');\n                break;\n            case 'folder':\n            case 'collection':\n                name = model.get('name');\n                break;\n        }\n        return name;\n    },\n\n    /**\n     * Fetch all collections from the server.\n     */\n    fetch: function () {\n        var reset = this.reset;\n        _.each(this.groups, function (collection) {\n            collection.fetch(null, reset);\n        });\n    }\n});\n","/**\n * This widget provides a text field that will search any set of data types\n * and show matching results as the user types. Results can be clicked,\n * triggering a callback.\n */\ngirder.views.SearchFieldWidget = girder.View.extend({\n    events: {\n        'input .g-search-field': 'search',\n\n        'click .g-search-mode-radio': function (e) {\n            this.currentMode = $(e.target).val();\n            this.hideResults().search();\n\n            window.setTimeout(_.bind(function () {\n                this.$('.g-search-mode-choose').popover('hide');\n            }, this), 250);\n        },\n\n        'click .g-search-result>a': function (e) {\n            this._resultClicked($(e.currentTarget));\n        },\n\n        'keydown .g-search-field': function (e) {\n            var code = e.keyCode || e.which;\n            var list, pos;\n            if (code === 40) { /* down arrow */\n                list = this.$('.g-search-result');\n                pos = list.index(list.filter('.g-search-selected')) + 1;\n                list.removeClass('g-search-selected');\n                if (pos < list.length) {\n                    list.eq(pos).addClass('g-search-selected');\n                }\n            } else if (code === 38) { /* up arrow */\n                list = this.$('.g-search-result');\n                pos = list.index(list.filter('.g-search-selected')) - 1;\n                list.removeClass('g-search-selected');\n                if (pos === -2) {\n                    pos = list.length - 1;\n                }\n                if (pos >= 0) {\n                    list.eq(pos).addClass('g-search-selected');\n                }\n            } else if (code === 13) { /* enter */\n                var link = this.$('.g-search-result.g-search-selected>a');\n                if (link.length) {\n                    this._resultClicked(link);\n                }\n            }\n        }\n    },\n\n    /**\n     * @param [settings.placeholder=\"Search...\"] The placeholder text for the input field.\n     * @param [settings.getInfoCallback] For custom resource types, this callback can\n     *        be passed in to resolve their title and icon. This callback should\n     *        return an object with \"icon\" and \"text\" fields if it can resolve\n     *        the result, or return falsy otherwise.\n     * @param [settings.modes=[\"text\", \"prefix\"]] A string or list of strings\n     *        representing the allowed search modes. Supported modes: \"text\", \"prefix\".\n     *        If multiple are allowed, users are able to select which one to use\n     *        via a dropdown.\n     */\n    initialize: function (settings) {\n        this.ajaxLock = false;\n        this.pending = null;\n\n        this.placeholder = settings.placeholder || 'Search...';\n        this.getInfoCallback = settings.getInfoCallback || null;\n        this.types = settings.types || [];\n        this.modes = settings.modes || ['text', 'prefix'];\n\n        if (!_.isArray(this.modes)) {\n            this.modes = [this.modes];\n        }\n\n        this.currentMode = this.modes[0];\n    },\n\n    search: function () {\n        var q = this.$('.g-search-field').val();\n\n        if (!q) {\n            this.hideResults();\n            return this;\n        }\n\n        if (this.ajaxLock) {\n            this.pending = q;\n        } else {\n            this._doSearch(q);\n        }\n\n        return this;\n    },\n\n    _resultClicked: function (link) {\n        this.trigger('g:resultClicked', {\n            type: link.attr('resourcetype'),\n            id: link.attr('resourceid'),\n            text: link.text().trim(),\n            icon: link.attr('g-icon')\n        });\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.searchField({\n            placeholder: this.placeholder,\n            modes: this.modes,\n            currentMode: this.currentMode\n        }));\n\n        this.$('[title]').tooltip({\n            placement: 'auto'\n        });\n\n        this.$('.g-search-options-button').popover({\n            trigger: 'manual',\n            html: true,\n            viewport: {\n                selector: 'body',\n                padding: 10\n            },\n            content: _.bind(function () {\n                return girder.templates.searchHelp({\n                    mode: this.currentMode\n                });\n            }, this)\n        }).click(function () {\n            $(this).popover('toggle');\n        });\n\n        this.$('.g-search-mode-choose').popover({\n            trigger: 'manual',\n            html: true,\n            viewport: {\n                selector: 'body',\n                padding: 10\n            },\n            content: _.bind(function () {\n                return girder.templates.searchModeSelect({\n                    modes: this.modes,\n                    currentMode: this.currentMode\n                });\n            }, this)\n        }).click(function () {\n            $(this).popover('toggle');\n        });\n\n        return this;\n    },\n\n    /**\n     * Parent views should call this if they wish to hide the result list.\n     */\n    hideResults: function () {\n        this.$('.dropdown').removeClass('open');\n        return this;\n    },\n\n    /**\n     * Parent views should call this if they wish to clear the search text.\n     */\n    clearText: function () {\n        this.$('.g-search-field').val('');\n        return this;\n    },\n\n    /**\n     * Parent views should call this if they wish to reset the search widget,\n     * i.e. clear it and hide any results.\n     */\n    resetState: function () {\n        return this.hideResults().clearText();\n    },\n\n    _doSearch: function (q) {\n        this.ajaxLock = true;\n        this.pending = null;\n\n        girder.restRequest({\n            path: 'resource/search',\n            data: {\n                q: q,\n                mode: this.currentMode,\n                types: JSON.stringify(this.types)\n            }\n        }).done(_.bind(function (results) {\n            this.ajaxLock = false;\n\n            if (this.pending) {\n                this._doSearch(this.pending);\n            } else {\n                var list = this.$('.g-search-results>ul');\n                var resources = [];\n                _.each(this.types, function (type) {\n                    _.each(results[type] || [], function (result) {\n                        var text, icon;\n                        if (type === 'user') {\n                            text = result.firstName + ' ' + result.lastName +\n                                ' (' + result.login + ')';\n                            icon = 'user';\n                        } else if (type === 'group') {\n                            text = result.name;\n                            icon = 'users';\n                        } else if (type === 'collection') {\n                            text = result.name;\n                            icon = 'sitemap';\n                        } else if (type === 'folder') {\n                            text = result.name;\n                            icon = 'folder';\n                        } else if (type === 'item') {\n                            text = result.name;\n                            icon = 'doc-text-inv';\n                        } else {\n                            if (this.getInfoCallback) {\n                                var res = this.getInfoCallback(type, result);\n                                if (res) {\n                                    text = res.text;\n                                    icon = res.icon;\n                                }\n                            }\n                            if (!text || !icon) {\n                                text = '[unknown type]';\n                                icon = 'attention';\n                            }\n                        }\n                        resources.push({\n                            type: type,\n                            id: result._id,\n                            text: text,\n                            icon: icon\n                        });\n                    }, this);\n                }, this);\n                list.html(girder.templates.searchResults({\n                    results: resources\n                }));\n\n                this.$('.dropdown').addClass('open');\n            }\n        }, this));\n    }\n});\n","/**\n * This widget renders the state of a progress notification.\n */\ngirder.views.TaskProgressWidget = girder.View.extend({\n\n    initialize: function (settings) {\n        this.progress = settings.progress;\n    },\n\n    render: function () {\n        var width = '0', barClass = [], progressClass = [], percentText = '',\n            timeLeftText = '';\n\n        if (this.progress.data.state === 'active') {\n            if (this.progress.data.total <= 0) {\n                width = '100%';\n                barClass.push('progress-bar-warning');\n                progressClass.push('progress-striped', 'active');\n            } else if (this.progress.data.current <= 0) {\n                width = '0';\n                percentText = '0%';\n            } else if (this.progress.data.current >= this.progress.data.total) {\n                percentText = width = '100%';\n            } else {\n                var percent = (100 * this.progress.data.current /\n                    this.progress.data.total);\n                width = Math.round(percent) + '%';\n                percentText = percent.toFixed(1) + '%';\n                var timeLeft = parseInt(this.progress.estimatedTotalTime - (\n                    this.progress.updatedTime - this.progress.startTime), 10);\n                if (timeLeft >= 3600) {\n                    timeLeftText = sprintf('%d:%02d:%02d left',\n                        timeLeft / 3600, (timeLeft / 60) % 60, timeLeft % 60);\n                } else if (timeLeft > 0) {\n                    timeLeftText = sprintf('%d:%02d left',\n                        timeLeft / 60, timeLeft % 60);\n                }\n            }\n        } else if (this.progress.data.state === 'success') {\n            width = '100%';\n            barClass.push('progress-bar-success');\n\n            this._scheduleHide(5000);\n        } else if (this.progress.data.state === 'error') {\n            width = '100%';\n            barClass.push('progress-bar-danger');\n\n            this._scheduleHide(10000);\n        }\n\n        this.$el.html(girder.templates.taskProgress({\n            progress: this.progress,\n            width: width,\n            barClass: barClass.join(' '),\n            progressClass: progressClass.join(' '),\n            percentText: percentText,\n            timeLeftText: timeLeftText\n        }));\n        return this;\n    },\n\n    /**\n     * Renders an update of the progress object.\n     */\n    update: function (progress) {\n        this.progress = progress;\n        this.render();\n    },\n\n    /**\n     * Schedule a hide event to be triggered in the future.\n     */\n    _scheduleHide: function (ms) {\n        var widget = this;\n        window.setTimeout(function () {\n            widget.$el.fadeOut(500, function () {\n                widget.remove();\n                widget.trigger('g:hide', widget.progress);\n            });\n        }, ms);\n    }\n});\n","/**\n * This widget displays a timeline of events. This is visualized as a line (a bar)\n * with two sorts of primitives overlaid:\n *\n * 1. Segments: spans of time, with a start and end.\n * 2. Points: a single point in time. Points always display on top of segments.\n *\n * Any number of these primitives can be displayed on the timeline, so long as they\n * are bounded between the specified startTime and endTime. The time values for\n * startTime, endTime, and for the primitives can be specified either as numeric\n * values (i.e. a relative offset in time), or as date strings that can be parsed\n * by JavaScript, or as Date objects. For obvious reasons, in a single instance of\n * this widget, it is not possible to mix the numeric/relative values with datestamp\n * values.\n */\ngirder.views.TimelineWidget = girder.View.extend({\n    /**\n     * Initialize the timeline widget.\n     *\n     * @param settings.startTime The numeric value or timestamp representing where\n     *    the timeline should start.\n     * @param settings.endTime The numeric value or timestamp representing where\n     *    the timeline should end. Must be greater than the startTime value. All\n     *    segments and points should be bounded within the interval [startTime, endTime].\n     * @param [settings.numeric=false] If the time values being passed in are simply\n     *    relative, scalar values (e.g. number of seconds since start) rather than\n     *    timestamps, set this to true.\n     * @param [settings.startLabel] Pass to show a label for the start of the timeline.\n     * @param [settings.endLabel] Pass to show a label for the end of the timeline.\n     * @param [settings.defaultSegmentClass='g-segment-default'] A CSS class set\n     *     on segments that do not specify a class.\n     * @param [settings.defaultPointClass='g-point-default'] A CSS class set\n     *     on points that do not specify a class.\n     * @param [settings.segments=[]] A list of segments. Each element of the list\n     *    should be an object with the following keys:\n     *      - start: A number or timestamp representing\n     *      - end: A numer of timestamp representing the end of this segment.\n     *      - [class]: A CSS class name to apply to the segment. Uses the\n     *                 widget's defaultSegmentClass if this key is not set.\n     *      - [tooltip]: A tooltip value for this segment. Tooltips containing the\n     *                   special token \"%r\" will have that token expanded into the\n     *                   elapsed time between start and end.\n     * @param [settings.points=[]] A list of points. Each element of the list should\n     *    be an object with the following keys:\n     *      - time: A number or timestamp representing the location of the point.\n     *      - [class]: A CSS class name to apply to the point. Uses the\n     *                 widget's defaultPointClass if this key is not set.\n     *      - [tooltip]: A tooltip value for this point. Tooltips containing the\n     *                   special token \"%t\" will have that token expanded into the\n     *                   time value for that point.\n     */\n    initialize: function (settings) {\n        this.startTime = settings.startTime;\n        this.endTime = settings.endTime;\n        this.segments = settings.segments || [];\n        this.points = settings.points || [];\n        this.numeric = !!settings.numeric;\n        this.startLabel = settings.startLabel;\n        this.endLabel = settings.endLabel;\n        this.defaultSegmentClass = settings.defaultSegmentClass || 'g-segment-default';\n        this.defaultPointClass = settings.defaultPointClass || 'g-point-default';\n\n        this._processData();\n    },\n\n    // Processes the points and segments for display in the widget\n    _processData: function () {\n        if (!this.numeric) {\n            this.startTime = new Date(this.startTime);\n            this.endTime = new Date(this.endTime);\n        }\n\n        if (this.endTime <= this.startTime) {\n            console.error('Timeline widget: end time must be after start time.');\n            this._processedSegments = [];\n            this._processedPoints = [];\n            return;\n        }\n\n        var range = this.endTime - this.startTime;\n\n        this._processedSegments = _.map(this.segments, function (segment) {\n            var start = this.numeric ? segment.start : new Date(segment.start);\n            var end = this.numeric ? segment.end : new Date(segment.end);\n            var classes = segment.class ? [segment.class] : [this.defaultSegmentClass];\n\n            if (segment.tooltip) {\n                classes.push('g-tooltip');\n            }\n\n            return {\n                class: classes.join(' '),\n                left: (100 * (start - this.startTime) / range).toFixed(1) + '%',\n                width: (100 * (end - start) / range).toFixed(1) + '%',\n                tooltip: this._segmentTooltip(segment, {\n                    range: this.numeric ? end - start : (end - start) / 1000\n                })\n            };\n        }, this);\n\n        this._processedPoints = _.map(this.points, function (point) {\n            var time = this.numeric ? point.time : new Date(point.time);\n            var classes = point.class ? [point.class] : [this.defaultPointClass];\n\n            if (point.tooltip) {\n                classes.push('g-tooltip');\n            }\n\n            return {\n                class: classes.join(' '),\n                left: (100 * (time - this.startTime) / range).toFixed(1) + '%',\n                tooltip: this._pointTooltip(point, {\n                    time: time\n                })\n            };\n        }, this);\n    },\n\n    _segmentTooltip: function (segment, info) {\n        if (!segment.tooltip) {\n            return null;\n        }\n\n        return segment.tooltip.replace('%r', info.range);\n    },\n\n    _pointTooltip: function (point, info) {\n        if (!point.tooltip) {\n            return null;\n        }\n\n        if (this.numeric) {\n            return point.tooltip.replace('%t', info.time);\n        } else {\n            return point.tooltip.replace('%t', info.time.toISOString());\n        }\n    },\n\n    render: function () {\n        this.$el.html(girder.templates.timeline({\n            segments: this._processedSegments,\n            points: this._processedPoints,\n            startLabel: this.startLabel,\n            endLabel: this.endLabel\n        }));\n\n        this.$('.g-tooltip').tooltip({\n            delay: 100,\n            container: this.$el\n        });\n\n        return this;\n    }\n});\n","/**\n * This widget is used to upload files to a folder. Pass a folder model\n * to its constructor as the parent folder that will be uploaded into.\n * Events:\n *   itemComplete: Triggered each time an individual item is finished uploading.\n *   finished: Triggered when the entire set of items is uploaded.\n */\ngirder.views.UploadWidget = girder.View.extend({\n    events: {\n        'submit #g-upload-form': function (e) {\n            e.preventDefault();\n            this.startUpload();\n        },\n        'click .g-resume-upload': function () {\n            this.$('.g-upload-error-message').html('');\n            this.currentFile.resumeUpload();\n        },\n        'click .g-restart-upload': function () {\n            this.$('.g-upload-error-message').html('');\n            this.uploadNextFile();\n        },\n        'change #g-files': function () {\n            var files = this.$('#g-files')[0].files;\n\n            if (files.length) {\n                this.files = files;\n                this.filesChanged();\n            }\n        },\n        'click .g-drop-zone': function () {\n            this.$('#g-files').click();\n        },\n        'dragenter .g-drop-zone': function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n            e.originalEvent.dataTransfer.dropEffect = 'copy';\n            this.$('.g-drop-zone')\n                .addClass('g-dropzone-show')\n                .html('<i class=\"icon-bullseye\"/> Drop files here');\n        },\n        'dragleave .g-drop-zone': function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n            this.$('.g-drop-zone')\n                .removeClass('g-dropzone-show')\n                .html('<i class=\"icon-docs\"/> Browse or drop files');\n        },\n        'dragover .g-drop-zone': function (e) {\n            e.preventDefault();\n        },\n        'drop .g-drop-zone': 'filesDropped'\n    },\n\n    /**\n     * This widget has several configuration options to control its view and\n     * behavior. The following keys can be passed in the settings object:\n     *\n     * @param [parent] If the parent object is known when instantiating this\n     * upload widget, pass the object here.\n     * @param [parentType=folder] If the parent type is known when instantiating this\n     * upload widget, pass the object here. Otherwise set noParent: true and\n     * set it later, prior to starting the upload.\n     * @param [noParent=false] If the parent object being uploaded into is not known\n     * at the time of widget instantiation, pass noParent: true. Callers must\n     * ensure that the parent is set by the time uploadNextFile() actually gets\n     * called.\n     * @param [title=\"Upload files\"] Title for the widget. This is highly recommended\n     * when rendering as a modal dialog. To disable rendering of the title, simply\n     * pass a falsy object.\n     * @param [modal=true] This widget normally renders as a modal dialog. Pass\n     * modal: false to disable the modal behavior and simply render underneath a\n     * parent element.\n     * @param [overrideStart=false] Some callers will want to hook into the pressing\n     * of the start upload button and add their own logic prior to actually sending\n     * the files. To do so, set overrideStart: true and bind to the \"g:uploadStarted\"\n     * event of this widget. The caller is then responsible for calling \"uploadNextFile()\"\n     * on the widget when they have completed their actions and are ready to actually\n     * send the files.\n     *\n     * Other events:\n     *   - \"g:filesChanged\": This is triggered any time the user changes the\n     *     file selection, either by dropping or browsing and selecting new files.\n     *     Handlers will receive a single argument, which is the list of chosen files.\n     *   - \"g:uploadFinished\": When all files have been successfully uploaded,\n     *     this event is fired.\n     */\n    initialize: function (settings) {\n        if (settings.noParent) {\n            this.parent = null;\n            this.parentType = null;\n        } else {\n            this.parent = settings.parent || settings.folder;\n            this.parentType = settings.parentType || 'folder';\n        }\n        this.files = [];\n        this.totalSize = 0;\n        this.title = _.has(settings, 'title') ? settings.title : 'Upload files';\n        this.modal = _.has(settings, 'modal') ? settings.modal : true;\n        this.overrideStart = settings.overrideStart || false;\n    },\n\n    render: function () {\n        if (this.modal) {\n            this.$el.html(girder.templates.uploadWidget({\n                parent: this.parent,\n                parentType: this.parentType,\n                title: this.title\n            }));\n\n            var base = this;\n            var dialogid;\n            if (this.parentType === 'file') {\n                dialogid = this.parent.get('_id');\n            }\n\n            this.$el.girderModal(this).on('hidden.bs.modal', function () {\n                /* If we are showing the resume option, we have a partial upload\n                 * that should be deleted, since the user has no way to get back\n                 * to it. */\n                if ($('.g-resume-upload').length && base.currentFile) {\n                    base.currentFile.abortUpload();\n                }\n                girder.dialogs.handleClose('upload', undefined, dialogid);\n            });\n\n            girder.dialogs.handleOpen('upload', undefined, dialogid);\n        } else {\n            this.$el.html(girder.templates.uploadWidgetNonModal({\n                parent: this.parent,\n                parentType: this.parentType,\n                title: this.title\n            }));\n        }\n        return this;\n    },\n\n    filesDropped: function (e) {\n        e.stopPropagation();\n        e.preventDefault();\n        this.$('.g-drop-zone')\n            .removeClass('g-dropzone-show')\n            .html('<i class=\"icon-docs\"/> Browse or drop files');\n        this.files = e.originalEvent.dataTransfer.files;\n        this.filesChanged();\n    },\n\n    filesChanged: function () {\n        if (this.files.length === 0) {\n            this.$('.g-overall-progress-message').text('No files selected');\n            this.setUploadEnabled(false);\n        } else {\n            this.totalSize = 0;\n            _.each(this.files, function (file) {\n                this.totalSize += file.size;\n            }, this);\n\n            var msg;\n\n            if (this.files.length > 1) {\n                msg = 'Selected ' + this.files.length + ' files';\n            } else {\n                msg = 'Selected <b>' + this.files[0].name + '</b>';\n            }\n            this.$('.g-overall-progress-message').html('<i class=\"icon-ok\"/> ' +\n                msg + '  (' + girder.formatSize(this.totalSize) +\n                ') -- Press start button');\n            this.setUploadEnabled(true);\n            this.$('.g-progress-overall,.g-progress-current').addClass('hide');\n            this.$('.g-current-progress-message').empty();\n            this.$('.g-upload-error-message').empty();\n        }\n\n        this.trigger('g:filesChanged', this.files);\n    },\n\n    startUpload: function () {\n        this.setUploadEnabled(false);\n        this.$('.g-drop-zone').addClass('hide');\n        this.$('.g-progress-overall,.g-progress-current').removeClass('hide');\n        this.$('.g-upload-error-message').empty();\n\n        this.currentIndex = 0;\n        this.overallProgress = 0;\n        this.trigger('g:uploadStarted');\n\n        if (!this.overrideStart) {\n            this.uploadNextFile();\n        }\n    },\n\n    /**\n     * Enable or disable the start upload button.\n     *\n     * @param state {bool} Truthy for enabled, falsy for disabled.\n     */\n    setUploadEnabled: function (state) {\n        if (state) {\n            this.$('.g-start-upload').removeClass('disabled');\n        } else {\n            this.$('.g-start-upload').addClass('disabled');\n        }\n    },\n\n    /**\n     * Initializes the upload of a file by requesting the upload token\n     * from the server. If successful, this will call _uploadChunk to send the\n     * actual bytes from the file if it is of non-zero length.\n     */\n    uploadNextFile: function () {\n        if (this.currentIndex >= this.files.length) {\n            // All files have finished\n            if (this.modal) {\n                this.$el.modal('hide');\n            }\n            this.trigger('g:uploadFinished', {\n                files: this.files,\n                totalSize: this.totalSize\n            });\n            return;\n        }\n\n        this.currentFile = this.parentType === 'file'\n                ? this.parent : new girder.models.FileModel();\n\n        this.currentFile.on('g:upload.complete', function () {\n            this.currentIndex += 1;\n            this.uploadNextFile();\n        }, this).on('g:upload.chunkSent', function (info) {\n            this.overallProgress += info.bytes;\n        }, this).on('g:upload.progress', function (info) {\n            var currentProgress = info.startByte + info.loaded;\n\n            this.$('.g-progress-current>.progress-bar').css('width',\n                Math.ceil(100 * currentProgress / info.total) + '%');\n            this.$('.g-progress-overall>.progress-bar').css('width',\n                Math.ceil(100 * (this.overallProgress + info.loaded) /\n                          this.totalSize) + '%');\n            this.$('.g-current-progress-message').html(\n                '<i class=\"icon-doc-text\"/>' + (this.currentIndex + 1) + ' of ' +\n                    this.files.length + ' - <b>' + info.file.name + '</b>: ' +\n                    girder.formatSize(currentProgress) + ' / ' +\n                    girder.formatSize(info.total)\n            );\n            this.$('.g-overall-progress-message').html('Overall progress: ' +\n                girder.formatSize(this.overallProgress + info.loaded) + ' / ' +\n                girder.formatSize(this.totalSize));\n        }, this).on('g:upload.error', function (info) {\n            var html = info.message + ' <a class=\"g-resume-upload\">' +\n                'Click to resume upload</a>';\n            $('.g-upload-error-message').html(html);\n        }, this).on('g:upload.errorStarting', function (info) {\n            var html = info.message + ' <a class=\"g-restart-upload\">' +\n                'Click to restart upload</a>';\n            $('.g-upload-error-message').html(html);\n        }, this);\n\n        if (this.parentType === 'file') {\n            this.currentFile.updateContents(this.files[this.currentIndex]);\n        } else {\n            this.currentFile.upload(this.parent, this.files[this.currentIndex]);\n        }\n    }\n});\n"]}